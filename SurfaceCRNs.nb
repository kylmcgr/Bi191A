(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    646008,      13984]
NotebookOptionsPosition[    618321,      13563]
NotebookOutlinePosition[    623920,      13682]
CellTagsIndexPosition[    623877,      13679]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Stochastic chemical reaction networks on lattice surfaces", "Title",
 CellChangeTimes->{
  3.818565174571698*^9, {3.818565208420986*^9, 3.8185652354340067`*^9}, {
   3.821763550797429*^9, 
   3.8217635610181513`*^9}},ExpressionUUID->"67ae8e44-178c-46b4-9b39-\
1d517b599f65"],

Cell[TextData[{
 "This notebook was prepared by Erik Winfree <winfree@caltech.edu> for \
Caltech BE/CS 191a, Winter 2022.  \n",
 StyleBox["Do not share this with anyone who is not currently taking the \
class unless you have permission from Erik Winfree.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.820351424938045*^9, 3.820351445782344*^9}, {
   3.820368437453093*^9, 3.8203684819722643`*^9}, 3.820472677966508*^9, {
   3.8207972478187237`*^9, 3.820797249605282*^9}, {3.8209411813285847`*^9, 
   3.820941181418469*^9}, {3.821765265511417*^9, 3.821765275847251*^9}, {
   3.8224426511554527`*^9, 3.822442651472589*^9}, {3.8227729227817373`*^9, 
   3.822772923151351*^9}, {3.822874981028717*^9, 3.822875001880706*^9}, {
   3.823471187852744*^9, 3.823471188143159*^9}, {3.823475014813491*^9, 
   3.823475034418499*^9}, {3.82347517537428*^9, 3.823475204864468*^9}, {
   3.825512650242001*^9, 3.825512661066691*^9}, {3.825513071463574*^9, 
   3.825513071522691*^9}, {3.825513223801775*^9, 3.8255132415902977`*^9}, {
   3.8255467804189034`*^9, 3.825546783978465*^9}, {3.854710207744791*^9, 
   3.854710207857046*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"7a930e8b-53f9-4681-91b8-507ef95f729a"],

Cell[CellGroupData[{

Cell["Code from and for the well-mixed stochastic CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 
  3.8217636024725533`*^9}},ExpressionUUID->"e67888a6-5577-489e-9ca9-\
ad66289034ca"],

Cell[TextData[{
 "This code is borrowed from StochasticDigitalCircuitCRNs.nb.  Plus, improved \
printing of ",
 StyleBox["rxnl",
  FontWeight->"Bold"],
 " is provided.  A double rather than single arrow is used to distinguish \
order-preserving and order-agnostic reaction representations.  RescaleVolume \
now handles ",
 StyleBox["revrxn",
  FontWeight->"Bold"],
 " and ",
 StyleBox["rxnl",
  FontWeight->"Bold"],
 " as well as ",
 StyleBox["rxn",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
  3.821763759556059*^9, 3.821763769244585*^9}, {3.8549323246041107`*^9, 
  3.854932352355371*^9}, {3.854933189371773*^9, 3.8549332268976793`*^9}, {
  3.854936080977894*^9, 3.8549360986682262`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"e4973bc1-d613-461c-a57e-cbf4f1c8151b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulator.m\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulatorSSA.m\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756939388737718*^9, 3.7569394056949167`*^9}, 
   3.756939438583961*^9, {3.7572866561186523`*^9, 3.7572866562936563`*^9}, {
   3.757734559281149*^9, 3.757734566896432*^9}, 3.821300854746962*^9, 
   3.821301124988103*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"8d2908de-1644-4d54-8411-6a159ef8a15b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Molecularity", "[", "reactants_Times", "]"}], ":=", 
   RowBox[{"First", "[", "reactants", "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"e", ".", "g", ".", " ", "5"}], "X"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Molecularity", "[", "reactants_Plus", "]"}], ":=", 
   RowBox[{"Plus", " ", "@@", " ", 
    RowBox[{"(", 
     RowBox[{"Molecularity", "/@", "reactants"}], ")"}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "2"}], "X"}], " ", "+", " ", "Y"}], " ",
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Molecularity", "[", "reactants_Integer", "]"}], ":=", "0"}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"e", ".", "g", ".", " ", "zero"}], "-", 
    RowBox[{"order", " ", "reactions"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Molecularity", "[", "reactants_List", "]"}], ":=", 
   RowBox[{"Length", "[", "reactants", "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"for", " ", "rxnl"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Molecularity", "[", "reactants_", "]"}], ":=", "1"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"e", ".", "g", ".", " ", "X"}], ";", " ", 
    RowBox[{
    "only", " ", "gets", " ", "here", " ", "if", " ", "other", " ", "cases", 
     " ", 
     RowBox[{"don", "'"}], "t", " ", "apply"}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"RescaleVolume", "[", 
   RowBox[{"rsys_List", ",", "Vm_"}], "]"}], ":=", 
  RowBox[{"rsys", "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"rxn", "[", 
       RowBox[{"r_", ",", "p_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"rxn", "[", 
       RowBox[{"r", ",", "p", ",", 
        RowBox[{"k", "/", 
         RowBox[{"(", 
          RowBox[{"Vm", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Molecularity", "[", "r", "]"}], "-", "1"}], ")"}]}], 
          ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"revrxn", "[", 
       RowBox[{"r_", ",", "p_", ",", "kf_", ",", "kr_"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"revrxn", "[", 
       RowBox[{"r", ",", "p", ",", 
        RowBox[{"kf", "/", 
         RowBox[{"(", 
          RowBox[{"Vm", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Molecularity", "[", "r", "]"}], "-", "1"}], ")"}]}], 
          ")"}]}], ",", 
        RowBox[{"kr", "/", 
         RowBox[{"(", 
          RowBox[{"Vm", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Molecularity", "[", "p", "]"}], "-", "1"}], ")"}]}], 
          ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rxnl", "[", 
       RowBox[{"rs_", ",", "ps_", ",", "k_"}], "]"}], ":>", 
      RowBox[{"rxnl", "[", 
       RowBox[{"rs", ",", "ps", ",", 
        RowBox[{"k", "/", 
         RowBox[{"(", 
          RowBox[{"Vm", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Molecularity", "[", "rs", "]"}], "-", "1"}], ")"}]}], 
          ")"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"conc", "[", 
       RowBox[{"s_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"conc", "[", 
       RowBox[{"s", ",", 
        RowBox[{"Round", "[", 
         RowBox[{"Vm", "*", "c"}], "]"}]}], "]"}]}]}], "\n", 
    "}"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820625671713768*^9, 3.8206256872532578`*^9}, 
   3.820625834585804*^9, {3.820625875907835*^9, 3.8206259074949427`*^9}, {
   3.820625951549884*^9, 3.8206259613551702`*^9}, {3.8549361297492657`*^9, 
   3.854936150690133*^9}, {3.8549366189194613`*^9, 3.854936669530942*^9}, {
   3.854936749965173*^9, 3.85493675017976*^9}, {3.8549367974400263`*^9, 
   3.854936857920566*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"d6794b06-a2e6-4a87-b639-202999ba9c75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightedTrajectory", "[", 
   RowBox[{"trajectory_", ",", "speciesIndex_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"Normalized", "\[Rule]", "False"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"WeightedData", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Floor", "[", 
       RowBox[{"#", "[", 
        RowBox[{"[", "speciesIndex", "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"trajectory", "[", "\"\<Values\>\"", "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Differences", "[", 
      RowBox[{"trajectory", "[", "\"\<Times\>\"", "]"}], "]"}], "/", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "Normalized", "]"}], ",", 
       RowBox[{"Last", "[", 
        RowBox[{"trajectory", "[", "\"\<Times\>\"", "]"}], "]"}], ",", "1"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.757904147718583*^9, 3.757904329519812*^9}, {
   3.757904399148922*^9, 3.757904418460556*^9}, {3.7579044499964743`*^9, 
   3.757904458994568*^9}, {3.757904589947928*^9, 3.757904603512027*^9}, {
   3.7579046339341917`*^9, 3.7579047139921103`*^9}, 3.757904751565466*^9, {
   3.8210340466530857`*^9, 3.821034083918182*^9}, {3.8210346747722187`*^9, 
   3.821034700870139*^9}, {3.821034736272688*^9, 3.821034739544992*^9}, {
   3.8210348026183*^9, 3.821034848572803*^9}, {3.821034893816761*^9, 
   3.821034952534329*^9}, {3.82105511510251*^9, 3.821055118331808*^9}, {
   3.821055227052822*^9, 3.821055227625413*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"9785284f-63ea-477e-ba13-bbb14ac9a87b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlotFormat", "[", 
   RowBox[{"trajectory_", ",", "maxpoints_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", "=", 
      RowBox[{"trajectory", "[", "\"\<Values\>\"", "]"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"K", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "data", "]"}], "]"}]}], ",", 
        RowBox[{"N", "=", 
         RowBox[{"Length", "[", "data", "]"}]}], ",", "indices"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"N", "<", "maxpoints"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "N"}], "]"}], ",", 
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "N"}], "}"}], "~", "Join", "~", 
            RowBox[{"RandomSample", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"2", ",", 
                RowBox[{"N", "-", "1"}]}], "]"}], ",", "maxpoints"}], "]"}]}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"trajectory", "[", "\"\<Times\>\"", "]"}], "[", 
              RowBox[{"[", "indices", "]"}], "]"}], ",", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"indices", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotFormat", "[", 
   RowBox[{"trajectory_", ",", "rsys_", ",", "formulas_", ",", "maxpoints_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"SpeciesInRxnsys", "[", "rsys", "]"}]}], ",", "calculate"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"calculate", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "state", "}"}], ",", 
        RowBox[{"formulas", "/.", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "state"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotFormat", "[", 
      RowBox[{
       RowBox[{"TimeSeriesMap", "[", 
        RowBox[{"calculate", ",", "trajectory"}], "]"}], ",", "maxpoints"}], 
      "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82096793236156*^9, 3.820968093633706*^9}, {
  3.820968172512384*^9, 3.820968336630888*^9}, {3.82096840119916*^9, 
  3.820968410116159*^9}, {3.821034959852817*^9, 3.821035044090355*^9}, {
  3.821325882208308*^9, 3.821326056852404*^9}, {3.8213261284264097`*^9, 
  3.8213263398626966`*^9}, {3.821326381277856*^9, 3.821326386053144*^9}, {
  3.821377851538254*^9, 3.821377874378038*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"bde82ff7-cd3f-45f2-b396-d5a86ee1c967"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"rxnl", "[", 
     RowBox[{"rs_", ",", "ps_", ",", "k_"}], "]"}], ",", "StandardForm"}], 
   "]"}], ":=", 
  RowBox[{"Interpretation", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"rs", ",", "\"\<+\>\""}], "]"}], ",", 
        RowBox[{"Overscript", "[", 
         RowBox[{
          RowBox[{"RawBoxes", "[", "\"\<\[DoubleLongRightArrow]\>\"", "]"}], 
          ",", "k"}], "]"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"ps", ",", "\"\<+\>\""}], "]"}]}], "}"}], ",", "\"\< \>\""}],
      "]"}], ",", 
    RowBox[{"rxnl", "[", 
     RowBox[{"rs", ",", "ps", ",", "k"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854931908461532*^9, 3.854931936003148*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"368065f7-2ac3-44a3-ab87-f8dcbf1f6c6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rxnl", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"B", ",", "A"}], "}"}], ",", "2.5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8549310276477213`*^9, 3.8549310415606117`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"45820862-9d50-4ec1-87a9-9d3c9a17de66"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
   "\[ThinSpace]","\" \"",
    TemplateBox[{"+", "\"+\"", "A", "B"}, "RowWithSeparators"],OverscriptBox[
    "\[DoubleLongRightArrow]", "2.5`"],
    TemplateBox[{"+", "\"+\"", "B", "A"}, "RowWithSeparators"]},
   "RowWithSeparators"],
  CRNSimulator`rxnl[{$CellContext`A, $CellContext`B}, {$CellContext`B, \
$CellContext`A}, 2.5]]], "Output",
 CellChangeTimes->{3.854931042426394*^9, 3.854931949798688*^9, 
  3.855083720455761*^9, 3.8554168325608826`*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"440ee384-a1e6-4f9d-9b75-f38b2c8f1140"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rxnl", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "x", "}"}], ",", "1.0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8549322573911133`*^9, 3.8549322670183887`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"4e4e68d4-6684-44cf-8dea-6f60e0ee91a9"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
   "\[ThinSpace]","\" \"",TemplateBox[{"+", "\"+\""}, "RowWithSeparators"],
    OverscriptBox["\[DoubleLongRightArrow]", "1.`"],
    TemplateBox[{"+", "\"+\"", "x"}, "RowWithSeparators"]},
   "RowWithSeparators"],
  CRNSimulator`rxnl[{}, {$CellContext`x}, 1.]]], "Output",
 CellChangeTimes->{3.8549322678713903`*^9, 3.8554168327450237`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"fb5e4655-1192-48b2-9e5a-b8c5e4ad65dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rxnl", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], ",", "3.4"}], "]"}]], "Input",
 CellChangeTimes->{{3.854932274310062*^9, 3.8549322900911818`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"565b1921-9e7f-448d-8ed5-2d875f28786b"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
   "\[ThinSpace]","\" \"",
    TemplateBox[{"+", "\"+\"", "A", "B", "C"}, "RowWithSeparators"],
    OverscriptBox["\[DoubleLongRightArrow]", "3.4`"],
    TemplateBox[{"+", "\"+\"", "X", "Y", "Z"}, "RowWithSeparators"]},
   "RowWithSeparators"],
  CRNSimulator`rxnl[{$CellContext`A, $CellContext`B, 
    C}, {$CellContext`X, $CellContext`Y, $CellContext`Z}, 3.4]]], "Output",
 CellChangeTimes->{3.854932291058014*^9, 3.8554168329295654`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"b7cde37a-7abf-4cbf-89d6-55d109afea61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rxnl", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", 
   RowBox[{"{", "}"}], ",", "3.4"}], "]"}]], "Input",
 CellChangeTimes->{3.8549323723943863`*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"d93b7a5a-dde5-490a-8931-4f0515c7eee2"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
   "\[ThinSpace]","\" \"",
    TemplateBox[{"+", "\"+\"", "A", "B", "C"}, "RowWithSeparators"],
    OverscriptBox["\[DoubleLongRightArrow]", "3.4`"],
    TemplateBox[{"+", "\"+\""}, "RowWithSeparators"]},
   "RowWithSeparators"],
  CRNSimulator`rxnl[{$CellContext`A, $CellContext`B, C}, {}, 3.4]]], "Output",\

 CellChangeTimes->{3.854932373333688*^9, 3.8554168330666513`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"f1065d94-8224-444f-ad7c-432f31324fae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RxnsToRxnls", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"A", "+", "B"}], ",", 
      RowBox[{"B", "+", "C"}], ",", "1.0"}], "]"}], ",", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"B", "+", "C"}], ",", 
      RowBox[{"C", "+", "D"}], ",", "1.0"}], "]"}], ",", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"C", "+", "D"}], ",", 
      RowBox[{"D", "+", "A"}], ",", "1.0"}], "]"}], ",", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"D", "+", "A"}], ",", 
      RowBox[{"A", "+", "B"}], ",", "1.0"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.854933260030058*^9, 3.85493331781777*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"fe3a0514-9ab0-477f-91eb-85aa6dfc4b5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "B"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1.`"],
      TemplateBox[{"+", "\"+\"", "B", "C"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`B}, {$CellContext`B, C}, 
     1.]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "B", "C"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1.`"],
      TemplateBox[{"+", "\"+\"", "C", "D"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`B, C}, {C, D}, 1.]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "C", "D"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1.`"],
      TemplateBox[{"+", "\"+\"", "A", "D"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{C, D}, {$CellContext`A, D}, 1.]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "D"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1.`"],
      TemplateBox[{"+", "\"+\"", "A", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, D}, {$CellContext`A, $CellContext`B}, 
     1.]]}], "}"}]], "Output",
 CellChangeTimes->{3.854933319535398*^9, 3.855083724990128*^9, 
  3.8554168333052053`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"6044f19d-ce17-4033-b57d-f28600c26c5e"]
}, Open  ]],

Cell[TextData[{
 "One might find it a little easier to enter CRNs with + rather than lists.  ",
 StyleBox["rxno",
  FontWeight->"Bold"],
 " allows this for 1-1 and 2-2 reactions.  Invalid inputs don\
\[CloseCurlyQuote]t issue warnings, watch out!"
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
  3.821763759556059*^9, 3.821763769244585*^9}, {3.8549323246041107`*^9, 
  3.854932352355371*^9}, {3.854933189371773*^9, 3.8549332268976793`*^9}, {
  3.8549350413669662`*^9, 3.8549350665349903`*^9}, {3.854935190291677*^9, 
  3.854935209055809*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"92b3c157-510f-417a-ba68-cba77a1480e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "rxno", "]"}], "=", "HoldAll"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxno", "[", 
   RowBox[{
    RowBox[{"2", "a_"}], ",", 
    RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"rxnl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxno", "[", 
   RowBox[{
    RowBox[{"a_", "+", "b_"}], ",", 
    RowBox[{"2", "c_"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"rxnl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "c"}], "}"}], ",", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxno", "[", 
   RowBox[{
    RowBox[{"2", "a_"}], ",", 
    RowBox[{"2", "c_"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"rxnl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "x"}], "}"}], ",", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxno", "[", 
   RowBox[{
    RowBox[{"a_", "+", "b_"}], ",", 
    RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], ":=", 
  RowBox[{"rxnl", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxno", "[", 
   RowBox[{"a_", ",", "b_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"rxnl", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{"{", "b", "}"}], ",", "k"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854934359181294*^9, 3.854934518842177*^9}, {
  3.8549350021300488`*^9, 3.854935004291276*^9}, {3.854935118822186*^9, 
  3.854935158525875*^9}, {3.854938523707892*^9, 3.854938633370173*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"8915ac04-ca6a-477a-bc9e-49f14dfa609d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rxno", "[", 
    RowBox[{
     RowBox[{"A", "+", "Q"}], ",", 
     RowBox[{"2", "X"}], ",", "1"}], "]"}], ",", 
   RowBox[{"rxno", "[", 
    RowBox[{"A", ",", "R", ",", "0.6"}], "]"}], ",", 
   RowBox[{"rxno", "[", 
    RowBox[{
     RowBox[{"R", "+", "Q"}], ",", 
     RowBox[{"Q", "+", "A"}], ",", "0.03"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.854934947899506*^9, 3.854934952360051*^9}, {
  3.8549350784609623`*^9, 3.854935090347475*^9}, {3.854935179556807*^9, 
  3.854935179936418*^9}, {3.854935212855719*^9, 3.854935223588255*^9}, {
  3.8549386544441433`*^9, 3.854938661014879*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"f0a8f1a3-47d3-4ca3-ada2-575add2b6635"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "Q"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`Q}, {$CellContext`X, \
$CellContext`X}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A"}, "RowWithSeparators"],OverscriptBox[
      "\[DoubleLongRightArrow]", "0.6`"],
      TemplateBox[{"+", "\"+\"", "R"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A}, {$CellContext`R}, 0.6]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "R", "Q"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "0.03`"],
      TemplateBox[{"+", "\"+\"", "Q", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`R, $CellContext`Q}, {$CellContext`Q, \
$CellContext`A}, 0.03]]}], "}"}]], "Output",
 CellChangeTimes->{3.8550837280593967`*^9, 3.8554168335224953`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"ffd8c70d-298a-482b-8968-ddde60f623af"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["A surface CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 
  3.821763615772613*^9}},ExpressionUUID->"9a984d52-6e2a-43df-8794-\
b6977b8b6c64"],

Cell[TextData[{
 "We will use the CRN simulator notation.  The CRN should not have any conc[ \
] statements; the initial state of the surface will be specified separately.\n\
\nThe following is a quick-and-dirty simulation that is extraordinarily \
inefficient if the CRN has vastly different rate constants, or if it has \
large areas in space where nothing is happening.  Still, \
it\[CloseCurlyQuote]s good enough for a basic exploration of ideas.  (More \
efficient simulators can be derived using priority queues and/or kd-trees.)\n\
\nMathematical principles:  The surface CRN model can be considered a CTMC \
where in a given state, every possible local reaction event has a transition \
rate (possibly 0).  On an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "c9f124d2-ff56-4284-94d7-8ded72c3a3bd"],
 " surface, there are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", " ", "m"}], TraditionalForm]],ExpressionUUID->
  "303cfd03-7b42-41e2-bb33-5b85a9255141"],
 " possible sites for unimolecular reactions to occur; the rate of reactions \
at each site is bounded by some ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["kmax", "uni"], TraditionalForm]],ExpressionUUID->
  "3f4fc7df-7771-4313-b907-01ba34b6d813"],
 " that reflects the possible species at that site with the fastest reactions \
(e.g. perhaps it is X, with available reactions X ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[RightArrow]", "3.2"], TraditionalForm]],ExpressionUUID->
  "ee6cc469-0f7f-4f6f-b4b9-fd25cc0fb205"],
 " Y, X ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[RightArrow]", "0.3"], TraditionalForm]],ExpressionUUID->
  "2e0842a4-e504-488b-be77-3370f05bf0e9"],
 "Z, and X ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[RightArrow]", "1.1"], TraditionalForm]],ExpressionUUID->
  "ef8db680-083b-45b1-98c8-14b22074b143"],
 "A for a total rate of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["kmax", "uni"], "=", "4.6"}], TraditionalForm]],
  ExpressionUUID->"5ebb7f3d-71a3-4d90-a293-b1adddc09f84"],
 ").  There are also ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", "(", 
     RowBox[{"m", "-", "1"}], ")"}], "+", 
    RowBox[{"m", "(", 
     RowBox[{"n", "-", "1"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "ac19a952-ee46-48a4-9711-e86a17dafb4d"],
 " possible vertical or horizontal pairs of neighboring sites where a \
bimolecular reaction could occur.  If we associate a reaction event for X+Y \
\[RightArrow] A+B with the site where the X is recognized, then again there \
is a maximum total rate of possible bimolecular reactions associated with the \
site, which will depend on the species and neighboring species.  We let ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["kmax", "bi"], TraditionalForm]],ExpressionUUID->
  "25cf79db-75ed-432a-bb05-aebd5e5971bb"],
 " be the maximum such total for a given site  and a single neighbor.  Then \
if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kmax", " ", "=", " ", 
    RowBox[{"max", "(", 
     RowBox[{
      SubscriptBox["kmax", "uni"], ",", 
      SubscriptBox["kmax", "bi"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "450621ed-1158-460b-8de5-234b383d414c"],
 ", then 5 kmax is a bound on the rate at which a reaction event associated \
with a given site could occur (the even is either unimolecular or bimolecular \
with one of 4 neighbors).\n\nNow we associate an event (called \
\[OpenCurlyDoubleQuote]something might have happened\[CloseCurlyDoubleQuote]) \
with equal rate 5 kmax at every site; 20% of the time, this will be a \
possible unimolecular event; 20% of the time, it will be a possible \
bimolecular event with the site and its north neighbor; 20% with its east \
neighbor, etc.  Thus, possible unimolecular events are being considered at \
rate kmax, etc.  In the case a unimolecular event is being considered, the \
actual species at the site is examined and all available unimolecular \
reactions in the CRN are determined, each with some ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "i"], TraditionalForm]],ExpressionUUID->
  "84d6dc76-01b6-4153-8ce0-58949c929370"],
 " that total to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "uni"], "\[LessEqual]", "kmax", " "}], 
   TraditionalForm]],ExpressionUUID->"3e3f2a98-c45b-4538-a10d-c4950324df7b"],
 ".   Thus, with probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      SubscriptBox["k", "uni"], "kmax"]}], ")"}], TraditionalForm]],
  ExpressionUUID->"d7a69d51-d168-458a-8a02-875488231f05"],
 ", nothing will actually happen, else reaction ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "57bd561e-a6df-4ebb-b185-d8a18c02d9b4"],
 " is chosen with probability proportional to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "i"], TraditionalForm]],ExpressionUUID->
  "6cb0b9ac-ffa9-42cf-a3a9-142a24b70b29"],
 ".  Similarly, if a particular site and neighbor is chosen for a possible \
bimolecular reaction, the available reactions are considered with rates \
totalling to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "bi"], "\[LessEqual]", "kmax"}], TraditionalForm]],
  ExpressionUUID->"092de8c0-1c17-45a6-9a86-ec81a753884f"],
 ", and again either nothing happens or a reaction is proportionally chosen.  \
The result is that the stochastic dynamics of the original CTMC are \
reproduced, but just with a lot of unproductive \[OpenCurlyDoubleQuote]we \
considered it but nothing happened\[CloseCurlyDoubleQuote] events when kmax \
is large but most sites have species present such that the actual reaction \
rates there are low; the simulation is reasonably efficient when every site \
at all times has reactions with rate kmax."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.821488389001959*^9, 
   3.8214884142545033`*^9}, {3.8214885908749247`*^9, 
   3.8214885998708687`*^9}, {3.821489394755782*^9, 3.8214894487941113`*^9}, {
   3.821495634801475*^9, 3.8214956430795803`*^9}, {3.821495781675638*^9, 
   3.821495781804488*^9}, {3.8214975326639233`*^9, 3.821497676369727*^9}, {
   3.821497736350408*^9, 3.821498062444824*^9}, 3.82149820393814*^9, {
   3.8214982408475513`*^9, 3.821498313089686*^9}, {3.8214988290375233`*^9, 
   3.8214988378212852`*^9}, {3.821498888257362*^9, 3.821498924511848*^9}, {
   3.821498965885638*^9, 3.821498985037698*^9}, {3.821499018489477*^9, 
   3.8214990543068247`*^9}, {3.821499114186317*^9, 3.821499114320249*^9}, {
   3.821500162499379*^9, 3.821500177294301*^9}, {3.82150041022064*^9, 
   3.821500417400031*^9}, {3.821500449113941*^9, 3.821500449741344*^9}, {
   3.821500536738905*^9, 3.821500542452323*^9}, {3.821500622212881*^9, 
   3.821500638995761*^9}, {3.821500677449667*^9, 3.8215007228246603`*^9}, {
   3.821500771404711*^9, 3.821500833838105*^9}, {3.8215008760199966`*^9, 
   3.8215013268268967`*^9}, {3.821669574973938*^9, 3.82166959539649*^9}, {
   3.821669752767663*^9, 3.821669815263381*^9}, {3.821669881436222*^9, 
   3.821669930544622*^9}, {3.8216699752294188`*^9, 3.821670072097687*^9}, {
   3.8217636237327957`*^9, 3.821763681580255*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"cb585fa4-3a27-45d5-bcf5-5366a60d6599"],

Cell[TextData[{
 "We will use the CRN simulator notation.  The CRN should not have any ",
 StyleBox["conc[ ] ",
  FontWeight->"Bold"],
 "statements; the initial state of the surface will be specified separately.  \
",
 StyleBox["rnxl[ ]",
  FontWeight->"Bold"],
 " representations, where the order or reactions is explicitly given, is \
needed; if the order-agnostic ",
 StyleBox["rxn[ ]",
  FontWeight->"Bold"],
 " is used, then an error is issued.   The initial state may be a 1D, 2D, or \
3D array."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.821488389001959*^9, 
   3.8214884142545033`*^9}, {3.8214885908749247`*^9, 
   3.8214885998708687`*^9}, {3.821489394755782*^9, 3.8214894487941113`*^9}, {
   3.821495634801475*^9, 3.8214956430795803`*^9}, {3.821495781675638*^9, 
   3.821495781804488*^9}, {3.8214975326639233`*^9, 3.821497676369727*^9}, {
   3.821497736350408*^9, 3.821498062444824*^9}, 3.82149820393814*^9, {
   3.8214982408475513`*^9, 3.821498313089686*^9}, {3.8214988290375233`*^9, 
   3.8214988378212852`*^9}, {3.821498888257362*^9, 3.821498924511848*^9}, {
   3.821498965885638*^9, 3.821498985037698*^9}, {3.821499018489477*^9, 
   3.8214990543068247`*^9}, {3.821499114186317*^9, 3.821499114320249*^9}, {
   3.821500162499379*^9, 3.821500177294301*^9}, {3.82150041022064*^9, 
   3.821500417400031*^9}, {3.821500449113941*^9, 3.821500449741344*^9}, {
   3.821500536738905*^9, 3.821500542452323*^9}, {3.821500622212881*^9, 
   3.821500638995761*^9}, {3.821500677449667*^9, 3.8215007228246603`*^9}, {
   3.821500771404711*^9, 3.821500833838105*^9}, {3.8215008760199966`*^9, 
   3.8215013268268967`*^9}, {3.821669574973938*^9, 3.82166959539649*^9}, {
   3.821669752767663*^9, 3.821669815263381*^9}, {3.821669881436222*^9, 
   3.821669930544622*^9}, {3.8216699752294188`*^9, 3.821670072097687*^9}, {
   3.8217636237327957`*^9, 3.821763681580255*^9}, {3.854933421475004*^9, 
   3.85493348383611*^9}, {3.855014726234761*^9, 3.855014777720107*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"a1a7c2c1-1b67-49e7-b576-261eb1f5fec2"],

Cell[TextData[{
 "If you want to know whether a surface CRN has halted,  i.e. no more \
reactions will ever be possible, then you may use the function below.  It is \
not fast for large surfaces, so it is not automatically done within ",
 StyleBox["RunSurfaceCRN", "Code"],
 ", but it would be reasonable to use every now and again after many reaction \
steps. Use it sparingly.  An example is provided in the space-bounded and \
tape-extending Turing machine constructions below."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.8221604247788687`*^9, 3.822160467626042*^9}, {
  3.822160510654777*^9, 3.82216052440516*^9}, {3.8221605842784224`*^9, 
  3.82216066771772*^9}, {3.8221612251049147`*^9, 3.822161245338393*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"dda1a1d2-6a06-4ed2-9101-bc627f8c7bb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HaltedSurfaceCRNQ", "[", 
   RowBox[{"crn_List", ",", "state_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l", ",", "m", ",", "n", ",", "unirules", ",", "birules", ",", "S", ",", 
      "ExistsReactionQ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "state", "]"}], "]"}], ",", "1", ",", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"{", "state", "}"}], "}"}]}], ",", "2", ",", 
       RowBox[{"S", "=", 
        RowBox[{"{", "state", "}"}]}], ",", "3", ",", 
       RowBox[{"S", "=", "state"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "S", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"birules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxnl", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a_", ",", "b_"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c_", ",", "d_"}], "}"}], ",", "k_"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], 
        ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"unirules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxnl", "[", 
            RowBox[{
             RowBox[{"{", "a_", "}"}], ",", 
             RowBox[{"{", "b_", "}"}], ",", "k_"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "a", "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], ",", 
        "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExistsReactionQ", "[", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "}"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ReplaceList", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "}"}], ",", 
             "unirules"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "l"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}], "]"}], 
                  "]"}]}], "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j", ",", "k"}], "]"}], 
                  "]"}]}], "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "<", "m"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}], ",", "k"}], "]"}], "]"}]}], 
                "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", ">", "1"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "-", "1"}], ",", "k"}], "]"}], "]"}]}], 
                "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "<", "n"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
               "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", ">", "1"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
               "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         "]"}], ">", "0"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", "l", "]"}], ",", 
           RowBox[{"Range", "[", "m", "]"}], ",", 
           RowBox[{"Range", "[", "n", "]"}]}], "}"}], "]"}], ",", 
        "ExistsReactionQ"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, {3.8221597971863737`*^9, 3.822159832660551*^9}, {
   3.822159878401012*^9, 3.8221599019053288`*^9}, {3.822159939933475*^9, 
   3.822159940378166*^9}, {3.822159973749579*^9, 3.822160224038684*^9}, {
   3.822160257177094*^9, 3.822160412588707*^9}, {3.822160553117717*^9, 
   3.8221605652423887`*^9}, {3.822160776398992*^9, 3.822160777564622*^9}, {
   3.822160809275507*^9, 3.822160822982099*^9}, {3.82216095267922*^9, 
   3.822160959424983*^9}, {3.822161019465481*^9, 3.8221610206559353`*^9}, {
   3.823303920584174*^9, 3.8233039208402042`*^9}, {3.854935792638802*^9, 
   3.854935797167431*^9}, {3.855015406449329*^9, 3.855015558828438*^9}, {
   3.855016548569076*^9, 3.855016578690069*^9}, {3.855016641303302*^9, 
   3.855016643963501*^9}, {3.855078910779458*^9, 3.855078913560461*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"786c3dab-28ef-4aac-80b0-bc87232e3869"],

Cell[TextData[{
 "The most informative simulator call will keep track of the number of \
reaction events that take place, and will by default automatically check at \
the end if no more reactions are possible.  It also returns the time at which \
the final state is given, which is always ",
 StyleBox["tmax",
  FontWeight->"Bold"],
 "; this format will be compatible with future options for the simulator that \
will automatically stop as soon as no more reactions are possible, providing \
a time stamp for that moment.  This simulator does check whether no more \
reactions are possible until the end, and will keep trying (and failing) to \
find reactions that apply until then."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.821488389001959*^9, 
   3.8214884142545033`*^9}, {3.8214885908749247`*^9, 
   3.8214885998708687`*^9}, {3.821489394755782*^9, 3.8214894487941113`*^9}, {
   3.821495634801475*^9, 3.8214956430795803`*^9}, {3.821495781675638*^9, 
   3.821495781804488*^9}, {3.8214975326639233`*^9, 3.821497676369727*^9}, {
   3.821497736350408*^9, 3.821498062444824*^9}, 3.82149820393814*^9, {
   3.8214982408475513`*^9, 3.821498313089686*^9}, {3.8214988290375233`*^9, 
   3.8214988378212852`*^9}, {3.821498888257362*^9, 3.821498924511848*^9}, {
   3.821498965885638*^9, 3.821498985037698*^9}, {3.821499018489477*^9, 
   3.8214990543068247`*^9}, {3.821499114186317*^9, 3.821499114320249*^9}, {
   3.821500162499379*^9, 3.821500177294301*^9}, {3.82150041022064*^9, 
   3.821500417400031*^9}, {3.821500449113941*^9, 3.821500449741344*^9}, {
   3.821500536738905*^9, 3.821500542452323*^9}, {3.821500622212881*^9, 
   3.821500638995761*^9}, {3.821500677449667*^9, 3.8215007228246603`*^9}, {
   3.821500771404711*^9, 3.821500833838105*^9}, {3.8215008760199966`*^9, 
   3.8215013268268967`*^9}, {3.821669574973938*^9, 3.82166959539649*^9}, {
   3.821669752767663*^9, 3.821669815263381*^9}, {3.821669881436222*^9, 
   3.821669930544622*^9}, {3.8216699752294188`*^9, 3.821670072097687*^9}, {
   3.8217636237327957`*^9, 3.821763681580255*^9}, {3.854933421475004*^9, 
   3.85493348383611*^9}, {3.855014726234761*^9, 3.855014777720107*^9}, {
   3.8550777060854397`*^9, 3.855077930850573*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"70f42b39-40cc-4b5e-adaf-1c4ea63cde86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InfoRunSurfaceCRN", "[", 
   RowBox[{"crn_List", ",", "state_List", ",", "tmax_", ",", 
    RowBox[{"haltcheck_", ":", "True"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "m", ",", "n", ",", "species", ",", 
      RowBox[{"count", "=", "0"}], ",", 
      RowBox[{"t", "=", "0"}], ",", "kmax", ",", "unirules", ",", "birules", 
      ",", "S", ",", "dirs", ",", "i", ",", "j", ",", "k", ",", "di", ",", 
      "dj", ",", "dk", ",", "actions", ",", "new1", ",", "new2", ",", "ktot", 
      ",", "balance"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"crn", ",", 
           RowBox[{"_conc", "|", "_rxn"}]}], "]"}], "=!=", "0"}], " ", "||", 
        " ", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"crn", ",", 
            RowBox[{"Except", "[", 
             RowBox[{
              RowBox[{"rxnl", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"_", ",", "_"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_"}], "}"}], ",", "_"}], "]"}], "|", 
              RowBox[{"rxnl", "[", 
               RowBox[{
                RowBox[{"{", "_", "}"}], ",", 
                RowBox[{"{", "_", "}"}], ",", "_"}], "]"}]}], "]"}]}], "]"}], 
          "]"}], ">", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Return", "[", 
        "\"\<conc and rxn statements not allowed. 1-1 and 2-2 rxnl only.\>\"",
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "state", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{"S", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", "state", "}"}], "}"}]}], ";", " ", 
        RowBox[{"dirs", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"{", "state", "}"}]}], ";", " ", 
        RowBox[{"dirs", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"+", "1"}]}], "}"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{"S", "=", "state"}], ";", " ", 
        RowBox[{"dirs", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"+", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"+", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "S", "]"}]}], ";", 
     RowBox[{"balance", "=", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Length", "[", "dirs", "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"birules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxnl", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a_", ",", "b_"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c_", ",", "d_"}], "}"}], ",", "k_"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], 
        ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"unirules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxnl", "[", 
            RowBox[{
             RowBox[{"{", "a_", "}"}], ",", 
             RowBox[{"{", "b_", "}"}], ",", "k_"}], "]"}], ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "a", "}"}], "->", 
             RowBox[{"{", 
              RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], ",", 
        "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"SpeciesInRxnsys", "[", "crn", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Last", "/@", 
           RowBox[{"Last", "/@", "#"}]}], "]"}], "&"}], "/@", 
        RowBox[{"GatherBy", "[", 
         RowBox[{
          RowBox[{"unirules", "~", "Join", "~", "birules"}], ",", "First"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"t", "<", "tmax"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "+=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"RandomReal", "[", "]"}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"balance", " ", "kmax", " ", "l", " ", "m", " ", "n"}], 
           ")"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", ">", "tmax"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "l"}], "}"}], "]"}], ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "m"}], "}"}], "]"}], ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomReal", "[", "]"}], "<", 
           RowBox[{"1", "/", "balance"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
           "unimolecular", " ", "rate", " ", "should", " ", "be", " ", 
            "balanced", " ", "with", " ", "the", " ", "bimolecular", " ", 
            "rates"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"actions", "=", 
            RowBox[{"ReplaceList", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "}"}], ",", 
              "unirules"}], "]"}]}], ";", 
           RowBox[{"ktot", "=", 
            RowBox[{"Total", "[", 
             RowBox[{"Last", "/@", "actions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "actions", "]"}], ">", "0"}], "&&", 
              RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"new1", "=", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Last", "/@", "actions"}], ")"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"First", "/@", "actions"}], ")"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "<", 
                 RowBox[{"ktot", "/", "kmax"}]}], ",", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
                 "new1"}]}], "]"}], ";", 
              RowBox[{"count", "++"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"else", " ", "bimolecular"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
            RowBox[{"RandomChoice", "[", "dirs", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "\[LessEqual]", 
               RowBox[{"i", "+", "di"}], "\[LessEqual]", "l"}], "&&", 
              RowBox[{"1", "\[LessEqual]", 
               RowBox[{"j", "+", "dj"}], "\[LessEqual]", "m"}], "&&", 
              RowBox[{"1", "\[LessEqual]", 
               RowBox[{"k", "+", "dk"}], "\[LessEqual]", "n"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"actions", "=", 
               RowBox[{"ReplaceList", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "}"}], ",", 
                 "birules"}], "]"}]}], ";", 
              RowBox[{"ktot", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"Last", "/@", "actions"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "actions", "]"}], ">", "0"}], "&&", 
                 RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                  RowBox[{"RandomChoice", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Last", "/@", "actions"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "actions"}], 
                    ")"}]}], "]"}]}], ";", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    RowBox[{"ktot", "/", "kmax"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}]}], ";", 
                    RowBox[{"count", "++"}]}]}], "]"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmax", ",", "count", ",", 
         RowBox[{"If", "[", 
          RowBox[{"haltcheck", ",", 
           RowBox[{"HaltedSurfaceCRNQ", "[", 
            RowBox[{"crn", ",", "S"}], "]"}], ",", "None"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Dimensions", "[", "state", "]"}], "]"}], ",", "1", ",", 
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "S", "]"}], "]"}], ",", "2", ",", 
         RowBox[{"First", "[", "S", "]"}], ",", "3", ",", "S"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, 3.827680801146142*^9, 
   3.827680850930419*^9, {3.8276813320701714`*^9, 3.827681337019346*^9}, {
   3.827681398645331*^9, 3.827681422937181*^9}, {3.8276815880857153`*^9, 
   3.8276816662040586`*^9}, {3.8276822049948606`*^9, 3.827682212794751*^9}, {
   3.827686280834577*^9, 3.827686281228088*^9}, {3.82768634303336*^9, 
   3.8276863977573347`*^9}, {3.854933503156061*^9, 3.854933655366639*^9}, {
   3.85493397752116*^9, 3.854934065707614*^9}, {3.85493409700473*^9, 
   3.8549342209929447`*^9}, {3.8549352777701283`*^9, 
   3.8549352810606413`*^9}, {3.854935332440695*^9, 3.8549354270047207`*^9}, {
   3.855014797180098*^9, 3.855014841087535*^9}, {3.8550148731736526`*^9, 
   3.8550150013133717`*^9}, {3.8550150984443007`*^9, 3.855015116651956*^9}, {
   3.85501515046148*^9, 3.855015339777399*^9}, {3.855015641978271*^9, 
   3.8550156425945044`*^9}, {3.855016359134782*^9, 3.855016402156248*^9}, {
   3.855016444443243*^9, 3.855016449729044*^9}, {3.855077432185482*^9, 
   3.855077517428381*^9}, {3.855077554153431*^9, 3.855077669503058*^9}, {
   3.855078917388867*^9, 3.855078919916051*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"61d2e35e-2fec-44ea-91a6-9f2f1f770d88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunSurfaceCRN", "[", 
   RowBox[{"crn_List", ",", "state_List", ",", "tmax_"}], "]"}], ":=", " ", 
  RowBox[{"Last", "[", 
   RowBox[{"InfoRunSurfaceCRN", "[", 
    RowBox[{"crn", ",", "state", ",", "tmax", ",", "False"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, 3.827680801146142*^9, 
   3.827680850930419*^9, {3.8276813320701714`*^9, 3.827681337019346*^9}, {
   3.827681398645331*^9, 3.827681422937181*^9}, {3.8276815880857153`*^9, 
   3.8276816662040586`*^9}, {3.8276822049948606`*^9, 3.827682212794751*^9}, {
   3.827686280834577*^9, 3.827686281228088*^9}, {3.82768634303336*^9, 
   3.8276863977573347`*^9}, {3.854933503156061*^9, 3.854933655366639*^9}, {
   3.85493397752116*^9, 3.854934065707614*^9}, {3.85493409700473*^9, 
   3.8549342209929447`*^9}, {3.8549352777701283`*^9, 
   3.8549352810606413`*^9}, {3.854935332440695*^9, 3.8549354270047207`*^9}, {
   3.855014797180098*^9, 3.855014841087535*^9}, {3.8550148731736526`*^9, 
   3.8550150013133717`*^9}, {3.8550150984443007`*^9, 3.855015116651956*^9}, {
   3.85501515046148*^9, 3.855015339777399*^9}, {3.855015641978271*^9, 
   3.8550156425945044`*^9}, {3.855016359134782*^9, 3.855016402156248*^9}, {
   3.855016444443243*^9, 3.855016449729044*^9}, {3.855077432185482*^9, 
   3.855077517428381*^9}, {3.855077554153431*^9, 3.855077669503058*^9}, {
   3.855077973117774*^9, 3.855078022718624*^9}, {3.855078923783251*^9, 
   3.855078926468144*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"5f208919-7123-402f-a003-c8bd6bdf294e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparing chemical reaction networks in well-mixed solutions versus on \
surfaces\
\>", "Section",
 CellChangeTimes->{{3.821763471510722*^9, 
  3.821763489665915*^9}},ExpressionUUID->"e64f10ff-3770-4a1d-8617-\
4295b3b88e8a"],

Cell["\<\
The asynchronous Greenberg-Hastings rules, as discussed in class, that \
provide a model for excitable media, heart muscle, forest fires, pandemics, \
etc.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"8cc5a8b9-9296-4003-ae83-a36138480b6b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AGH", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"A", "+", "Q"}], ",", 
      RowBox[{"A", "+", "A"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{"A", ",", "R", ",", "0.6"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{"R", ",", "Q", ",", "0.03"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.821490876281782*^9, 3.821490917084908*^9}, {
  3.827680868095828*^9, 3.827680933618231*^9}, {3.827681011567872*^9, 
  3.827681024026661*^9}, {3.827681057651225*^9, 3.827681058035466*^9}, {
  3.827681444177833*^9, 3.8276815044902153`*^9}, {3.82768190766726*^9, 
  3.827681931819696*^9}, {3.8549358226799927`*^9, 3.85493582665695*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"7f4b6524-dd2d-40f5-a4cb-4a6b100818af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "Q"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`Q}, {$CellContext`A, \
$CellContext`A}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A"}, "RowWithSeparators"],OverscriptBox[
      "\[DoubleLongRightArrow]", "0.6`"],
      TemplateBox[{"+", "\"+\"", "R"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A}, {$CellContext`R}, 0.6]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "R"}, "RowWithSeparators"],OverscriptBox[
      "\[DoubleLongRightArrow]", "0.03`"],
      TemplateBox[{"+", "\"+\"", "Q"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`R}, {$CellContext`Q}, 0.03]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.854971496177499*^9, 3.855015584294036*^9, 
  3.855078042005886*^9, 3.855083675938695*^9, 3.8550972599894867`*^9, 
  3.855416833656409*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"c107130b-8e98-42bc-a85b-0c4abea3c9f4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AGHstate", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "100"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "m"}], "&&", 
          RowBox[{"j", ">", "m"}]}], ",", "A", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ">", "m"}], "&&", 
            RowBox[{"j", ">", "m"}]}], ",", "R", ",", "Q"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"AGHtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"d3f1c5b4-f101-4476-abfb-8135207e8221"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AGHstate", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "40"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "0"}], "&&", 
          RowBox[{"j", ">", "0"}]}], ",", "A", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], "&&", 
            RowBox[{"j", ">", "0"}]}], ",", "R", ",", "Q"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"AGHtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.827672823897726*^9, 3.8276728556829567`*^9}, {
  3.854710629064*^9, 3.854710646141625*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"9169c658-ca6c-4834-b49d-be8700651e3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"AGHstate", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "Red"}], ",", 
       RowBox[{"Q", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
       RowBox[{"R", "\[Rule]", "Blue"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "AGHtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
  3.8214912667784557`*^9, 3.821491269984231*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"405961e4-d4db-4a72-bdd4-da682ac2f8b8"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`AGHstate, 
    ColorRules -> {$CellContext`A -> Red, $CellContext`Q -> 
      GrayLevel[0.9], $CellContext`R -> Blue}, 
    PlotLabel -> $CellContext`AGHtime], StandardForm],
  ImageSizeCache->{518., {3., 9.}}]], "Output",
 CellChangeTimes->{3.855416833817472*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"13902cce-c183-4b20-acbb-027c978b408f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"AGHstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"AGH", ",", "AGHstate", ",", "0.1"}], "]"}]}], ";", 
    RowBox[{"AGHtime", "+=", "0.1"}]}], ",", "1000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8216679462299957`*^9, 
   3.821668003359963*^9}, 3.8276827845531607`*^9, 3.827685343053816*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"4c67e60d-1487-4eaf-98ba-08177eb02156"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.8554168440011516`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"c7fa438c-7cd2-4530-8bc3-b0fe33c4f196"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{"AGH", ",", "AGHstate", ",", "0.1"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8214941208359423`*^9, 3.821494148838941*^9}, {
  3.821495511260285*^9, 3.821495512708765*^9}, {3.82166798877343*^9, 
  3.8216679979947844`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"12088e67-847b-422d-a0f8-2bc23249f396"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.046875`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.8554169694321823`*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"b15f07d5-677b-4a6b-95a8-c60aee3f3c03"]
}, Open  ]],

Cell[TextData[{
 "For comparison, let\[CloseCurlyQuote]s examine the same CRN but with \
well-mixed deterministic and stochastic semantics.  For our initial state, we\
\[CloseCurlyQuote]ll just count the total number of As, Rs, and Qs in \
AGHstate.  Our bimolecular rate constants in the surface CRN are the \
per-second rates of the reaction when a pair of molecules are directly next \
to each other, i.e. a volume containing a count of 1.  So a well-mixed system \
with the same concentrations should entail scaling up to volume ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["m", "2"], TraditionalForm]],ExpressionUUID->
  "c1ec013e-8f72-4500-bd3a-7334c8933283"],
 ".  Or for deterministic semantics, the concentration should be the count \
divided by the total number of pixels.  (To be careful about units here, \
recognize that the fundamental volume for the surface CRN is not the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "0"], "=", "1.66"}], TraditionalForm]],ExpressionUUID->
  "2f479133-d889-4940-9fec-2eb02855994d"],
 " fL that we used for well-mixed stochastic CRNs, in which case the same \
rate constant numbers corresponded such that 1 count was 1 nM.   But in the \
surface CRN, 1 count corresponds to a reference volume ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "0"], TraditionalForm]],ExpressionUUID->
  "a9c1062c-8f40-4b8d-8736-425b5f4aa91b"],
 " that relates to the lattice spacing, and is maybe the size of \
\[OpenCurlyDoubleQuote]one molecule\[CloseCurlyDoubleQuote].  So, knowing ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "0"], TraditionalForm]],ExpressionUUID->
  "0c5bbd03-758b-4c70-8a63-84390a0f6add"],
 " you could work out the corresponding bulk concentrations in the \
simulations below, if you care to.)\n\nMain point being that the same CRN can \
be boring in the well-mixed scenario while nonetheless exhibiting interesting \
pattern formation in a spatially organized context."
}], "Text",
 CellChangeTimes->{{3.821664589667283*^9, 3.821664837777801*^9}, {
  3.821665052002521*^9, 3.821665056802747*^9}, {3.82166509176864*^9, 
  3.821665103840519*^9}, {3.821665548635887*^9, 3.8216655972037983`*^9}, {
  3.821665628134726*^9, 3.821665718084351*^9}, {3.821850938574731*^9, 
  3.8218512151003323`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"6711f994-2c2b-4649-a355-c0ab8a3025d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "AGHstate", "]"}]}], "}"}], ",", 
     RowBox[{"AGH", "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "AGHstate", "]"}], ",", "#"}], "]"}], 
            "/", 
            RowBox[{"m", "^", "2"}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"A", ",", "Q", ",", "R"}], "}"}]}], ")"}]}]}], "]"}]}], ";", 
  
  RowBox[{"sol", "=", 
   RowBox[{"SimulateRxnsys", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "[", "t", "]"}], ",", 
       RowBox[{"Q", "[", "t", "]"}], ",", 
       RowBox[{"R", "[", "t", "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"A", ",", "Q", ",", "R"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.821281109110265*^9, 3.821281129382753*^9}, {
  3.821291083791642*^9, 3.821291085805176*^9}, {3.821665144451765*^9, 
  3.8216652763017282`*^9}, {3.821665424057819*^9, 3.8216655328162613`*^9}, {
  3.821666330780233*^9, 3.821666331753549*^9}, {3.854936014559451*^9, 
  3.854936021130603*^9}, {3.854937342248351*^9, 3.85493734907367*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"e105d386-338b-47a8-9031-ad4d3bab3a13"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
/wE1TCOa
          "]]}, Annotation[#, "Charting`Private`Tag$81893#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
Bf9eXXWGCr/VjQ+w/wMdD03V
          "]]}, 
        Annotation[#, "Charting`Private`Tag$81893#2"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
5a7DQv8DRC9cDw==
          "]]}, 
        Annotation[#, "Charting`Private`Tag$81893#3"]& ]}}, {}}, {
    DisplayFunction -> Identity, Ticks -> {Automatic, Automatic}, 
     AxesOrigin -> {0, 0}, FrameTicks -> {{Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {0, 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None,
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0., 99.99999795918367}, {0, All}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {Automatic, Automatic}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"A", "Q", "R"}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.560181`", ",", "0.691569`", ",", "0.194885`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.855416972965747*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"99aeb87c-85ea-41de-837b-52e389feb2e1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "AGHstate", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"RescaleVolume", "[", 
       RowBox[{"AGH", ",", 
        RowBox[{"m", "^", "2"}]}], "]"}], "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "AGHstate", "]"}], ",", "#"}], "]"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"A", ",", "Q", ",", "R"}], "}"}]}], ")"}]}]}], "]"}]}], ";", 
  
  RowBox[{"trajectory", "=", 
   RowBox[{"SimulateRxnsysSSA", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"PlotFormat", "[", 
    RowBox[{"trajectory", ",", "rsys", ",", 
     RowBox[{"{", 
      RowBox[{"A", ",", "Q", ",", "R"}], "}"}], ",", "1000"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"A", ",", "Q", ",", "R"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.655569381302664*^9, 3.655569430982396*^9}, 
   3.655569599889739*^9, {3.655569637042144*^9, 3.655569637132442*^9}, {
   3.655570171755032*^9, 3.655570171935727*^9}, {3.655570206719384*^9, 
   3.655570210834999*^9}, {3.6555864935614853`*^9, 3.65558649360857*^9}, {
   3.655586532402664*^9, 3.655586532452038*^9}, 3.655599011066224*^9, {
   3.655599070351659*^9, 3.6555990711787157`*^9}, {3.656251704743993*^9, 
   3.6562517236909122`*^9}, 3.656252655029769*^9, {3.6562527354262733`*^9, 
   3.656252736252966*^9}, {3.656252782391427*^9, 3.656252783617483*^9}, {
   3.65625294811371*^9, 3.65625294992074*^9}, {3.656262364108659*^9, 
   3.6562623876853848`*^9}, {3.656262641047584*^9, 3.656262641688209*^9}, {
   3.656281322111396*^9, 3.656281322433421*^9}, {3.6562892839283752`*^9, 
   3.656289296750527*^9}, 3.692465945546311*^9, {3.69423077101507*^9, 
   3.6942307864303617`*^9}, {3.694230831480823*^9, 3.6942308316782*^9}, {
   3.694436395397346*^9, 3.694436397516592*^9}, {3.820626181739964*^9, 
   3.820626190503669*^9}, {3.820626805105732*^9, 3.820626809905645*^9}, {
   3.820629600395542*^9, 3.820629605829145*^9}, {3.821223411247621*^9, 
   3.821223573491192*^9}, {3.821223636858522*^9, 3.821223657288546*^9}, {
   3.821223806509273*^9, 3.821223852160828*^9}, {3.8212260550388613`*^9, 
   3.821226056398467*^9}, {3.821226290255107*^9, 3.821226344429927*^9}, {
   3.821226387985219*^9, 3.821226389205044*^9}, {3.821281161237898*^9, 
   3.821281164869025*^9}, {3.821291215912805*^9, 3.821291218412695*^9}, 
   3.821665287174398*^9, 3.821665426323245*^9, 3.821666338178026*^9, {
   3.821666666411887*^9, 3.821666672355258*^9}, {3.8547107279028263`*^9, 
   3.854710747249915*^9}, {3.854710785354486*^9, 3.854710785503656*^9}, {
   3.8547109075079813`*^9, 3.854710919223503*^9}, 3.854937357213581*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"a44057b4-0a23-4b39-a040-6ea3981118bd"],

Cell["\<\
As a second example, consider a CRN that performs a winner-take-all or \
consensus function: whichever of X or Y is initially more numerous will \
eventually (actually, quickly) take over the population (with some \
probability of error with stochastic dynamics.

Note that we include \[OpenCurlyDoubleQuote]diffusion\[CloseCurlyDoubleQuote] \
reactions that just swap the locations of molecules on the surface.  These \
reactions do nothing in the well-mixed scenario, but are necessary for X, Y, \
and Q to interact on the surface because our model does not implicitly assume \
diffusion.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.8216657449086657`*^9, 3.821665828061088*^9}, {
  3.821665914682643*^9, 3.821665916211339*^9}, {3.821665991553988*^9, 
  3.821666072932983*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"1b4c7519-7ead-4973-8a95-4bd6e13a40b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "kd", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "diffusion", " ", "constant", " ", "is", " ", "left", " ", "symbolic"}], 
     ";", " ", 
     RowBox[{
      RowBox[{"irrelevant", " ", "for", " ", "well"}], "-", 
      RowBox[{"mixed", " ", "CRNs"}]}]}], ",", " ", 
    RowBox[{
    "but", " ", "must", " ", "be", " ", "set", " ", "for", " ", "numnerics", 
     " ", "anyway"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WTA", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"X", "+", "Y"}], ",", 
      RowBox[{"Q", "+", "Q"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"X", "+", "Q"}], ",", 
      RowBox[{"X", "+", "X"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"Y", "+", "Q"}], ",", 
      RowBox[{"Y", "+", "Y"}], ",", "1"}], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"consensus", " ", "dynamics"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"W", "+", "X"}], ",", 
      RowBox[{"X", "+", "W"}], ",", "kd"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"W", "+", "Y"}], ",", 
      RowBox[{"Y", "+", "W"}], ",", "kd"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"W", "+", "Q"}], ",", 
      RowBox[{"Q", "+", "W"}], ",", "kd"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"diffusion", " ", "through", " ", "water"}], " ", "*)"}], 
   "\[IndentingNewLine]", "}"}]}]}], "Input",
 CellChangeTimes->{{3.821490876281782*^9, 3.821490917084908*^9}, {
  3.821665853758943*^9, 3.82166598616954*^9}, {3.821666971615239*^9, 
  3.821666976335046*^9}, {3.821668803247568*^9, 3.821668831283559*^9}, {
  3.8218937767192574`*^9, 3.821893782164707*^9}, {3.854937409741424*^9, 
  3.854937420026691*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"c4ee24dc-dab3-4ab4-9682-c1000d800082"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WTAstate", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "100"}], "}"}], ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{".26", ",", ".24", ",", "0", ",", ".5"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821666116116989*^9, 3.821666211113645*^9}, {
   3.8216665742801943`*^9, 3.821666576661065*^9}, 3.8218938355448103`*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"f6656ab5-3619-4a7f-9991-30c06255745f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "WTAstate", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"WTA", "/.", 
        RowBox[{"{", 
         RowBox[{"kd", "\[Rule]", "1"}], "}"}]}], ")"}], "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "WTAstate", "]"}], ",", "#"}], "]"}], 
             "/", "Vm"}], "/.", 
            RowBox[{"{", 
             RowBox[{"Vm", "\[Rule]", 
              RowBox[{
               RowBox[{"m", "^", "2"}], "/", "4"}]}], "}"}]}]}], "]"}], "&"}],
         "/@", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}], ")"}]}]}], 
    "]"}]}], ";", 
  RowBox[{"sol", "=", 
   RowBox[{"SimulateRxnsys", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X", "[", "t", "]"}], ",", 
       RowBox[{"Y", "[", "t", "]"}], ",", 
       RowBox[{"Q", "[", "t", "]"}], ",", 
       RowBox[{"W", "[", "t", "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.821281109110265*^9, 3.821281129382753*^9}, {
  3.821291083791642*^9, 3.821291085805176*^9}, {3.821665144451765*^9, 
  3.8216652763017282`*^9}, {3.821665424057819*^9, 3.8216655328162613`*^9}, {
  3.82166610323247*^9, 3.821666108546418*^9}, {3.821666218895554*^9, 
  3.821666231596869*^9}, {3.821666291749363*^9, 3.821666302473649*^9}, {
  3.821666353170912*^9, 3.821666376249502*^9}, {3.821666586065983*^9, 
  3.821666586175139*^9}, {3.821893794348399*^9, 3.821893808429654*^9}, {
  3.821897771286845*^9, 3.821897772918714*^9}, {3.821897807859922*^9, 
  3.821897845366637*^9}, {3.8549374320925426`*^9, 3.854937435281645*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"a894b1ce-ed02-4699-9204-55d2a4e52ade"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "WTAstate", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"RescaleVolume", "[", 
       RowBox[{
        RowBox[{"WTA", "/.", 
         RowBox[{"{", 
          RowBox[{"kd", "\[Rule]", "1"}], "}"}]}], ",", 
        RowBox[{"Vm", "/.", 
         RowBox[{"{", 
          RowBox[{"Vm", "\[Rule]", 
           RowBox[{
            RowBox[{"m", "^", "2"}], "/", "4"}]}], "}"}]}]}], "]"}], "~", 
      "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "WTAstate", "]"}], ",", "#"}], "]"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}], ")"}]}]}], 
    "]"}]}], ";", 
  RowBox[{"trajectory", "=", 
   RowBox[{"SimulateRxnsysSSA", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"PlotFormat", "[", 
    RowBox[{"trajectory", ",", "rsys", ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}], ",", "1000"}], 
    "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.655569381302664*^9, 3.655569430982396*^9}, 
   3.655569599889739*^9, {3.655569637042144*^9, 3.655569637132442*^9}, {
   3.655570171755032*^9, 3.655570171935727*^9}, {3.655570206719384*^9, 
   3.655570210834999*^9}, {3.6555864935614853`*^9, 3.65558649360857*^9}, {
   3.655586532402664*^9, 3.655586532452038*^9}, 3.655599011066224*^9, {
   3.655599070351659*^9, 3.6555990711787157`*^9}, {3.656251704743993*^9, 
   3.6562517236909122`*^9}, 3.656252655029769*^9, {3.6562527354262733`*^9, 
   3.656252736252966*^9}, {3.656252782391427*^9, 3.656252783617483*^9}, {
   3.65625294811371*^9, 3.65625294992074*^9}, {3.656262364108659*^9, 
   3.6562623876853848`*^9}, {3.656262641047584*^9, 3.656262641688209*^9}, {
   3.656281322111396*^9, 3.656281322433421*^9}, {3.6562892839283752`*^9, 
   3.656289296750527*^9}, 3.692465945546311*^9, {3.69423077101507*^9, 
   3.6942307864303617`*^9}, {3.694230831480823*^9, 3.6942308316782*^9}, {
   3.694436395397346*^9, 3.694436397516592*^9}, {3.820626181739964*^9, 
   3.820626190503669*^9}, {3.820626805105732*^9, 3.820626809905645*^9}, {
   3.820629600395542*^9, 3.820629605829145*^9}, {3.821223411247621*^9, 
   3.821223573491192*^9}, {3.821223636858522*^9, 3.821223657288546*^9}, {
   3.821223806509273*^9, 3.821223852160828*^9}, {3.8212260550388613`*^9, 
   3.821226056398467*^9}, {3.821226290255107*^9, 3.821226344429927*^9}, {
   3.821226387985219*^9, 3.821226389205044*^9}, {3.821281161237898*^9, 
   3.821281164869025*^9}, {3.821291215912805*^9, 3.821291218412695*^9}, 
   3.821665287174398*^9, 3.821665426323245*^9, 3.821666104799966*^9, {
   3.8216662370216312`*^9, 3.821666246799837*^9}, 3.8216663500267344`*^9, {
   3.821666381408066*^9, 3.821666381463311*^9}, {3.821666594680539*^9, 
   3.821666594756166*^9}, {3.821666644123558*^9, 3.8216666530199633`*^9}, {
   3.8218938121609983`*^9, 3.821893816840061*^9}, {3.8218977859096413`*^9, 
   3.821897809956902*^9}, {3.821897849401781*^9, 3.8218978494851923`*^9}, {
   3.854937439529276*^9, 3.8549374451785173`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"213648da-2f3a-4038-ba1f-0720d742cd35"],

Cell["\<\
The observation here is that for this CRN with geometry, the interactions \
between species become limited to boundaries between homogeneous regions, and \
thus convergence can be very slow.  In the limit as the diffusion rates \
approach infinity, convergence approaches the same speed as the well-mixed \
system (although simulation might take a while, since then mostly it\
\[CloseCurlyQuote]s simulating diffusion).\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.8216657449086657`*^9, 3.821665828061088*^9}, {
  3.821665914682643*^9, 3.821665916211339*^9}, {3.821665991553988*^9, 
  3.821666072932983*^9}, {3.82166680277216*^9, 3.821666946142874*^9}, {
  3.821669015704273*^9, 3.821669034167116*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"b22090b1-e357-44e9-ada8-28edd86b4133"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"WTAstate", ",", 
      RowBox[{"ColorRules", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "\[Rule]", "Blue"}], ",", 
         RowBox[{"Y", "\[Rule]", "Orange"}], ",", 
         RowBox[{"Q", "\[Rule]", "Green"}], ",", 
         RowBox[{"W", "\[Rule]", 
          RowBox[{"GrayLevel", "[", "0.9", "]"}]}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", "WTAtime"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "WTAhistory", "]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
         RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}], ",", "Bottom"}],
         "]"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<iterations\>\"", ",", "\"\<counts\>\""}], "}"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
  3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821666402739387*^9, 
  3.8216664361548443`*^9}, {3.821893622558826*^9, 3.8218936494592857`*^9}, {
  3.8218947570986433`*^9, 3.821894777071211*^9}, {3.8550159645362177`*^9, 
  3.855015965796756*^9}},
 CellLabel->
  "In[422]:=",ExpressionUUID->"d744df14-5aae-4208-832d-516a64e7230a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WTAtime", "=", "0"}], ";", 
  RowBox[{"WTAhistory", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "WTAstate", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"WTAstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{
       RowBox[{"WTA", "/.", 
        RowBox[{"{", 
         RowBox[{"kd", "\[Rule]", "1"}], "}"}]}], ",", "WTAstate", ",", 
       ".1"}], "]"}]}], ";", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"WTAhistory", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "WTAstate", "]"}], ",", "#"}], "]"}], "&"}],
        "/@", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y", ",", "Q", ",", "W"}], "}"}]}]}], "]"}], ";", 
    RowBox[{"WTAtime", "+=", "0.1"}]}], ",", "250"}], "]"}]}], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.82166644256629*^9, 
   3.821666452132885*^9}, 3.821666515815844*^9, {3.82166839068404*^9, 
   3.82166842602209*^9}, {3.821847178235992*^9, 3.821847189020856*^9}, {
   3.821847650881916*^9, 3.821847678627214*^9}, 3.821847903273849*^9, {
   3.821848012199296*^9, 3.821848012650454*^9}, {3.821848608605753*^9, 
   3.821848608876388*^9}, {3.821855776849679*^9, 3.821855787763978*^9}, {
   3.821855820331203*^9, 3.821855917955414*^9}, 3.821855975565772*^9, {
   3.821883253710037*^9, 3.8218832537610807`*^9}, 3.82188666698765*^9, 
   3.821886921149913*^9, {3.8218936881967897`*^9, 3.821893728651086*^9}, {
   3.821893911782769*^9, 3.82189391333652*^9}, {3.8218978708772717`*^9, 
   3.8218978738335857`*^9}, 3.821898081241456*^9, {3.821898133735899*^9, 
   3.821898133858695*^9}, {3.8219005122431183`*^9, 3.821900512384397*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"e3127d31-7d68-419d-aa84-8dae77d1f6e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{"WTA", ",", "WTAstate", ",", "0.1"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8214941208359423`*^9, 3.821494148838941*^9}, {
  3.821495511260285*^9, 3.821495512708765*^9}, {3.8216687602638893`*^9, 
  3.821668771193119*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"97c657d9-0f1d-4c5d-9a9a-6cfb2232764b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001434`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.821494127056902*^9, 3.821494150318115*^9}, 
   3.821495513904023*^9, {3.821668792410816*^9, 3.82166879517176*^9}, 
   3.821668841670136*^9, 3.8549376156056232`*^9, 3.85501603341545*^9},
 CellLabel->
  "Out[425]=",ExpressionUUID->"3135fddf-a53d-4a3c-9472-fa63662ddd60"]
}, Open  ]],

Cell["\<\
Rock-Paper-Scissors oscillator -- another of the simplest CRN oscillators.   \
We chose it here because all 3 reactions are bimolecular, which is \
convenient.  (It is interesting to think about how to implement the \
predator-prey oscillator as a surface CRN, as two of its reactions don\
\[CloseCurlyQuote]t conserve total molecule counts.)\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.8216657449086657`*^9, 3.821665828061088*^9}, {
  3.821665914682643*^9, 3.821665916211339*^9}, {3.821665991553988*^9, 
  3.821666072932983*^9}, {3.821846067473999*^9, 3.821846074601615*^9}, {
  3.821846892800522*^9, 3.821846899122208*^9}, {3.821849120008513*^9, 
  3.821849221146908*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"6bf0af83-4d09-4c91-9de9-955c4feb99c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"kd", ",", "Vm"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "diffusion", " ", "constant", " ", "is", " ", "left", " ", "symbolic"}], 
     ";", " ", 
     RowBox[{
      RowBox[{"irrelevant", " ", "for", " ", "well"}], "-", 
      RowBox[{"mixed", " ", "CRNs"}]}]}], ",", " ", 
    RowBox[{
    "but", " ", "must", " ", "be", " ", "set", " ", "for", " ", "numnerics", 
     " ", "anyway"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RPS", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"R", "+", "P"}], ",", 
      RowBox[{"P", "+", "P"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"P", "+", "S"}], ",", 
      RowBox[{"S", "+", "S"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"S", "+", "R"}], ",", 
      RowBox[{"R", "+", "R"}], ",", "1"}], "]"}], ",", "        ", 
    RowBox[{"(*", " ", 
     RowBox[{"rock", "-", "paper", "-", 
      RowBox[{"scissors", " ", "dynamics"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"R", "+", "W"}], ",", 
      RowBox[{"W", "+", "R"}], ",", "kd"}], "]"}], ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"P", "+", "W"}], ",", 
      RowBox[{"W", "+", "P"}], ",", "kd"}], "]"}], " ", ",", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"S", "+", "W"}], ",", 
      RowBox[{"W", "+", "S"}], ",", "kd"}], "]"}]}], "    ", 
   RowBox[{"(*", " ", 
    RowBox[{"diffusion", " ", "through", " ", "\"\<water\>\""}], " ", "*)"}], 
   "\[IndentingNewLine]", "}"}], " "}]}], "Input",
 CellChangeTimes->{{3.821490876281782*^9, 3.821490917084908*^9}, {
   3.821665853758943*^9, 3.82166598616954*^9}, {3.821666971615239*^9, 
   3.821666976335046*^9}, {3.821668803247568*^9, 3.821668831283559*^9}, {
   3.821846085771031*^9, 3.821846216096702*^9}, {3.821846564875229*^9, 
   3.821846572131125*^9}, {3.821846686025104*^9, 3.821846750145546*^9}, {
   3.821846786786584*^9, 3.8218467897489653`*^9}, {3.821846903083411*^9, 
   3.821846992760832*^9}, {3.8218472474520493`*^9, 3.821847249972533*^9}, 
   3.821847318741909*^9, {3.82184753592763*^9, 3.821847558270273*^9}, {
   3.82184759433602*^9, 3.821847624109664*^9}, {3.821897017847207*^9, 
   3.8218970183837757`*^9}, {3.854937626340271*^9, 3.854937637386147*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"e1a46dcb-8041-4946-88b2-460d4fdac571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"a", " ", "low"}], "-", 
    RowBox[{"density", " ", "initial", " ", "state"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RPSstate", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", "100"}], "}"}], ",", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.025", ",", "0.025", ",", ".9"}], "}"}], 
         "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.821666116116989*^9, 3.821666211113645*^9}, {
   3.8216665742801943`*^9, 3.821666576661065*^9}, {3.8218462112028112`*^9, 
   3.821846256898541*^9}, {3.8218466183436537`*^9, 3.821846628958137*^9}, {
   3.821846821607633*^9, 3.821846825097743*^9}, {3.8218469999318933`*^9, 
   3.8218470399054947`*^9}, {3.821847090723627*^9, 3.821847106865471*^9}, {
   3.821847444797826*^9, 3.821847449216009*^9}, {3.821847787960937*^9, 
   3.821847804269754*^9}, 3.8218557608840017`*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"91aab686-5c2e-4db5-97fc-c6c43d27f28d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"a", " ", "medium"}], "-", 
    RowBox[{"density", " ", "initial", " ", "state"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RPSstate", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", "100"}], "}"}], ",", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "3"}], ",", 
           RowBox[{"1", "/", "12"}], ",", 
           RowBox[{"1", "/", "12"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.821666116116989*^9, 3.821666211113645*^9}, {
   3.8216665742801943`*^9, 3.821666576661065*^9}, {3.8218462112028112`*^9, 
   3.821846256898541*^9}, {3.8218466183436537`*^9, 3.821846628958137*^9}, {
   3.821846821607633*^9, 3.821846825097743*^9}, {3.8218469999318933`*^9, 
   3.8218470399054947`*^9}, {3.821847090723627*^9, 3.821847106865471*^9}, {
   3.821847430648703*^9, 3.821847438152858*^9}, 3.8218557653828363`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"43009b56-8c16-4b9a-bfb2-cb5bdc277042"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"a", " ", "high"}], "-", 
    RowBox[{"density", " ", "initial", " ", "state"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RPSstate", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", "100"}], "}"}], ",", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0.2", ",", "0.2", ",", "0.1"}], 
          "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.821666116116989*^9, 3.821666211113645*^9}, {
   3.8216665742801943`*^9, 3.821666576661065*^9}, {3.8218462112028112`*^9, 
   3.821846256898541*^9}, {3.8218466183436537`*^9, 3.821846628958137*^9}, {
   3.821846821607633*^9, 3.821846825097743*^9}, {3.8218469999318933`*^9, 
   3.8218470399054947`*^9}, {3.821847090723627*^9, 3.821847106865471*^9}, {
   3.821847452227899*^9, 3.821847483517962*^9}, 3.8218557687679234`*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"3f9ac338-f773-4014-bb3d-9d3581a5ac05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"an", " ", "initially", " ", "phase"}], "-", 
    RowBox[{"separated", " ", "initial", " ", "state"}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RPSstate", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", "100"}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "m"}], "&&", 
           RowBox[{"j", ">", "m"}]}], ",", "R", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", ">", "m"}], "&&", 
             RowBox[{"j", ">", "m"}]}], ",", "P", ",", "S"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"2", "m"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"2", "m"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
   3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
   3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
   3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
   3.821494052380019*^9}, {3.8218481193312902`*^9, 3.8218481739690113`*^9}, 
   3.821855771364541*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"34605e4c-58ee-459a-9c45-b294ff040f7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "RPSstate", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"RPS", "/.", 
        RowBox[{"{", 
         RowBox[{"kd", "\[Rule]", "1"}], "}"}]}], ")"}], "~", "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "RPSstate", "]"}], ",", "#"}], "]"}], 
             "/", "Vm"}], "/.", 
            RowBox[{"{", 
             RowBox[{"Vm", "\[Rule]", 
              RowBox[{
               RowBox[{"m", "^", "2"}], "/", "4"}]}], "}"}]}]}], "]"}], "&"}],
         "/@", 
        RowBox[{"{", 
         RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], ")"}]}]}], 
    "]"}]}], ";", 
  RowBox[{"sol", "=", 
   RowBox[{"SimulateRxnsys", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", "t", "]"}], ",", 
       RowBox[{"P", "[", "t", "]"}], ",", 
       RowBox[{"S", "[", "t", "]"}], ",", 
       RowBox[{"W", "[", "t", "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.821281109110265*^9, 3.821281129382753*^9}, {
  3.821291083791642*^9, 3.821291085805176*^9}, {3.821665144451765*^9, 
  3.8216652763017282`*^9}, {3.821665424057819*^9, 3.8216655328162613`*^9}, {
  3.82166610323247*^9, 3.821666108546418*^9}, {3.821666218895554*^9, 
  3.821666231596869*^9}, {3.821666291749363*^9, 3.821666302473649*^9}, {
  3.821666353170912*^9, 3.821666376249502*^9}, {3.821666586065983*^9, 
  3.821666586175139*^9}, {3.821846273138323*^9, 3.821846286499733*^9}, {
  3.82184633440578*^9, 3.8218463568066177`*^9}, {3.821846767149198*^9, 
  3.8218467725166597`*^9}, {3.8218470428890867`*^9, 3.8218470666567087`*^9}, {
  3.8218475669201097`*^9, 3.8218475765189543`*^9}, {3.821897002163417*^9, 
  3.821897010420684*^9}, {3.8218975460515623`*^9, 3.821897569320293*^9}, {
  3.854937653376318*^9, 3.854937658137212*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"931a2248-8dec-44cb-ad3a-25a142482ff9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsys", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "RPSstate", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"RescaleVolume", "[", 
       RowBox[{
        RowBox[{"RPS", "/.", 
         RowBox[{"{", 
          RowBox[{"kd", "\[Rule]", "1"}], "}"}]}], ",", 
        RowBox[{"Vm", "/.", 
         RowBox[{"{", 
          RowBox[{"Vm", "\[Rule]", 
           RowBox[{
            RowBox[{"m", "^", "2"}], "/", "4"}]}], "}"}]}]}], "]"}], "~", 
      "Join", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"conc", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "RPSstate", "]"}], ",", "#"}], "]"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], ")"}]}]}], 
    "]"}]}], ";", 
  RowBox[{"trajectory", "=", 
   RowBox[{"SimulateRxnsysSSA", "[", 
    RowBox[{"rsys", ",", "tmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"PlotFormat", "[", 
    RowBox[{"trajectory", ",", "rsys", ",", 
     RowBox[{"{", 
      RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}], ",", "1000"}], 
    "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.655569381302664*^9, 3.655569430982396*^9}, 
   3.655569599889739*^9, {3.655569637042144*^9, 3.655569637132442*^9}, {
   3.655570171755032*^9, 3.655570171935727*^9}, {3.655570206719384*^9, 
   3.655570210834999*^9}, {3.6555864935614853`*^9, 3.65558649360857*^9}, {
   3.655586532402664*^9, 3.655586532452038*^9}, 3.655599011066224*^9, {
   3.655599070351659*^9, 3.6555990711787157`*^9}, {3.656251704743993*^9, 
   3.6562517236909122`*^9}, 3.656252655029769*^9, {3.6562527354262733`*^9, 
   3.656252736252966*^9}, {3.656252782391427*^9, 3.656252783617483*^9}, {
   3.65625294811371*^9, 3.65625294992074*^9}, {3.656262364108659*^9, 
   3.6562623876853848`*^9}, {3.656262641047584*^9, 3.656262641688209*^9}, {
   3.656281322111396*^9, 3.656281322433421*^9}, {3.6562892839283752`*^9, 
   3.656289296750527*^9}, 3.692465945546311*^9, {3.69423077101507*^9, 
   3.6942307864303617`*^9}, {3.694230831480823*^9, 3.6942308316782*^9}, {
   3.694436395397346*^9, 3.694436397516592*^9}, {3.820626181739964*^9, 
   3.820626190503669*^9}, {3.820626805105732*^9, 3.820626809905645*^9}, {
   3.820629600395542*^9, 3.820629605829145*^9}, {3.821223411247621*^9, 
   3.821223573491192*^9}, {3.821223636858522*^9, 3.821223657288546*^9}, {
   3.821223806509273*^9, 3.821223852160828*^9}, {3.8212260550388613`*^9, 
   3.821226056398467*^9}, {3.821226290255107*^9, 3.821226344429927*^9}, {
   3.821226387985219*^9, 3.821226389205044*^9}, {3.821281161237898*^9, 
   3.821281164869025*^9}, {3.821291215912805*^9, 3.821291218412695*^9}, 
   3.821665287174398*^9, 3.821665426323245*^9, 3.821666104799966*^9, {
   3.8216662370216312`*^9, 3.821666246799837*^9}, 3.8216663500267344`*^9, {
   3.821666381408066*^9, 3.821666381463311*^9}, {3.821666594680539*^9, 
   3.821666594756166*^9}, {3.821666644123558*^9, 3.8216666530199633`*^9}, {
   3.821847118447137*^9, 3.821847141967408*^9}, {3.821847585594366*^9, 
   3.82184758857868*^9}, {3.821895588662778*^9, 3.821895588782481*^9}, {
   3.821895622762439*^9, 3.8218956416131783`*^9}, {3.8218970252772408`*^9, 
   3.821897032980707*^9}, {3.8218975785549383`*^9, 3.821897580290984*^9}, {
   3.8218977125974216`*^9, 3.821897713195538*^9}, 3.8549376629101458`*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"36f4fbed-1f99-43d3-9d95-7a73551c8631"],

Cell["\<\
Again, we have interesting geometrical effects influenced by density and \
diffusion parameters.  Note our choice only to include diffusion through \
water; we did not include P+R \[RightArrow] R+P, S+P \[RightArrow] P+S, R+S \
\[RightArrow] S+R, in other words we are assuming a condition where these \
molecules are not as free to move through each other as they are free to move \
through water.  What consequences might this have?\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.8216657449086657`*^9, 3.821665828061088*^9}, {
  3.821665914682643*^9, 3.821665916211339*^9}, {3.821665991553988*^9, 
  3.821666072932983*^9}, {3.82166680277216*^9, 3.821666946142874*^9}, {
  3.821669015704273*^9, 3.821669034167116*^9}, {3.821849230705737*^9, 
  3.8218493647966003`*^9}, {3.821849397335146*^9, 3.821849498133019*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"50d0ea73-53e4-4b5f-b386-a970338f7f87"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"RPSstate", ",", 
      RowBox[{"ColorRules", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", "\[Rule]", "Blue"}], ",", 
         RowBox[{"P", "\[Rule]", "Orange"}], ",", 
         RowBox[{"S", "\[Rule]", "Green"}], ",", 
         RowBox[{"W", "\[Rule]", 
          RowBox[{"GrayLevel", "[", "0.9", "]"}]}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", "RPStime"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "RPShistory", "]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "Orange", ",", "Green", ",", 
         RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}], ",", "Bottom"}],
         "]"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<iterations\>\"", ",", "\"\<counts\>\""}], "}"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
   3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821666402739387*^9, 
   3.8216664361548443`*^9}, {3.821847159700281*^9, 3.821847173989032*^9}, {
   3.8218557100028763`*^9, 3.821855751741219*^9}, 3.821855792356524*^9, {
   3.8218559241964493`*^9, 3.8218559276879263`*^9}, {3.8218559866120996`*^9, 
   3.8218560397531757`*^9}, {3.821883127575139*^9, 3.8218831340419083`*^9}, {
   3.821883203231083*^9, 3.821883210963731*^9}, {3.821894833691724*^9, 
   3.8218948453692636`*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"2b9a83b6-1483-4fcc-b31d-0552cd6f977a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RPStime", "=", "0"}], ";", 
  RowBox[{"RPShistory", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "RPSstate", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RPSstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{
       RowBox[{"RPS", "/.", 
        RowBox[{"{", 
         RowBox[{"kd", "\[Rule]", "10"}], "}"}]}], ",", "RPSstate", ",", 
       ".1"}], "]"}]}], ";", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"RPShistory", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "RPSstate", "]"}], ",", "#"}], "]"}], "&"}],
        "/@", 
       RowBox[{"{", 
        RowBox[{"R", ",", "P", ",", "S", ",", "W"}], "}"}]}]}], "]"}], ";", 
    RowBox[{"RPStime", "+=", "0.1"}]}], ",", "1000"}], "]"}]}], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.82166644256629*^9, 
   3.821666452132885*^9}, 3.821666515815844*^9, {3.82166839068404*^9, 
   3.82166842602209*^9}, {3.821847178235992*^9, 3.821847189020856*^9}, {
   3.821847650881916*^9, 3.821847678627214*^9}, 3.821847903273849*^9, {
   3.821848012199296*^9, 3.821848012650454*^9}, {3.821848608605753*^9, 
   3.821848608876388*^9}, {3.821855776849679*^9, 3.821855787763978*^9}, {
   3.821855820331203*^9, 3.821855917955414*^9}, 3.821855975565772*^9, {
   3.821883253710037*^9, 3.8218832537610807`*^9}, 3.82188666698765*^9, 
   3.821886921149913*^9, 3.821894905177718*^9},
 CellLabel->
  "In[430]:=",ExpressionUUID->"dd5046b9-ab90-405c-a201-d007a1346c74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{
     RowBox[{"RPS", "/.", 
      RowBox[{"{", 
       RowBox[{"kd", "\[Rule]", "10"}], "}"}]}], ",", "RPSstate", ",", 
     "0.1"}], "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.8214941208359423`*^9, 3.821494148838941*^9}, {
  3.821495511260285*^9, 3.821495512708765*^9}, {3.8216687602638893`*^9, 
  3.821668771193119*^9}, {3.821847192780324*^9, 3.821847195763915*^9}, {
  3.821847659364608*^9, 3.8218476756481733`*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"b0bced9f-0b91-49c5-a626-6f867b4c7fb6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.850201`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.821494127056902*^9, 3.821494150318115*^9}, 
   3.821495513904023*^9, {3.821668792410816*^9, 3.82166879517176*^9}, 
   3.821668841670136*^9, 3.821847199510709*^9, {3.821847664377255*^9, 
   3.821847676473131*^9}, {3.854938113370255*^9, 3.8549381244353237`*^9}, 
   3.855016183672155*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"2f1d4369-aedc-40b6-a87c-bb581a64f2a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Turing machines with surface CRNs", "Section",
 CellChangeTimes->{{3.821763440397541*^9, 
  3.8217634516429453`*^9}},ExpressionUUID->"f0e83a7d-9a21-4312-948c-\
f0753961b9bd"],

Cell["\<\
To investigate Turing machines on surfaces, we\[CloseCurlyQuote]ll first let\
\[CloseCurlyQuote]s grab some code from ModelsOfComputation.nb.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"a18d75b4-5ad9-4cc6-9b73-9c315240e95b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneStepTM", "[", 
   RowBox[{"rules_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"lefttape___", ",", 
      RowBox[{"{", 
       RowBox[{"head_", ",", "symbol_"}], "}"}], ",", "righttape___"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"action", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"head", ",", "symbol"}], "}"}], "/.", "rules"}]}], ",", 
      "newhead", ",", "newsymbol", ",", "direction"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "action", "]"}], "\[Equal]", "3"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newhead", ",", "newsymbol", ",", "direction"}], "}"}], "=", 
        "action"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"direction", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"{", "lefttape", "}"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"newhead", ",", "0"}], "}"}], ",", "newsymbol", ",", 
             "righttape"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"{", "lefttape", "}"}], ",", 
              RowBox[{"-", "1"}]}], "]"}], "~", "Join", "~", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"newhead", ",", 
                RowBox[{"Last", "[", 
                 RowBox[{"{", "lefttape", "}"}], "]"}]}], "}"}], ",", 
              "newsymbol", ",", "righttape"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"else", " ", "direction"}], " ", "\[Equal]", " ", 
           RowBox[{"+", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"{", "righttape", "}"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"lefttape", ",", "newsymbol", ",", 
             RowBox[{"{", 
              RowBox[{"newhead", ",", "0"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lefttape", ",", "newsymbol", ",", 
              RowBox[{"{", 
               RowBox[{"newhead", ",", 
                RowBox[{"First", "[", 
                 RowBox[{"{", "righttape", "}"}], "]"}]}], "}"}]}], "}"}], 
            "~", "Join", "~", 
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{"{", "righttape", "}"}], ",", "1"}], "]"}]}]}], "]"}]}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"else", " ", "no", " ", "rule", " ", "applies"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"lefttape", ",", 
        RowBox[{"{", 
         RowBox[{"head", ",", "symbol"}], "}"}], ",", "righttape"}], "}"}]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81829171661699*^9, 3.8182917180851994`*^9}, {
  3.818292428835403*^9, 3.818292437556432*^9}, {3.818294870876472*^9, 
  3.818294918881916*^9}, {3.818294949113165*^9, 3.818295054847907*^9}, {
  3.818295085786396*^9, 3.818295736712208*^9}, {3.818295861818022*^9, 
  3.818295890564746*^9}, {3.818295946404739*^9, 3.818295954399802*^9}, {
  3.8189993954451437`*^9, 3.8189994125075893`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"a0b92663-28be-46d8-b583-85bee65316ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Turing", " ", "machine", " ", "that", " ", "copies", " ", "the", " ", 
      "bits", " ", "in", " ", "a", " ", "B"}], "-", 
     RowBox[{"terminated", " ", "binary", " ", "string"}]}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "011"}], "B", " ", "becomes", " ", 
     "011011", "B"}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "head", " ", "left", " ", "on", " ", "the", " ", 
     "first", " ", "bit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", "q6", ",", "q7", 
      ",", "q8", ",", "halt", ",", "B", ",", "c0", ",", "c1", ",", "n0", ",", 
      "n1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"copyTM", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"memorize", " ", "the", " ", "next", " ", "bit"}], ",", " ", 
        RowBox[{
        "marking", " ", "it", " ", "as", " ", "being", " ", "copied"}], ",", 
        " ", 
        RowBox[{
        "and", " ", "start", " ", "moving", " ", "to", " ", "the", " ", 
         "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "c0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "c1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"pass", " ", "through", " ", "old", " ", "and", " ", "new"}],
          ",", " ", 
         RowBox[{"deposit", " ", "new", " ", "0"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q2", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q2", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q2", ",", "n0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "n0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q2", ",", "n1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "n1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q2", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q4", ",", "n0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"pass", " ", "through", " ", "old", " ", "and", " ", "new"}],
          ",", " ", 
         RowBox[{"deposit", " ", "new", " ", "1"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q3", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q3", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q3", ",", "n0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "n0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q3", ",", "n1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "n1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q3", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q4", ",", "n1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"write", " ", "end"}], "-", "of", "-", 
         RowBox[{
         "string", " ", "marker", " ", "and", " ", "initiate", " ", "return", 
          " ", "run"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q4", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q5", ",", "B", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "move", " ", "left", " ", "through", " ", "new", " ", "bits"}], ";",
           " ", 
          RowBox[{
          "either", " ", "enter", " ", "some", " ", "remaining", " ", "old", 
           " ", "bits", " ", "yet", " ", "to", " ", "be", " ", "copied"}]}], 
         ",", " ", 
         RowBox[{
         "or", " ", "first", " ", "hit", " ", "copied", " ", "bits", " ", 
          "in", " ", "which", " ", "case", " ", 
          RowBox[{"we", "'"}], "re", " ", "done", " ", "copying"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "n0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q5", ",", "n0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "n1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q5", ",", "n1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q6", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q6", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "c0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "c0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q5", ",", "c1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "c1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "move", " ", "to", " ", "the", " ", "leftmost", " ", "old", " ", 
          "bit", " ", "that", " ", 
          RowBox[{"hasn", "'"}], "t", " ", "yet", " ", "been", " ", 
          "copied"}], ",", " ", 
         RowBox[{"then", " ", "go", " ", "to", " ", "step", " ", "1"}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q6", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q6", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q6", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q6", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q6", ",", "c0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "c0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q6", ",", "c1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "c1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "clear", " ", "the", " ", "tags", " ", "on", " ", "the", " ", "new", 
          " ", "bits"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "they", " ", "are", " ", "just", " ", "0", 
          "s", " ", "and", " ", "1", "s"}], ",", " ", 
         RowBox[{
         "then", " ", "return", " ", "left", " ", "to", " ", "reach", " ", 
          "the", " ", "copied", " ", "bits"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "n0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "n1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "1", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "B"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "B", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q7", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "c0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q8", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q7", ",", "c1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q8", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "clear", " ", "the", " ", "tags", " ", "on", " ", "the", " ", 
          "copied", " ", "bits"}], ",", " ", 
         RowBox[{
         "and", " ", "halt", " ", "upon", " ", "reaching", " ", "the", " ", 
          "background", " ", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q8", ",", "c0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q8", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q8", ",", "c1"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"q8", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q8", ",", "0"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"halt", ",", "0", ",", 
          RowBox[{"+", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.818291819846519*^9, 3.8182918430629807`*^9}, {
  3.8182919348343678`*^9, 3.8182922248792133`*^9}, {3.818292320360437*^9, 
  3.818292385893783*^9}, {3.8182925587262993`*^9, 3.818292694694056*^9}, {
  3.818293647446134*^9, 3.818293796263789*^9}, {3.818293887464292*^9, 
  3.8182938904918633`*^9}, {3.818293970662077*^9, 3.818294006564089*^9}, {
  3.818294038263815*^9, 3.818294038678977*^9}, {3.818294071250917*^9, 
  3.818294076580577*^9}, {3.8182941267057047`*^9, 3.8182941388420267`*^9}, {
  3.8182941858883*^9, 3.8182948339984503`*^9}, {3.818564959950145*^9, 
  3.8185650332814302`*^9}, {3.822160683762672*^9, 3.8221606849022217`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"bc324486-1c31-429b-b420-1bfc3e4a470d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FixedPointList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OneStepTM", "[", 
      RowBox[{"copyTM", ",", "#"}], "]"}], "&"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "B"}], 
     "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8215744201681013`*^9, 3.821574422591249*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"c61867a0-cc88-4024-9f28-5b0af47405bc"],

Cell["\<\
Space-bounded Turing machines on surfaces.   This is the construction given \
in class.  The initial state must contain a line (a bent line can also work) \
of length sufficient for the task at hand. \
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.8216633142546663`*^9, 3.8216633762942963`*^9}, {
   3.821663979566128*^9, 3.8216639800274754`*^9}, 3.8216644847870903`*^9},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"86096c63-a512-4b74-9034-8aea0f4e4c07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "M", ",", "T", ",", "R", ",", "L", ",", "BLANK", ",", 
    "SpaceBoundedTM2SurfaceCRN"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpaceBoundedTM2SurfaceCRN", "[", 
   RowBox[{"TM_", ",", "init_", ",", "padding_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "headstates", ",", "tapesymbols", ",", "convert", ",", "tape", ",", 
      "reactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"headstates", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "TM"}], ")"}]}], ",", 
        RowBox[{"First", "/@", 
         RowBox[{"(", 
          RowBox[{"Last", "/@", "TM"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tapesymbols", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "TM"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "TM"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convert", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h_", ",", "s_"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"hp_", ",", "sp_", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], "]"}], ":=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rxno", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}], "+", 
           RowBox[{"T", "[", 
            RowBox[{"spp", ",", "R"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"sp", ",", "L"}], "]"}], "+", 
           RowBox[{"M", "[", 
            RowBox[{"hp", ",", "spp"}], "]"}]}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"spp", ",", "tapesymbols"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convert", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h_", ",", "s_"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"hp_", ",", "sp_", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ":=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"rxno", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"spp", ",", "L"}], "]"}], "+", 
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"hp", ",", "spp"}], "]"}], "+", 
           RowBox[{"T", "[", 
            RowBox[{"sp", ",", "R"}], "]"}]}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"spp", ",", "tapesymbols"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"convert", "/@", "TM"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"d", "=", "L"}], ";", 
        RowBox[{"tape", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "init", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"init", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "===", "List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"tape", ",", 
            RowBox[{"M", "@@", 
             RowBox[{"init", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          RowBox[{"d", "=", "R"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"tape", ",", 
           RowBox[{"T", "[", 
            RowBox[{
             RowBox[{"init", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "d"}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"reactions", ",", 
       RowBox[{"ArrayPad", "[", 
        RowBox[{
         RowBox[{"{", "tape", "}"}], ",", "padding", ",", "BLANK"}], "]"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8215750497558393`*^9, 3.821575070350004*^9}, {
  3.821575107923231*^9, 3.821575276020935*^9}, {3.821575365280504*^9, 
  3.821575365973673*^9}, {3.8215754643792257`*^9, 3.821576095366259*^9}, {
  3.8215763917929573`*^9, 3.821576451715958*^9}, {3.821576907894186*^9, 
  3.821577120760953*^9}, {3.821577159730098*^9, 3.821577168679174*^9}, {
  3.8215775862958*^9, 3.82157772246607*^9}, {3.8215779659549437`*^9, 
  3.821578040006166*^9}, {3.821663390524137*^9, 3.821663490405417*^9}, {
  3.8216635271066027`*^9, 3.8216635287552*^9}, {3.854938152297141*^9, 
  3.854938155423526*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"7ae70e83-ed03-4720-86dc-f78811f18306"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"surfaceSBTM", ",", "SBTMstate"}], "}"}], "=", 
   RowBox[{"SpaceBoundedTM2SurfaceCRN", "[", 
    RowBox[{"copyTM", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "0", ",", 
       "1", ",", "1", ",", "1", ",", "B", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "2"}], 
    "]"}]}], " ", ";", " ", 
  RowBox[{"SBTMtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.8215761585401077`*^9, 3.821576195989876*^9}, {
  3.8215771300445843`*^9, 3.821577131148424*^9}, {3.821578239352008*^9, 
  3.821578242082284*^9}, {3.8216635382018213`*^9, 3.821663585580578*^9}, {
  3.821663788665143*^9, 3.8216638037952957`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"7707dd87-e0f4-44a4-bbae-b4ff3294af91"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"SBTMstate", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"h_", ",", "s_"}], "]"}], "\[Rule]", "Red"}], ",", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"0", ",", "d_"}], "]"}], "\[Rule]", "White"}], ",", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"1", ",", "d_"}], "]"}], "\[Rule]", "Black"}], ",", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"B", ",", "d_"}], "]"}], "\[Rule]", "Green"}], ",", 
       RowBox[{"BLANK", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.9", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "SBTMtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
  3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821576200010029*^9, 
  3.821576280012322*^9}, {3.8215771786390944`*^9, 3.821577189826087*^9}, {
  3.821577758563114*^9, 3.821577803460601*^9}, {3.8215779401962337`*^9, 
  3.82157795995798*^9}, {3.821578146686812*^9, 3.821578148623027*^9}, {
  3.8216635922772207`*^9, 3.82166361214924*^9}, {3.821663691762762*^9, 
  3.821663709099907*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"7be082c4-fedf-423d-accc-dfd196e33a89"],

Cell[BoxData[
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"surfaceSBTM", ",", "SBTMstate"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"SBTMstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"surfaceSBTM", ",", "SBTMstate", ",", "1"}], "]"}]}], ";", 
    RowBox[{"SBTMtime", "++"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821663615268921*^9, 3.821663662653942*^9}, {
   3.821663782379869*^9, 3.821663784547905*^9}, {3.8216704854745493`*^9, 
   3.821670529899147*^9}, {3.8218536758343267`*^9, 3.821853676205825*^9}, {
   3.822160699280971*^9, 3.822160724409618*^9}, {3.822160973495553*^9, 
   3.822160974472838*^9}, {3.822161005734478*^9, 3.8221610058619432`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"dc5d1c6b-fd71-47d6-90f7-7c31149da9a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "just", " ", "point", " ", "out", " ", 
     "that", " ", "this", " ", "surface", " ", "CRN", " ", "can", " ", "run", 
     " ", "multiple", " ", "TMs", " ", "simultaneous"}], ",", " ", 
    RowBox[{
    "and", " ", "their", " ", "tapes", " ", "can", " ", "be", " ", "bent"}]}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"surfaceSBTM", ",", "SBTMstate1"}], "}"}], "=", 
     RowBox[{"SpaceBoundedTM2SurfaceCRN", "[", 
      RowBox[{"copyTM", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "0", ",", 
         "1", ",", "1", ",", "1", ",", "B", ",", "0", ",", "0", ",", "0", ",",
          "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "2"}], 
      "]"}]}], " ", ";", " ", 
    RowBox[{"SBTMtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SBTMstate", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"BLANK", ",", "27", ",", "27"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"23", ";;", "27"}], ",", 
        RowBox[{"1", ";;", "22"}]}], "]"}], "]"}], "=", "SBTMstate1"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "22"}], ",", 
        RowBox[{"1", ";;", "5"}]}], "]"}], "]"}], "=", 
     RowBox[{"Transpose", "[", "SBTMstate1", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "5"}], ",", 
        RowBox[{"6", ";;", "27"}]}], "]"}], "]"}], "=", 
     RowBox[{"Reverse", "/@", "SBTMstate1"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"6", ";;", "27"}], ",", 
        RowBox[{"23", ";;", "27"}]}], "]"}], "]"}], "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Transpose", "[", "SBTMstate1", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"16", ";;", "11", ";;", 
         RowBox[{"-", "1"}]}], ",", "11"}], "]"}], "]"}], "=", 
     RowBox[{"SBTMstate1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"3", ";;", "8"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{"11", ",", 
        RowBox[{"12", ";;", "17"}]}], "]"}], "]"}], "=", 
     RowBox[{"SBTMstate1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"9", ";;", "14"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SBTMstate", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"12", ";;", "17"}], ",", "17"}], "]"}], "]"}], "=", 
     RowBox[{"SBTMstate1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", 
        RowBox[{"15", ";;", "20"}]}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.821852778053237*^9, 3.821852781349206*^9}, {
  3.821853135455366*^9, 3.8218535756916018`*^9}, {3.821853625382056*^9, 
  3.821853634070478*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"46bc1e54-d20e-4008-8885-312a551d8e49"],

Cell[TextData[{
 "Quick numeric check: old-fashioned simulation of the Turing machine agrees \
with the count of the number of surface CRN reaction events?  Yes!  \
Old-fashioned gives 144 states, including first and a repetition of the last \
one (which is how FixedPointList confirms that it\[CloseCurlyQuote]s done).  \
Thus 142 actual reaction events for the surface CRN to bring the initial \
state to the final state.  At which point ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", "1000"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "651e4098-299a-4449-aab9-53082c13192c"],
 " and the halted check says True."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.8216633142546663`*^9, 3.8216633762942963`*^9}, {
  3.821663979566128*^9, 3.8216639800274754`*^9}, {3.821664142890716*^9, 
  3.8216642192967978`*^9}, {3.8216642523593683`*^9, 3.82166426864429*^9}, {
  3.855078583854494*^9, 3.8550787441832447`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"eebe59cc-7c5f-47b3-885c-2795a0002758"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"FixedPointList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OneStepTM", "[", 
      RowBox[{"copyTM", ",", "#"}], "]"}], "&"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "0", ",", 
      "1", ",", "1", ",", "1", ",", "B", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.855078207509972*^9, 3.855078212035095*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"a59a8c64-073b-4b43-af84-50500b8eabee"],

Cell[BoxData["144"], "Output",
 CellChangeTimes->{3.855078213355093*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"90428530-21c8-4639-8ddd-be0f83f089ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"First", "@", 
  RowBox[{"InfoRunSurfaceCRN", "[", 
   RowBox[{"surfaceSBTM", ",", "SBTMstate", ",", "1000"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.855078241325644*^9, 3.855078254729507*^9}},
 CellLabel->
  "In[534]:=",ExpressionUUID->"39dc9aab-207c-4648-91fc-fd3fb77aa970"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1000", ",", "142", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{3.855078271044568*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"0eebd172-4230-4bc8-a583-349ca851fe3f"]
}, Open  ]],

Cell["\<\
Now we\[CloseCurlyQuote]ll improve the surface CRN construction for TMs so \
that it expands the tape as necessary, so that preparing the initial state \
does not require knowing how long the Turing machine will run (though it does \
still require that the surface is large enough).  This requires building some \
walls on the sides to make sure the extension is straight.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.8216633142546663`*^9, 3.8216633762942963`*^9}, {
  3.821663979566128*^9, 3.8216639800274754`*^9}, {3.821664142890716*^9, 
  3.8216642192967978`*^9}, {3.8216642523593683`*^9, 3.82166426864429*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"2c480272-540f-4306-be9d-f80d6e5860fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "M", ",", "T", ",", "R", ",", "L", ",", "S", ",", "BLANK", ",", 
    "TM2SurfaceCRN"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TM2SurfaceCRN", "[", 
   RowBox[{"TM_", ",", "init_", ",", "padding_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "headstates", ",", "tapesymbols", ",", "convert", ",", "tape", ",", 
      "reactions"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"headstates", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "TM"}], ")"}]}], ",", 
        RowBox[{"First", "/@", 
         RowBox[{"(", 
          RowBox[{"Last", "/@", "TM"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tapesymbols", "=", 
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "TM"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "TM"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convert", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h_", ",", "s_"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"hp_", ",", "sp_", ",", 
          RowBox[{"+", "1"}]}], "}"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"h", ",", "s"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"spp", ",", "R"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"sp", ",", "L"}], "]"}], "+", 
            RowBox[{"M", "[", 
             RowBox[{"hp", ",", "spp"}], "]"}]}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"spp", ",", "tapesymbols"}], "}"}]}], "]"}], "~", "Join", 
       "~", 
       RowBox[{"{", 
        RowBox[{"rxno", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}], "+", "R"}], ",", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}], "+", 
           RowBox[{"R", "[", "1", "]"}]}], ",", "1"}], "]"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convert", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"h_", ",", "s_"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"hp_", ",", "sp_", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"spp", ",", "L"}], "]"}], "+", 
            RowBox[{"M", "[", 
             RowBox[{"h", ",", "s"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"hp", ",", "spp"}], "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"sp", ",", "R"}], "]"}]}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"spp", ",", "tapesymbols"}], "}"}]}], "]"}], "~", "Join", 
       "~", 
       RowBox[{"{", 
        RowBox[{"rxno", "[", 
         RowBox[{
          RowBox[{"L", "+", 
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"L", "[", "1", "]"}], "+", 
           RowBox[{"M", "[", 
            RowBox[{"h", ",", "s"}], "]"}]}], ",", "1"}], "]"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"reactions", "=", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"convert", "/@", "TM"}], "]"}], "~", "Join", "~", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{"S", "+", "BLANK"}], ",", 
           RowBox[{"S", "+", 
            RowBox[{"S", "[", "1", "]"}]}], ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{"BLANK", "+", 
            RowBox[{"L", "[", "1", "]"}]}], ",", 
           RowBox[{
            RowBox[{"L", "[", "2", "]"}], "+", 
            RowBox[{"T", "[", 
             RowBox[{"0", ",", "L"}], "]"}]}], ",", "1"}], "]"}], ",", 
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L", "[", "2", "]"}], "+", 
            RowBox[{"S", "[", "1", "]"}]}], ",", 
           RowBox[{
            RowBox[{"L", "[", "3", "]"}], "+", "S"}], ",", "1"}], "]"}], ",", 
         
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L", "[", "3", "]"}], "+", 
            RowBox[{"S", "[", "1", "]"}]}], ",", 
           RowBox[{"L", "+", "S"}], ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "1", "]"}], "+", "BLANK"}], ",", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"0", ",", "R"}], "]"}], "+", 
            RowBox[{"R", "[", "2", "]"}]}], ",", "1"}], "]"}], ",", 
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "2", "]"}], "+", 
            RowBox[{"S", "[", "1", "]"}]}], ",", 
           RowBox[{
            RowBox[{"R", "[", "3", "]"}], "+", "S"}], ",", "1"}], "]"}], ",", 
         
         RowBox[{"rxno", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "3", "]"}], "+", 
            RowBox[{"S", "[", "1", "]"}]}], ",", 
           RowBox[{"R", "+", "S"}], ",", "1"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"d", "=", "L"}], ";", 
        RowBox[{"tape", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "init", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"init", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "===", "List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"tape", ",", 
            RowBox[{"M", "@@", 
             RowBox[{"init", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
          RowBox[{"d", "=", "R"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"tape", ",", 
           RowBox[{"T", "[", 
            RowBox[{
             RowBox[{"init", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "d"}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"reactions", ",", 
       RowBox[{"ArrayPad", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"S", ",", 
             RowBox[{
              RowBox[{"Length", "[", "tape", "]"}], "+", "2"}]}], "]"}], ",", 
           
           RowBox[{
            RowBox[{"{", "L", "}"}], "~", "Join", "~", "tape", "~", "Join", 
            "~", 
            RowBox[{"{", "R", "}"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{"S", ",", 
             RowBox[{
              RowBox[{"Length", "[", "tape", "]"}], "+", "2"}]}], "]"}]}], 
          "}"}], ",", "padding", ",", "BLANK"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8215750497558393`*^9, 3.821575070350004*^9}, {
  3.821575107923231*^9, 3.821575276020935*^9}, {3.821575365280504*^9, 
  3.821575365973673*^9}, {3.8215754643792257`*^9, 3.821576095366259*^9}, {
  3.8215763917929573`*^9, 3.821576451715958*^9}, {3.821576907894186*^9, 
  3.821577120760953*^9}, {3.821577159730098*^9, 3.821577168679174*^9}, {
  3.8215775862958*^9, 3.82157772246607*^9}, {3.8215779659549437`*^9, 
  3.821578040006166*^9}, {3.854938205898116*^9, 3.8549382336217623`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"bacfd145-288d-4f5f-8407-2cbb060a289a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"surfaceTM", ",", "TMstate"}], "}"}], "=", 
   RowBox[{"TM2SurfaceCRN", "[", 
    RowBox[{"copyTM", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "0", ",", 
       "1", ",", "1", ",", "1", ",", "B"}], "}"}], ",", "10"}], "]"}]}], ";", 
  
  RowBox[{"TMtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.8215761585401077`*^9, 3.821576195989876*^9}, {
  3.8215771300445843`*^9, 3.821577131148424*^9}, {3.821578239352008*^9, 
  3.821578242082284*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"b633a5de-cf24-44d0-ac17-f805bc219527"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"TMstate", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"h_", ",", "s_"}], "]"}], "\[Rule]", "Red"}], ",", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"0", ",", "d_"}], "]"}], "\[Rule]", "White"}], ",", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"1", ",", "d_"}], "]"}], "\[Rule]", "Black"}], ",", 
       RowBox[{"BLANK", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
       RowBox[{"L", "\[Rule]", "Pink"}], ",", 
       RowBox[{"R", "\[Rule]", "Pink"}], ",", 
       RowBox[{
        RowBox[{"L", "[", "v_", "]"}], "\[Rule]", "Green"}], ",", 
       RowBox[{
        RowBox[{"R", "[", "v_", "]"}], "\[Rule]", "Green"}], ",", 
       RowBox[{"S", "\[Rule]", "Blue"}], ",", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "\[Rule]", "Cyan"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "TMtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
  3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821576200010029*^9, 
  3.821576280012322*^9}, {3.8215771786390944`*^9, 3.821577189826087*^9}, {
  3.821577758563114*^9, 3.821577803460601*^9}, {3.8215779401962337`*^9, 
  3.82157795995798*^9}, {3.821578146686812*^9, 3.821578148623027*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"6d021f92-88be-456c-be20-bc62043fec61"],

Cell[BoxData[
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"surfaceTM", ",", "TMstate"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"TMstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"surfaceTM", ",", "TMstate", ",", "1"}], "]"}]}], ";", 
    RowBox[{"TMtime", "++"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821663615268921*^9, 3.821663662653942*^9}, {
   3.821663782379869*^9, 3.821663784547905*^9}, {3.8216704854745493`*^9, 
   3.821670529899147*^9}, {3.8218536758343267`*^9, 3.821853676205825*^9}, {
   3.822160699280971*^9, 3.822160724409618*^9}, {3.822160973495553*^9, 
   3.822160974472838*^9}, {3.822161005734478*^9, 3.8221610058619432`*^9}, {
   3.82216111497225*^9, 3.822161125367206*^9}},
 CellLabel->
  "In[461]:=",ExpressionUUID->"3963507e-42c0-460b-b52c-5736e3cbbb3f"],

Cell["\<\
A Turing machine (or other algorithmic system) could be used as the core for \
controlling a developmental process that grows a \
\[OpenCurlyDoubleQuote]useful\[CloseCurlyDoubleQuote] structure.  The key \
idea here is that small algorithms can \[OpenCurlyDoubleQuote]draw\
\[CloseCurlyDoubleQuote] large images.  The \[OpenCurlyDoubleQuote]Busy \
Beaver\[CloseCurlyDoubleQuote] problem of theoretical computer science asks \
\[OpenCurlyDoubleQuote]What is the greatest number of non-0s that a \
n-head-state, m-tape-symbol can produce before halting, starting on a tape of \
all 0s?\[CloseCurlyDoubleQuote]  The general answer is remarkable -- this \
number grows fast!  Here we will just use a 2-symbol, 4-state Turing machine \
that draws a line of length 14 (the 5-state one creates too large of an \
output).   To make it more fun, we also modify the construction such that it \
grows wiggly \[OpenCurlyDoubleQuote]legs\[CloseCurlyDoubleQuote] or \
\[OpenCurlyDoubleQuote]eyes\[CloseCurlyDoubleQuote] whenever state qA reads a \
1.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.821580796937667*^9, 
  3.821581023730962*^9}, {3.82158924422762*^9, 3.821589259689931*^9}, {
  3.821589317335803*^9, 3.821589415765168*^9}, {3.821627728088903*^9, 
  3.821627729419635*^9}, {3.821649200159759*^9, 3.821649208684926*^9}, {
  3.821853868259132*^9, 3.82185387574399*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"643d850e-8509-4f32-a31d-47d73fbfd251"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"qA", ",", "qB", ",", "qC", ",", "qD", ",", "halt"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB4", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qA", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qB", ",", "1", ",", 
        RowBox[{"+", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qA", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qB", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qB", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qA", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qB", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qC", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qC", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"halt", ",", "1", ",", 
        RowBox[{"+", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qC", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qD", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qD", ",", "0"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qD", ",", "1", ",", 
        RowBox[{"+", "1"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qD", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"qA", ",", "0", ",", 
        RowBox[{"+", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.821581623066483*^9, 3.821581799238258*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"f4fd18e4-b528-4c16-8471-70c6a45317cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FixedPointList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OneStepTM", "[", 
      RowBox[{"BB4", ",", "#"}], "]"}], "&"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"qA", ",", "0"}], "}"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8215744201681013`*^9, 3.821574422591249*^9}, {
  3.821581812770562*^9, 3.821581822687018*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"5eeb37c2-4092-465c-96b3-ef1735fd46c0"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "GROW", ",", "GROWING", ",", "GROWN", ",", "GROWTH1", ",", "GROWTH2", ",", 
   "G", ",", "EYE", ",", "LEG"}], "]"}]], "Input",
 CellChangeTimes->{{3.821627817173272*^9, 3.821627842562209*^9}, {
   3.821651158740567*^9, 3.821651166177917*^9}, 
   3.821651211853825*^9},ExpressionUUID->"8ee29ba9-2520-4649-968a-\
9be36ba547d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"critter", ",", "critterstate"}], "}"}], "=", 
   RowBox[{"TM2SurfaceCRN", "[", 
    RowBox[{"BB4", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"qA", ",", "0"}], "}"}], "}"}], ",", "20"}], "]"}]}], ";", 
  RowBox[{"crittertime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"critter", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"critter", "/.", 
       RowBox[{"{", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "hook", " ", "in", " ", "grow", " ", "subroutine", " ", "whenever", 
          " ", "TM", " ", "initiates", " ", "qA"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rxnl", "[", 
          RowBox[{
           RowBox[{"react_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"List", "@@", "#"}], ",", 
                 RowBox[{"M", "[", 
                  RowBox[{"qA", ",", "1"}], "]"}]}], "]"}]}], "&"}], ")"}]}], 
           ",", "prod_", ",", "k_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rxnl", "[", 
            RowBox[{"react", ",", "prod", ",", "k"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"M", "[", 
              RowBox[{"qA", ",", "1"}], "]"}], "\[Rule]", "GROW"}], "}"}]}], 
          ")"}]}], " ", "\[IndentingNewLine]", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"remember", ",", " ", 
          RowBox[{
          "rxno", " ", "is", " ", "HoldAll", " ", "and", " ", "compiles", " ",
            "to", " ", "rxnl"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "}"}]}], ")"}], "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROW", "+", "S"}], ",", 
         RowBox[{"GROWING", "+", "GROWTH1"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROWING", "+", "S"}], ",", 
         RowBox[{"GROWN", "+", "GROWTH2"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROW", "+", "GROWTH2"}], ",", 
         RowBox[{"GROWN", "+", "GROWTH2"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{"GROWN", ",", 
         RowBox[{"M", "[", 
          RowBox[{"qA", ",", "1"}], "]"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROWTH1", "+", 
          RowBox[{"S", "[", "1", "]"}]}], ",", 
         RowBox[{"GROWTH1", "+", "G"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROWTH1", "+", "BLANK"}], ",", 
         RowBox[{"GROWTH1", "+", "G"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROWTH2", "+", 
          RowBox[{"S", "[", "1", "]"}]}], ",", 
         RowBox[{"GROWTH2", "+", "G"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"GROWTH2", "+", "BLANK"}], ",", 
         RowBox[{"GROWTH2", "+", "G"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"G", "+", "G"}], ",", 
         RowBox[{"EYE", "+", "EYE"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"G", "+", "EYE"}], ",", 
         RowBox[{"EYE", "+", "EYE"}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"EYE", "+", 
          RowBox[{"S", "[", "1", "]"}]}], ",", 
         RowBox[{"EYE", "+", 
          RowBox[{"S", "[", "2", "]"}]}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"EYE", "+", 
          RowBox[{"S", "[", "2", "]"}]}], ",", 
         RowBox[{"EYE", "+", 
          RowBox[{"S", "[", "1", "]"}]}], ",", "1"}], "]"}], ",", 
       RowBox[{"rxno", "[", 
        RowBox[{
         RowBox[{"EYE", "+", "BLANK"}], ",", 
         RowBox[{"EYE", "+", 
          RowBox[{"EYE", "[", "1", "]"}]}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "+", "G"}], ",", 
             RowBox[{
              RowBox[{"S", "[", "]"}], "+", 
              RowBox[{"LEG", "[", "i", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LEG", "[", "i", "]"}], "+", 
              RowBox[{"S", "[", "1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", "7"}], "]"}], "+", 
              RowBox[{"S", "[", 
               RowBox[{"i", "+", "2"}], "]"}]}], ",", "1"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "+", "BLANK"}], ",", 
             RowBox[{
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", 
                RowBox[{"-", "n"}]}], "]"}], "+", 
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", "n"}], "]"}]}], ",", "1.1"}], "]"}], ",", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", 
                RowBox[{"-", "n"}]}], "]"}], "+", 
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", "n"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"LEG", "[", 
               RowBox[{"i", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}], "+", "BLANK"}], ",", 
             "0.9"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.821590747396243*^9, 3.821590799800099*^9}, {
   3.82159084876859*^9, 3.821590852512961*^9}, 3.821590906769497*^9, {
   3.821590943832314*^9, 3.821591171681613*^9}, {3.821591416511785*^9, 
   3.821591437992242*^9}, {3.8215916843176928`*^9, 3.8215917639905233`*^9}, {
   3.821592060173483*^9, 3.8215920869433727`*^9}, {3.8215921495195217`*^9, 
   3.8215921960288258`*^9}, {3.8215923025978117`*^9, 3.821592320442663*^9}, {
   3.821592394896409*^9, 3.821592397290495*^9}, {3.821592439221545*^9, 
   3.821592458008726*^9}, {3.821627452265758*^9, 3.82162748102558*^9}, {
   3.821627550564824*^9, 3.821627551294429*^9}, {3.821627783929385*^9, 
   3.821627812132997*^9}, 3.821627853584695*^9, {3.821627987476313*^9, 
   3.821628018877619*^9}, {3.82162806773597*^9, 3.821628077464609*^9}, {
   3.821628214943172*^9, 3.821628217482572*^9}, {3.8216282500007677`*^9, 
   3.821628350590124*^9}, {3.8216287362330017`*^9, 3.8216287365847197`*^9}, {
   3.821628809743743*^9, 3.8216288124840317`*^9}, {3.821629271971739*^9, 
   3.821629411477231*^9}, {3.8216294445488443`*^9, 3.8216294769216843`*^9}, {
   3.821629528031687*^9, 3.821629558408149*^9}, {3.821629599034431*^9, 
   3.821629635237424*^9}, {3.821629901631328*^9, 3.821629907372806*^9}, {
   3.821629967545779*^9, 3.821630007050021*^9}, {3.8216356161853647`*^9, 
   3.8216356549903593`*^9}, {3.8216356851950207`*^9, 3.821635811881338*^9}, {
   3.8216479368396387`*^9, 3.8216479640299273`*^9}, {3.821648086726204*^9, 
   3.821648091205459*^9}, {3.8216481397191067`*^9, 3.821648143642918*^9}, {
   3.821648261810617*^9, 3.821648372964254*^9}, {3.821648408400064*^9, 
   3.821648463606394*^9}, {3.821648517663103*^9, 3.8216485208056*^9}, {
   3.821648595784761*^9, 3.821648601145935*^9}, {3.821648777036392*^9, 
   3.821648781643075*^9}, {3.821648821762113*^9, 3.821648838204294*^9}, {
   3.821648874781432*^9, 3.821648875131308*^9}, {3.821651177945702*^9, 
   3.821651179943266*^9}, {3.854938291555347*^9, 3.854938336619536*^9}, {
   3.8549386829501133`*^9, 3.854938752665422*^9}, 3.8549387953326*^9, {
   3.854938860896575*^9, 3.8549388611973667`*^9}, {3.854970515425394*^9, 
   3.854970526120184*^9}, {3.854971240986926*^9, 3.854971377638938*^9}, {
   3.854971887273188*^9, 3.854971927765813*^9}, {3.854972020738801*^9, 
   3.854972042735778*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"a874e70a-a4b6-477b-ade7-1dc527d38f20"],

Cell[BoxData["critter"], "Input",
 CellChangeTimes->{{3.821591239027872*^9, 3.821591239902574*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"0aa1b8e7-b063-453f-94eb-fdbc36bde8ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"critterrules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"h_", ",", "s_"}], "]"}], "\[Rule]", "Red"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"0", ",", "d_"}], "]"}], "\[Rule]", "White"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"1", ",", "d_"}], "]"}], "\[Rule]", "Black"}], ",", 
     RowBox[{"BLANK", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
     RowBox[{"L", "\[Rule]", "Pink"}], ",", 
     RowBox[{"R", "\[Rule]", "Pink"}], ",", 
     RowBox[{
      RowBox[{"L", "[", "v_", "]"}], "\[Rule]", "Green"}], ",", 
     RowBox[{
      RowBox[{"R", "[", "v_", "]"}], "\[Rule]", "Green"}], ",", 
     RowBox[{"S", "\[Rule]", "Blue"}], ",", 
     RowBox[{
      RowBox[{"S", "[", "___", "]"}], "\[Rule]", "Cyan"}], ",", 
     RowBox[{"G", "\[Rule]", "Yellow"}], ",", 
     RowBox[{"EYE", "\[Rule]", "Magenta"}], ",", 
     RowBox[{
      RowBox[{"EYE", "[", "1", "]"}], "\[Rule]", "Green"}], ",", 
     RowBox[{
      RowBox[{"LEG", "[", 
       RowBox[{"_", ",", "n_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"RGBColor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "n", "]"}], "/", "7"}], ",", "0", ",", "0"}], 
       "]"}]}], ",", 
     RowBox[{
      RowBox[{"LEG", "[", "___", "]"}], "\[Rule]", "Red"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.855098672373364*^9, 3.8550986765981197`*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"87f37337-0e22-4d47-ad28-ebecaa768d8f"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"critterstate", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", "critterrules"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "crittertime"}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQPX2XbNarijeOO9WnZ4NomZcRHSD6Ut1+MK0RxMAo
UvnG8WMKAzeILisOqQbRfvm7akA0B+ulwyDabm/eSRDd4952C0QfW/7vDoiO
/RX6BURfez8ZTK/f3NYsBaQjMle1gugOH/Ur0kA6xfPLNRCtflbCXxdIh3TL
gulVlsZlINrI+1oliP4hKamgB6SnsSwC030y63VB9Iey42B6yjkTExCtKVJg
CqJ7412tQbTLzD4wzXzwg6whkP7XyysHopX8JlSZA2mZ2FXVIFrstXUviPZ6
lzYZREd9V1gEojUuqoDpDfKW8yyA9NPuEDBtkKqRzrLzjaPJjSgwDQCq/53a

  "],
 CellLabel->
  "In[265]:=",ExpressionUUID->"fdb48e87-aaab-4768-83f8-b09b8061129a"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"critterstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"critter", ",", "critterstate", ",", "1"}], "]"}]}], ";", 
    RowBox[{"crittertime", "++"}]}], ",", "500"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"d2268610-f259-4046-87b0-eb90d582cdd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["What is \[OpenCurlyDoubleQuote]typical\[CloseCurlyDoubleQuote] surface \
CRN behavior?", "Section",
 CellChangeTimes->{{3.821763440397541*^9, 3.8217634516429453`*^9}, {
  3.82176379466002*^9, 3.821763800413533*^9}, {3.854974839499693*^9, 
  3.8549748413948174`*^9}},ExpressionUUID->"257aad44-d0fc-4693-b439-\
6a8b6f815e02"],

Cell["\<\
What a silly question!  This questions is ill-defined, unless we replace \
\[OpenCurlyDoubleQuote]typical\[CloseCurlyDoubleQuote] by something specific \
-- such as choosing a CRN at random in a well-defined way.  So what do random \
CRNs do?  Try it out below.  But note that there are an infinite number of \
ways to define \[OpenCurlyDoubleQuote]random\[CloseCurlyDoubleQuote], and \
different ways of randomly generating CRNs will generate different phenomena \
with different probabilities.   For example, here we don\[CloseCurlyQuote]t, \
but one could generate random CRNs that systematically conserve chosen \
properties, such as mass, or particle count, or energy.   Also note that \
whether a CRN does something interesting may very well depend on the initial \
conditions.   The results may look like a chaotic mess for some initial \
conditions, yet do something exquisitely precise for certain other initial \
conditions.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
  3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, {
  3.821676284148527*^9, 3.821676308089361*^9}, {3.8216763479066153`*^9, 
  3.821676374504348*^9}, {3.821763808589913*^9, 3.82176381316823*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"bf8043b9-b51d-4629-84ac-d78b340a6dd3"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"A", ",", "B", ",", "W", ",", "X", ",", "Y", ",", "Z"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.821763411609008*^9, 3.821763418302142*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"60626139-2bb2-404b-8a4c-716c8b12754b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomCRN", "[", 
   RowBox[{"species_", ",", "numreactions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RandomChoice", "[", "species", "]"}], "+", 
       RowBox[{"RandomChoice", "[", "species", "]"}]}], ",", 
      RowBox[{
       RowBox[{"RandomChoice", "[", "species", "]"}], "+", 
       RowBox[{"RandomChoice", "[", "species", "]"}]}], ",", "1"}], "]"}], 
    ",", "\[IndentingNewLine]", "numreactions"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.821671252474358*^9, 3.821671303680595*^9}, {
  3.82167139141533*^9, 3.821671420372325*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"0d6494ad-a449-44fb-a7f3-1d22f6db9708"],

Cell[BoxData[
 RowBox[{"rsys", "=", 
  RowBox[{"RandomCRN", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "B", ",", "W", ",", "X", ",", "Y", ",", "Z"}], "}"}], 
    ",", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{3.85497241075313*^9},
 CellLabel->
  "In[301]:=",ExpressionUUID->"7a5d6dba-41d2-46e7-9598-ac8f680ceb0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomCRNL", "[", 
   RowBox[{"species_", ",", "numreactions_"}], "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxnl", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomChoice", "[", "species", "]"}], ",", 
        RowBox[{"RandomChoice", "[", "species", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomChoice", "[", "species", "]"}], ",", 
        RowBox[{"RandomChoice", "[", "species", "]"}]}], "}"}], ",", "1"}], 
     "]"}], ",", "\[IndentingNewLine]", "numreactions"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.854972293719102*^9, 3.8549723189838448`*^9}, {
  3.854972382828668*^9, 3.854972397422318*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"a0285c8b-004f-4c76-9c4e-4de83e91d774"],

Cell[BoxData[
 RowBox[{"rsys", "=", 
  RowBox[{"RandomCRNL", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "B", ",", "W", ",", "X", ",", "Y", ",", "Z"}], "}"}], 
    ",", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.821671425331107*^9, 3.8216714427269707`*^9}, {
   3.821671814745276*^9, 3.8216718147836123`*^9}, 3.854972335061678*^9},
 CellLabel->
  "In[373]:=",ExpressionUUID->"1cc3d81e-e161-4a73-b268-f517ee78d604"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "random", " ", "example", " ", "that", " ", "I", " ", "thought", 
    " ", "was", " ", "somewhat", " ", "interesting", " ", "starting", " ", 
    "from", " ", "a", " ", "single", " ", "site"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "W", "X"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`X}, {$CellContext`Z, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Y}, {$CellContext`X, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "A", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`W}, {$CellContext`W, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "X", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`X, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`B}, {$CellContext`B, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "W", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Y}, {$CellContext`W, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "A", "Y"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`Y}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "W", "X"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`X}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Y", "Z"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`Z}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Y", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`Y, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`W}, {$CellContext`W, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`Z}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`X}, {$CellContext`A, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "A", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Z}, {$CellContext`A, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "X", "Y"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`Y}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`Z}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "X", "W"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Z", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`W}, {$CellContext`Z, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`X}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{
       "\[ThinSpace]","\" \"",
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"],
        OverscriptBox["\[DoubleLongRightArrow]", "1"],
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`A}, {$CellContext`Z, \
$CellContext`Z}, 1]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.854974080150931*^9, 3.854974081742176*^9}, {
  3.854974205065894*^9, 3.854974224036729*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"b0c7e076-4e2f-4e06-a294-68c4d8812403"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "W", "X"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`W, $CellContext`X}, {$CellContext`Z, \
$CellContext`Y}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Y}, {$CellContext`X, \
$CellContext`Z}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`W}, {$CellContext`W, \
$CellContext`Z}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "X", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`X, \
$CellContext`A}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`B, $CellContext`B}, {$CellContext`B, \
$CellContext`B}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "W", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`W, $CellContext`Y}, {$CellContext`W, \
$CellContext`B}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "Y"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`Y}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "W", "X"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`W, $CellContext`X}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Y", "Z"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Y, $CellContext`Z}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Y", "Y"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`Y, \
$CellContext`Y}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Y, $CellContext`W}, {$CellContext`W, \
$CellContext`Y}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`B, $CellContext`Z}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`A, $CellContext`X}, {$CellContext`A, \
$CellContext`Z}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Z}, {$CellContext`A, \
$CellContext`A}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "X", "Y"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`X, $CellContext`Y}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`X, $CellContext`Z}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "X", "W"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Z", "B"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`X, $CellContext`W}, {$CellContext`Z, \
$CellContext`B}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`X, $CellContext`X}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{
     "\[ThinSpace]","\" \"",
      TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"],
      OverscriptBox["\[DoubleLongRightArrow]", "1"],
      TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`W, $CellContext`A}, {$CellContext`Z, \
$CellContext`Z}, 1]]}], "}"}]], "Output",
 CellChangeTimes->{3.855522455378577*^9},
 CellLabel->
  "Out[442]=",ExpressionUUID->"70059036-b85f-487c-ab56-d81d51c322e6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "random", " ", "example", " ", "that", " ", "I", " ", "thought", 
    " ", "was", " ", "somewhat", " ", "interesting", " ", "starting", " ", 
    "from", " ", "quad", " ", "fields"}], " ", "*)"}], 
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`W}, {$CellContext`Z, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "X", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Y}, {$CellContext`X, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Z}, {$CellContext`Z, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`X}, {$CellContext`Y, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`W}, {$CellContext`Z, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`Z}, {$CellContext`Y, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Y}, {$CellContext`B, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`A}, {$CellContext`B, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`Z}, {$CellContext`A, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`Z}, {$CellContext`W, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`A}, {$CellContext`A, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`W}, {$CellContext`Z, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Y}, {$CellContext`Z, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`Y}, {$CellContext`A, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "X", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`W}, {$CellContext`X, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Z}, {$CellContext`A, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`X}, {$CellContext`Z, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Z}, {$CellContext`A, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`Z}, {$CellContext`Y, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`W}, {$CellContext`W, \
$CellContext`W}, 1]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.85497445301267*^9, 3.85497446170848*^9}},
 CellLabel->
  "In[466]:=",ExpressionUUID->"0b8947fe-4cbf-430c-a887-9f25a3248ae1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "random", " ", "example", " ", "that", " ", "I", " ", "thought", 
    " ", "was", " ", "somewhat", " ", "interesting", " ", "starting", " ", 
    "from", " ", "quad", " ", "fields"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`Y}, {$CellContext`B, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`Z}, {$CellContext`W, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Y}, {$CellContext`A, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Y}, {$CellContext`Z, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`X}, {$CellContext`A, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Z}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`A}, {$CellContext`B, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`Z}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "X", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`A}, {$CellContext`X, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Z}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`Y, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`X}, {$CellContext`Z, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`Z}, {$CellContext`Y, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`A}, {$CellContext`B, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "Y"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`Y}, {$CellContext`Y, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`X}, {$CellContext`Z, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`W}, {$CellContext`B, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`B}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`A}, {$CellContext`B, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "B"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`B}, {$CellContext`Z, \
$CellContext`Y}, 1]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.854974579925825*^9, 3.854974580607278*^9}, {
  3.8549746894977093`*^9, 
  3.854974690665522*^9}},ExpressionUUID->"f292eeb4-9be3-4d05-8a63-\
16f2f6aab2c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "a", " ", "random", " ", "example", " ", "that", " ", "I", " ", "thought", 
    " ", "was", " ", "somewhat", " ", "interesting", " ", "starting", " ", 
    "from", " ", "quad", " ", "fields"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"rsys", "=", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`Z, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`X}, {$CellContext`A, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "B"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`B}, {$CellContext`A, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "A", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`X}, {$CellContext`A, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`B}, {$CellContext`Y, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`Z}, {$CellContext`B, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`Z}, {$CellContext`X, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`X}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Z", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`Z, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "A", "B"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`A, $CellContext`B}, {$CellContext`X, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "B"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`A}, {$CellContext`B, \
$CellContext`B}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`W, $CellContext`A}, {$CellContext`Y, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "Y"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`W}, {$CellContext`B, \
$CellContext`Y}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`W}, {$CellContext`B, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "X"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`W}, {$CellContext`B, \
$CellContext`X}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "A"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "Z"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`A}, {$CellContext`W, \
$CellContext`Z}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Y", "W"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "B", "W"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Y, $CellContext`W}, {$CellContext`B, \
$CellContext`W}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "B", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`B, $CellContext`Z}, {$CellContext`W, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "Z", "Z"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "Y", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`Z, $CellContext`Z}, {$CellContext`Y, \
$CellContext`A}, 1]], ",", 
     InterpretationBox[
      TemplateBox[{"\[ThinSpace]", "\" \"", 
        TemplateBox[{"+", "\"+\"", "X", "X"}, "RowWithSeparators"], 
        OverscriptBox["\[DoubleLongRightArrow]", "1"], 
        TemplateBox[{"+", "\"+\"", "W", "A"}, "RowWithSeparators"]},
       "RowWithSeparators"],
      CRNSimulator`rxnl[{$CellContext`X, $CellContext`X}, {$CellContext`W, \
$CellContext`A}, 1]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8549748015554447`*^9, 
  3.854974804644951*^9}},ExpressionUUID->"cefcd333-348e-460f-be56-\
2606c582e009"],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "25"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j", "\[Equal]", "0"}], ",", "A", ",", 
         "W"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";", " ", 
  
  RowBox[{"time", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8216715082750263`*^9, 3.821671579840288*^9}, {
  3.821672002635049*^9, 3.821672004134974*^9}, {3.821672376078649*^9, 
  3.82167237615758*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"7758d2eb-a6a0-470f-9912-dcb98eddc4dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", "25"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "<", "0"}], "&&", " ", 
          RowBox[{"j", "<", "0"}]}], ",", "A", ",", 
         RowBox[{
          RowBox[{"i", ">", "0"}], "&&", 
          RowBox[{"j", "<", "0"}]}], ",", "B", ",", 
         RowBox[{
          RowBox[{"i", "<", "0"}], "&&", 
          RowBox[{"j", ">", "0"}]}], ",", "X", ",", 
         RowBox[{
          RowBox[{"i", ">", "0"}], "&&", 
          RowBox[{"i", ">", "0"}]}], ",", "Y", ",", "True", ",", "W"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"-", "m"}], ",", "m"}], "}"}]}], "]"}]}], "]"}]}], ";", " ", 
  
  RowBox[{"time", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8216715082750263`*^9, 3.821671579840288*^9}, {
  3.821672002635049*^9, 3.821672004134974*^9}, {3.821672376078649*^9, 
  3.82167237615758*^9}, {3.821676046834648*^9, 3.821676130143845*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"1784a18f-f415-49a1-ad08-451ff173e8a6"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"state", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"W", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".9", "]"}]}], ",", 
       RowBox[{"A", "\[Rule]", "Orange"}], ",", 
       RowBox[{"B", "\[Rule]", "Blue"}], ",", 
       RowBox[{"X", "\[Rule]", "Magenta"}], ",", 
       RowBox[{"Y", "\[Rule]", "Yellow"}], ",", 
       RowBox[{"Z", "\[Rule]", "Cyan"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQPX2XbNarijeOO9WnZ4NomZcRHSD6Ut1+MK0RxMAo
UvnG8WMKAzeILisOqQbRfvm7akA0B+ulwyDabm/eSRDd4952C0QfW/7vDoiO
/RX6BURfez8ZTK/f3NYsBaQjMle1gugOH/Ur0kA6xfPLNRCtflbCXxdIh3TL
gulVlsZlINrI+1oliP4hKamgB6SnsSwC030y63VB9Iey42B6yjkTExCtKVJg
CqJ7412tQbTLzD4wzXzwg6whkP7XyysHopX8JlSZA2mZ2FXVIFrstXUviPZ6
lzYZREd9V1gEojUuqoDpDfKW8yyA9NPuEDC9qOdAuxOQtnjC2wWi727KmgKi
/cyeTgfRAPr8p2s=
  "],
 CellLabel->
  "In[468]:=",ExpressionUUID->"06deeaaa-40c2-4eb3-8313-751dc4187d43"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"state", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"rsys", ",", "state", ",", "1"}], "]"}]}], ";", 
    RowBox[{"time", "+=", "1"}]}], ",", "5000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}, {3.821671637621358*^9, 3.821671656854603*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"0e16370e-1ce9-47a4-b592-f65d1904696b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constructing shapes and patterns", "Section",
 CellChangeTimes->{{3.821763440397541*^9, 3.8217634516429453`*^9}, {
  3.82176379466002*^9, 3.821763800413533*^9}, {3.822764656737865*^9, 
  3.822764670603891*^9}},ExpressionUUID->"c4757844-ce44-4b30-97ba-\
e2361aaf099c"],

Cell["\<\
Without knowing which way is which, it might seem hard for surface CRNs to \
build anything well-defined.  For example, the most naive attempt at \
\[OpenCurlyDoubleQuote]drawing a straight line\[CloseCurlyDoubleQuote] of Ts \
starting from X in a background of s, using just the reaction X+s \
\[RightArrow] T+X, completely fails unless the surface is a width-1 line.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
   3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, {
   3.821676284148527*^9, 3.821676308089361*^9}, {3.8216763479066153`*^9, 
   3.821676374504348*^9}, {3.821763808589913*^9, 3.82176381316823*^9}, 
   3.82276467480521*^9, {3.8227649763643837`*^9, 3.822765009721859*^9}, {
   3.822765168489194*^9, 3.822765170215624*^9}, {3.8227698486847687`*^9, 
   3.822769965262591*^9}, {3.8227701444792147`*^9, 3.822770147726737*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"fc66f781-8051-4130-8375-04962a14cb4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"randomdrawer", "=", 
   RowBox[{"{", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"X", "+", "s"}], ",", 
      RowBox[{"T", "+", "X"}], ",", "1"}], "]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8227704752355423`*^9, 3.8227704859288177`*^9}, {
   3.822771162664546*^9, 3.8227711634966087`*^9}, 3.854974850935481*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"cfea4d2c-2d1a-493d-96b5-07fae93fa1b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"surface", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".9", "]"}]}], ",", 
       RowBox[{"X", "\[Rule]", "Red"}], ",", 
       RowBox[{"T", "\[Rule]", "Black"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQPX2XbNarijeOO9WnZ4NomZcRHSD6Ut1+MK0RxMAo
UvnG8WMKAzeILisOqQbRfvm7akA0B+ulwyDabm/eSRDd4952C0QfW/7vDoiO
/RX6BURfez8ZTK/f3NYsBaQjMle1gugOH/Ur0kA6xfPLNRCtflbCXxdIh3TL
gulVlsZlINrI+1oliP4hKamgB6SnsSwC030y63VB9Iey42B6yjkTExCtKVJg
CqJ7412tQbTLzD4wzXzwg6whkP7XyysHopX8JlSZA2mZ2FXVIFrstXUviPZ6
lzYZREd9V1gEojUuqoDpDfKW8yyA9NPuEDC9qOdAuxOQtnjC2wWi727KmgKi
/cyeTgfRApP0oyKq3zgm5nnGgGimcpVsEH3W+x2YBgDDLLWF
  "],
 CellLabel->
  "In[212]:=",ExpressionUUID->"afaa68d9-c9b2-4874-bb47-87b79eff4507"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`surface, 
    ColorRules -> {$CellContext`s -> GrayLevel[0.9], $CellContext`X -> 
      Red, $CellContext`T -> Black}, PlotLabel -> $CellContext`time], 
   StandardForm],
  ImageSizeCache->{360., {185., 189.}}]], "Output",
 CellChangeTimes->{3.8555196012089005`*^9, 3.855519658460305*^9},
 CellLabel->"Out[212]=",ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzt27FOwzAQBuALKapACAkmxNSngYmdNSqNkgGB2ooVZeQVKmWEIrHnNfIW
6WOYOzuJ7dQIxFS1fySn7vnzxbm46pS7ZJnNHpNlPk0mt/PkOcuni8nN05xD
cUQUZdxeroj7iqhtsVIq1QfJ54xbxCEei7mr9EFyeuAW7c3osZybprnnNoaC
goKCgoKCgoKCgoKCgoKCgoKCgoLaK7Viccnhi1eiFTT0Qes3FiJlxhc09EHr
Xf3PgoKCgoKCgoKCgoKCgoKCgoKCgoKCgvq/ktPuvbUUGlU/vL8lNv9D76Mt
Sl2aNGlZc+DIRPtgUW366KYqUifc2R4b+2mzX/OIZOWD5+phrdue5DPDNuZ+
kXHbK2uT+V3OY2FbU2gkY7H+ru9GnjmddKuwq+kvTWub89xZpL+m7saLqjZC
X+fUmtDEYeY0WIo2qMclqmt61l2xSxqqz/bKK/c5qPCqzMpt5X9ZuVPLkal7
aAK19fAe6LDU6+C+sHfmF8N97l4ar+vui24/97vU3aN26wZ3uRcN7me52vAX
RNE3AMv+Lg==\
\>"],ExpressionUUID->"109d2d4d-edb3-4051-bb42-e2f7a134b994"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surface", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "=", "20"}], ",", 
       RowBox[{"M", "=", "20"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "/", "2"}], "]"}]}], "&&", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"M", "/", "2"}], "]"}]}]}], ",", "X", ",", "s"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"time", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"randomdrawer", ",", "surface"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"surface", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"randomdrawer", ",", "surface", ",", "1"}], "]"}]}], ";", 
    RowBox[{"time", "+=", "1"}]}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.82276478202707*^9, 3.8227647868181458`*^9}, {
  3.822764872626306*^9, 3.822764956663806*^9}, {3.822769990466804*^9, 
  3.822770124512641*^9}, {3.822770162343615*^9, 3.822770164453658*^9}, {
  3.8227704810619497`*^9, 3.8227705548216333`*^9}, {3.822771177508502*^9, 
  3.8227711884020977`*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"e5fb7358-6149-4fb9-93ba-16839bddc8b8"],

Cell["\<\
However, the CRN can figure out which way is which -- or at least make a \
consistent decision about which way will be which -- by testing local \
context.  As in the Circuit-SAT problem, a CRN can stochastically test \
possibilities until, by luck, it happens on a solution to its problem.  Here, \
sites in state A reversibly send out test probes P until the probes are next \
to each other, which guarantees that they are pointed in the right direction.\
\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
   3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, {
   3.821676284148527*^9, 3.821676308089361*^9}, {3.8216763479066153`*^9, 
   3.821676374504348*^9}, {3.821763808589913*^9, 3.82176381316823*^9}, 
   3.82276467480521*^9, {3.8227649763643837`*^9, 3.822765009721859*^9}, {
   3.822765168489194*^9, 3.822765170215624*^9}, {3.8227698486847687`*^9, 
   3.822769965262591*^9}, {3.8227701444792147`*^9, 3.822770147726737*^9}, {
   3.822770305850007*^9, 3.822770454221199*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"8b95ad6a-ff49-4b30-9f2a-2e53811d8eba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"linedrawer", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"X", "+", "s"}], ",", 
       RowBox[{"A", "+", "A"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"A", "+", "s"}], ",", 
       RowBox[{"T", "+", "P"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"T", "+", "P"}], ",", 
       RowBox[{"A", "+", "s"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"P", "+", "P"}], ",", 
       RowBox[{"A", "+", "A"}], ",", "1"}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.8227704752355423`*^9, 3.8227704859288177`*^9}, {
  3.82277056671556*^9, 3.822770636711953*^9}, {3.822770694003735*^9, 
  3.822770694227624*^9}, {3.822771152253791*^9, 3.822771152297626*^9}, {
  3.854974899776772*^9, 3.854974925269829*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"6947f0cd-df5f-4423-ad2d-ae4e52a723d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"surface", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".9", "]"}]}], ",", 
       RowBox[{"X", "\[Rule]", "Red"}], ",", 
       RowBox[{"T", "\[Rule]", "Black"}], ",", 
       RowBox[{"A", "\[Rule]", "Pink"}], ",", 
       RowBox[{"P", "\[Rule]", "Green"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQPX2XbNarijeOO9WnZ4NomZcRHSD6Ut1+MK0RxMAo
UvnG8WMKAzeILisOqQbRfvm7akA0B+ulwyDabm/eSRDd4952C0QfW/7vDoiO
/RX6BURfez8ZTK/f3NYsBaQjMle1gugOH/Ur0kA6xfPLNRCtflbCXxdIh3TL
gulVlsZlINrI+1oliP4hKamgB6SnsSwC030y63VB9Iey42B6yjkTExCtKVJg
CqJ7412tQbTLzD4wzXzwg6whkP7XyysHopX8JlSZA2mZ2FXVIFrstXUviPZ6
lzYZREd9V1gEojUuqoDpDfKW8yyA9NPuEDC9qOdAuxOQtnjC2wWi727KmgKi
/cyeTgfRApP0oyKq3zgm5nnGgGimcpVsEH3W+x2YflCcaBUNpO+anLQB0QBi
/72Q
  "],
 CellLabel->
  "In[454]:=",ExpressionUUID->"c902411d-7e91-4705-8a3b-a0029239478e"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`surface, 
    ColorRules -> {$CellContext`s -> GrayLevel[0.9], $CellContext`X -> 
      Red, $CellContext`T -> Black, $CellContext`A -> Pink, $CellContext`P -> 
      Green}, PlotLabel -> $CellContext`time], StandardForm],
  ImageSizeCache->{360., {185., 189.}}]], "Output",
 CellChangeTimes->{3.8554171840919495`*^9, 3.855519637538113*^9, 
  3.855519690251794*^9, 3.8555235083102636`*^9},
 CellLabel->"Out[454]=",ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzt27tOwzAUBuATQuhcJFQkGPo0MLGzRqVRMiBQW7FWeY1KGblI3fMaeYv0
Mcw5tqmdYMplKtUfycH5/dmxXVdMvUkX+fQ+XRSTdHw9Sx/zYjIfXz3MOIoj
oijn8nROXFdEtsRKqUxfJH+nXCKOuC3mqtIXye2OS3QwrYnc27a95TKAgoKC
goKCgoKCgoKCgoKCgoKCgoKCOii1YnHK8ZAUraChodVyuYaE/NdyX//fQEFB
QUFBQUFBQUFBQUFBQUFBQUFBQf1dyW3/fnEUalVf/PZKbPGD2ovdlKYyw2RV
w8GRSbdhWW++STd1mXkxvbnRL7iDjMoXK91Jv8/WpKdtDoUuM7Ge36se/Vnu
AyFOWE7H0hbrZ92j/5zo5+3MzEzNiGfeNLsT+FhkWTdOfAp3jX1peGg7bKjb
TRoKpbadm+3v7cbIZHXlfUKdF3kLCq9SXqoPHcV2lt0V9Pd0+JvBbUprdzpG
7nS4ne6ufFdoJ+OPmLjPxJwFe27dEfXPeCg98U6zbTB7LC/sf4Moegceixkt
\
\>"],ExpressionUUID->"7f6dc83b-b7a9-443c-9218-5b5c926ed49b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"surface", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "=", "20"}], ",", 
       RowBox[{"M", "=", "20"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "/", "2"}], "]"}]}], "&&", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"M", "/", "2"}], "]"}]}]}], ",", "X", ",", "s"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"time", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"HaltedSurfaceCRNQ", "[", 
      RowBox[{"linedrawer", ",", "surface"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"surface", "=", 
      RowBox[{"RunSurfaceCRN", "[", 
       RowBox[{"linedrawer", ",", "surface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"time", "+=", "1"}]}]}], "]"}], 
  " "}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.82276478202707*^9, 3.8227647868181458`*^9}, {
   3.822764872626306*^9, 3.822764956663806*^9}, {3.822769990466804*^9, 
   3.822770124512641*^9}, {3.822770162343615*^9, 3.822770164453658*^9}, {
   3.8227704810619497`*^9, 3.8227705548216333`*^9}, {3.8227706712649612`*^9, 
   3.822770677963211*^9}, 3.8555132274280663`*^9},
 CellLabel->
  "In[461]:=",ExpressionUUID->"93918390-6488-4878-8739-20b1ef46ae89"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.855417188808175*^9, 3.855519654084396*^9, 
  3.8555196977483387`*^9, 3.855519766854677*^9, 3.8555210302008505`*^9, 
  3.855523518855813*^9, 3.8555237158192654`*^9},
 CellLabel->
  "Out[462]=",ExpressionUUID->"d6f8abce-3d55-452c-b93d-51cb42f52129"]
}, Open  ]],

Cell["\<\
Can you modify this CRN to draw a line of width 1?  A line of a specific \
length?  Something more complex?\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
   3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, {
   3.821676284148527*^9, 3.821676308089361*^9}, {3.8216763479066153`*^9, 
   3.821676374504348*^9}, {3.821763808589913*^9, 3.82176381316823*^9}, 
   3.82276467480521*^9, {3.8227649763643837`*^9, 3.822765009721859*^9}, {
   3.822765168489194*^9, 3.822765170215624*^9}, {3.8227698486847687`*^9, 
   3.822769965262591*^9}, {3.8227701444792147`*^9, 3.822770147726737*^9}, {
   3.822770305850007*^9, 3.822770454221199*^9}, {3.822771307316422*^9, 
   3.822771326849959*^9}, {3.822772012090506*^9, 3.8227720155078077`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"d3fd4bdd-b6f0-446d-814a-1d31c4a991a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"surface", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "=", "20"}], ",", 
      RowBox[{"M", "=", "20"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "\[Equal]", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"N", "/", "2"}], "]"}]}], "&&", 
         RowBox[{"j", "\[Equal]", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"M", "/", "2"}], "]"}]}]}], ",", "S", ",", "x"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "N"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.8217322544778967`*^9, 3.8217323096311903`*^9}, {
   3.821732375466367*^9, 3.8217323790470333`*^9}, {3.82173573334377*^9, 
   3.8217357562675533`*^9}, {3.8217437770465527`*^9, 3.82174377720208*^9}, 
   3.8217439263843937`*^9, {3.821743974969143*^9, 3.821744186955599*^9}, {
   3.8217442330856543`*^9, 3.821744427886586*^9}, {3.821744469413293*^9, 
   3.82174460276119*^9}, 3.821746974969253*^9, {3.854848036261303*^9, 
   3.854848049714507*^9}, 3.8554299956074424`*^9, 3.8554300824839315`*^9, 
   3.8554302075061803`*^9, {3.855430673042662*^9, 3.8554306737257705`*^9}, {
   3.8554307374254723`*^9, 3.8554307382952824`*^9}, {3.8554308230944557`*^9, 
   3.8554308240073786`*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"818a3802-63a6-401a-8a55-00fca9781b02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "S", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x",
      ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", ",", "x", 
     ",", "x", ",", "x", ",", "x", ",", "x", ",", "x"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.855430739052903*^9, 3.8554308322677784`*^9, 
  3.855519973818571*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"d35921a0-4617-4289-b777-bcae02a08a17"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"linedrawer", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"X", "+", "s"}], ",", 
       RowBox[{"X", "+", "T"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"T", "+", "s"}], ",", 
       RowBox[{"T", "+", "A"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"A", "+", "s"}], ",", 
       RowBox[{"A", "+", "P"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"P", "+", "s"}], ",", 
       RowBox[{"P", "+", "X"}], ",", "1"}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.855519948946455*^9, 3.855519950779607*^9}, {
  3.855520160615252*^9, 3.8555201656363583`*^9}, {3.855520228157096*^9, 
  3.855520259678485*^9}, {3.855520293180003*^9, 3.855520312093526*^9}, {
  3.855520344979873*^9, 3.8555203513424006`*^9}, {3.8555207125299664`*^9, 
  3.8555207320596447`*^9}, {3.855520809540369*^9, 3.855520846636807*^9}, {
  3.855520912689451*^9, 3.8555209144497747`*^9}, {3.8555209757125196`*^9, 
  3.8555209971630125`*^9}, {3.8555210622680054`*^9, 3.8555210629835835`*^9}, {
  3.8555210997006187`*^9, 3.855521107271655*^9}, {3.8555211391188493`*^9, 
  3.8555211477255535`*^9}, {3.855521216429903*^9, 3.8555212887775817`*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"fc5a8001-49d1-49d5-a090-e80bcf8e88a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"surface", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".9", "]"}]}], ",", 
       RowBox[{"X", "\[Rule]", "Red"}], ",", 
       RowBox[{"T", "\[Rule]", "Black"}], ",", 
       RowBox[{"A", "\[Rule]", "Pink"}], ",", 
       RowBox[{"P", "\[Rule]", "Green"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8555199523363247`*^9, 3.8555199546395564`*^9}, {
  3.855520237707615*^9, 3.85552023940396*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"f0c400c5-6351-49fb-b336-8f2dc9a40700"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`surface, 
    ColorRules -> {$CellContext`s -> GrayLevel[0.9], $CellContext`X -> 
      Red, $CellContext`T -> Black, $CellContext`A -> Pink, $CellContext`P -> 
      Green}, PlotLabel -> $CellContext`time], StandardForm],
  ImageSizeCache->{360., {185., 189.}}]], "Output",
 CellChangeTimes->{
  3.855430885755437*^9, 3.8555199582791605`*^9, {3.85552023080538*^9, 
   3.8555202397508984`*^9}, 3.8555203137482195`*^9, 3.85552072122803*^9, {
   3.855520980949841*^9, 3.855520998873192*^9}, 3.8555210643614674`*^9, 
   3.8555211017314*^9, 3.855521218990396*^9},
 CellLabel->
  "Out[334]=",ExpressionUUID->"a1e2b9c8-2967-4a35-a47c-f8cbef233333"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surface", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "=", "20"}], ",", 
       RowBox[{"M", "=", "20"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "/", "2"}], "]"}]}], "&&", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"M", "/", "2"}], "]"}]}]}], ",", "X", ",", "s"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"linedrawer", ",", "surface"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"surface", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"linedrawer", ",", "surface", ",", "1"}], "]"}]}], ";", 
    RowBox[{"time", "+=", "1"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8555199649314566`*^9, 3.855519981260166*^9}},
 CellLabel->
  "In[481]:=",ExpressionUUID->"99609be7-6b85-415a-9c52-a304259c9e09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"linedrawer", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"X", "+", "s"}], ",", 
       RowBox[{"X", "+", "T"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"T", "+", "s"}], ",", 
       RowBox[{"T", "+", "X"}], ",", "1"}], "]"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.855519948946455*^9, 3.855519950779607*^9}, {
   3.855520160615252*^9, 3.8555201656363583`*^9}, {3.855520228157096*^9, 
   3.855520259678485*^9}, {3.855520293180003*^9, 3.855520312093526*^9}, {
   3.855520344979873*^9, 3.8555203513424006`*^9}, {3.8555207125299664`*^9, 
   3.8555207320596447`*^9}, {3.855520809540369*^9, 3.855520846636807*^9}, {
   3.855520912689451*^9, 3.8555209144497747`*^9}, {3.8555209757125196`*^9, 
   3.8555209971630125`*^9}, {3.8555210622680054`*^9, 
   3.8555210629835835`*^9}, {3.8555210997006187`*^9, 3.855521107271655*^9}, {
   3.8555211391188493`*^9, 3.8555211477255535`*^9}, {3.855521216429903*^9, 
   3.8555212887775817`*^9}, {3.8555215189816103`*^9, 3.8555215577150583`*^9}, 
   3.855521680853815*^9, {3.855521959954999*^9, 3.8555219662862678`*^9}, {
   3.855523116985407*^9, 3.8555231289325724`*^9}, {3.855523451505348*^9, 
   3.8555234587175856`*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"6d93a5da-ab0e-4094-8351-7337abd44abf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"surface", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".9", "]"}]}], ",", 
       RowBox[{"X", "\[Rule]", "Red"}], ",", 
       RowBox[{"T", "\[Rule]", "Black"}], ",", 
       RowBox[{"A", "\[Rule]", "Pink"}], ",", 
       RowBox[{"P", "\[Rule]", "Green"}], ",", 
       RowBox[{"F", "\[Rule]", "Yellow"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8555199523363247`*^9, 3.8555199546395564`*^9}, {
  3.855520237707615*^9, 3.85552023940396*^9}, {3.8555215433030496`*^9, 
  3.8555215472280393`*^9}},
 CellLabel->
  "In[444]:=",ExpressionUUID->"cec3cc1a-f27d-4da3-97a7-0bfb32bea5fb"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   ArrayPlot[$CellContext`surface, 
    ColorRules -> {$CellContext`s -> GrayLevel[0.9], $CellContext`X -> 
      Red, $CellContext`T -> Black, $CellContext`A -> Pink, $CellContext`P -> 
      Green, $CellContext`F -> Yellow}, PlotLabel -> $CellContext`time], 
   StandardForm],
  ImageSizeCache->{360., {185., 189.}}]], "Output",
 CellChangeTimes->{
  3.855430885755437*^9, 3.8555199582791605`*^9, {3.85552023080538*^9, 
   3.8555202397508984`*^9}, 3.8555203137482195`*^9, 3.85552072122803*^9, {
   3.855520980949841*^9, 3.855520998873192*^9}, 3.8555210643614674`*^9, 
   3.8555211017314*^9, 3.855521218990396*^9, 3.855521559175799*^9, 
   3.8555216825970974`*^9, 3.855523130858446*^9},
 CellLabel->
  "Out[444]=",ExpressionUUID->"53b63d86-f649-4a3d-976a-02674cd1b913"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surface", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "=", "20"}], ",", 
       RowBox[{"M", "=", "20"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"N", "/", "2"}], "]"}]}], "&&", 
          RowBox[{"j", "\[Equal]", 
           RowBox[{"Ceiling", "[", 
            RowBox[{"M", "/", "2"}], "]"}]}]}], ",", "X", ",", "s"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"linedrawer", ",", "surface"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"surface", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"linedrawer", ",", "surface", ",", "1"}], "]"}]}], ";", 
    RowBox[{"time", "+=", "1"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8555199649314566`*^9, 3.855519981260166*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"406e0696-6e9c-4575-a9d3-fdbe0c7ccfd3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-dimensional Turing machine swarms", "Section",
 CellChangeTimes->{{3.821763440397541*^9, 3.8217634516429453`*^9}, {
  3.82176379466002*^9, 3.821763800413533*^9}, {3.821763936650257*^9, 
  3.8217639422815228`*^9}},ExpressionUUID->"5fa26c2e-afce-4858-bd9e-\
2242d50f8f64"],

Cell["\<\
If there\[CloseCurlyQuote]s space for it, a single surface could have \
multiple separate Turing machine tapes, with a Turing machine head on each \
tape acting in parallel.   With a small modification, they could even \
communicate with each other:  e.g. if a Turing machine head enters state \
SEND[X], it could release an X into the space around it (where it will \
diffuse away) and transition to state WAIT; if it later bumps into a Y0 or \
Y1, it can write that onto the tape and continue computation.  Alternatively, \
a Turing machine head could fall off its tape when it is done with a \
computation, then diffuse around until it bumps into a different tape, which \
it could then process.  On a large surface, many Turing machine heads could \
process a great many tapes.  With care, one or more Turing machine heads \
could operate on a 2D tape, following instructions that tell the head to go \
left, right, up, or down based on the current symbol being read.  (As the 1D \
tape required some extra labels to distinguish left from right, a 2D tape \
would also require extra labels to make directions unambiguous.)   While we \
are not implementing such things here, hopefully these words will buzz around \
in the back of your head.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
   3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, 
   3.821674093331551*^9, {3.821676401097584*^9, 3.821676721338888*^9}, {
   3.821676820204028*^9, 3.8216768881355047`*^9}, {3.821677000094961*^9, 
   3.8216770352600107`*^9}, {3.821677745558065*^9, 3.821677751396536*^9}, {
   3.821763889733966*^9, 3.821763914294847*^9}, {3.821763947794381*^9, 
   3.821763976941777*^9}, {3.821764105144174*^9, 3.821764277555039*^9}, {
   3.821764312895598*^9, 3.821764350437607*^9}, {3.8217644350046053`*^9, 
   3.821764497527019*^9}, {3.8217650027471857`*^9, 3.821765013166335*^9}, {
   3.821765056675043*^9, 3.821765193923863*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"8581ce32-b34d-4159-8a87-c2c5144eba40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Digital circuits on a surface, just 20 reactions.", "Section",
 CellChangeTimes->{{3.821763440397541*^9, 3.8217634516429453`*^9}, {
  3.82176379466002*^9, 3.821763800413533*^9}, {3.821763836123047*^9, 
  3.821763849655735*^9}},ExpressionUUID->"9eae8a00-caf2-4017-bdee-\
852062e91827"],

Cell["\<\
In ModelsOfComputation.nb, we encountered the Wire World cellular automata, \
which can implement arbitrary digital circuits \[OpenCurlyDoubleQuote]simply\
\[CloseCurlyDoubleQuote] by drawing their circuit diagram in the initial \
state.  That cellular automaton is synchronous, so signals travel at \
identical speeds along wires, and adjusting wire lengths such that signals \
arrive at gates at exactly the same time was essential to ensuring proper \
function.  Can we do something similar in the surface CRN model, which can be \
considered a limited subclass of asynchronous cellular automata?  We have a \
few challenges to overcome.  First, CRN reactions are not oriented, so we \
need a way to convince signals to travel in the desired direction.  For this, \
we will make the wires directional repeating patterns abcabcabc... so that \
signals move from a to b to c to a.  Second, because signals will travel at \
different random speeds, they cannot be counted on to arrive at gates at the \
same time, so the gates must be designed to wait for them.  Thus, a two-input \
gate must distinguish between signals arriving sequentially on the same wire, \
versus one signal arriving on each wire; for this, we layout the gates and \
wires such that inputs and outputs are at different phases of the wires, e.g. \
our NOR gate receives input1 on phase a, input 2 on phase b, and sends output \
to phase c.  As a consequence, we have our third challenge, that of laying \
out the wires so that they arrive at their destinations in the required phase.

To obtain a relatively small CRN, we only implement a NOR gate and a FANOUT \
gate.  All other digital logic operations (AND, OR, XOR, NAND, etc) can be \
constructed using small circuits of NOR gates, with fanout.    With a little \
more cleverness, a non-planar circuit can be converted into a planar circuit \
by mimicking the logic of a wire cross operation (Goldschlager 1977), \
allowing arbitrary wiring.  Repetitive constant inputs can be provided via a \
FANOUT loop; a record of whether the circuit ever output a 1 can be stored in \
an OR-gate feedback loop.   A synchronization signal can be implemented via \
AND and FANOUT, enabling iterative computation f(f(f(...f(x)...))) as in a CPU.

In the example below, you\[CloseCurlyQuote]ll see that the repetitive input \
source loops have different lengths, resulting in the signals being produced \
at different frequencies... the more rapidly produced signals pile up in a \
traffic jam, but no logical errors occur, just delays.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.82167360332609*^9, 
   3.821673777059339*^9}, {3.8216738276566133`*^9, 3.821673911039753*^9}, 
   3.821674093331551*^9, {3.821676401097584*^9, 3.821676721338888*^9}, {
   3.821676820204028*^9, 3.8216768881355047`*^9}, {3.821677000094961*^9, 
   3.8216770352600107`*^9}, {3.821761077455758*^9, 3.821761171382338*^9}, {
   3.821761218348279*^9, 3.8217613537321033`*^9}, {3.821761386479988*^9, 
   3.821761538108452*^9}, {3.821761613784971*^9, 3.821761754592725*^9}, 
   3.821761837296856*^9, {3.8217620695798492`*^9, 3.821762118870047*^9}, {
   3.8217622927580547`*^9, 3.8217622973226423`*^9}, {3.821762480543173*^9, 
   3.8217625873384647`*^9}, {3.821762797223405*^9, 3.8217629349650784`*^9}, {
   3.821762991054063*^9, 3.821763077809011*^9}, {3.8217646916043873`*^9, 
   3.8217646937837677`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"f4933c45-b25c-4673-a9d0-72adf19b1ac2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "o", ",", "a", ",", "b", ",", "c", ",", "a0", ",", "b0", ",", "c0", ",", 
   "a1", ",", "b1", ",", "c1", ",", "FAN", ",", "F11", ",", "F1", ",", "F00", 
   ",", "F0", ",", "NOR", ",", "N0", ",", "N1", ",", "NOR0", ",", "NOR1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circuits", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "directional", " ", "movement", " ", "of", " ", "signal", " ", "along", 
      " ", "abcabcabc", " ", 
      RowBox[{"wire", ":", " ", 
       RowBox[{"6", " ", "reactions"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a0", "+", "b"}], ",", 
       RowBox[{"a", "+", "b0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a1", "+", "b"}], ",", 
       RowBox[{"a", "+", "b1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b0", "+", "c"}], ",", 
       RowBox[{"b", "+", "c0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b1", "+", "c"}], ",", 
       RowBox[{"b", "+", "c1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"c0", "+", "a"}], ",", 
       RowBox[{"c", "+", "a0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"c1", "+", "a"}], ",", 
       RowBox[{"c", "+", "a1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fanout", " ", "gate", " ", "with", " ", "input", " ", "on", " ", 
        "a"}], ",", " ", 
       RowBox[{"output", " ", "on", " ", "b", " ", "and", " ", 
        RowBox[{"c", ":", " ", 
         RowBox[{"6", " ", "reactions"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a1", "+", "FAN"}], ",", 
       RowBox[{"a", "+", "F11"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"F11", "+", "b"}], ",", 
       RowBox[{"F1", "+", "b1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"F1", "+", "c"}], ",", 
       RowBox[{"FAN", "+", "c1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a0", "+", "FAN"}], ",", 
       RowBox[{"a", "+", "F00"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"F00", "+", "b"}], ",", 
       RowBox[{"F0", "+", "b0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"F0", "+", "c"}], ",", 
       RowBox[{"FAN", "+", "c0"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "NOR", " ", "gate", " ", "with", " ", "input", " ", "on", " ", "a", 
        " ", "and", " ", "b"}], ",", " ", 
       RowBox[{"output", " ", "on", " ", 
        RowBox[{"c", ":", " ", 
         RowBox[{"8", " ", "reactions"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a0", "+", "NOR"}], ",", 
       RowBox[{"a", "+", "N0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"a1", "+", "NOR"}], ",", 
       RowBox[{"a", "+", "N1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b0", "+", "N0"}], ",", 
       RowBox[{"b", "+", "NOR1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b0", "+", "N1"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b1", "+", "N0"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"b1", "+", "N1"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"NOR0", "+", "c"}], ",", 
       RowBox[{"NOR", "+", "c0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxno", "[", 
      RowBox[{
       RowBox[{"NOR1", "+", "c"}], ",", 
       RowBox[{"NOR", "+", "c1"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8217584323952703`*^9, 3.82175894006706*^9}, {
  3.8217599293929043`*^9, 3.821759929504713*^9}, {3.821759989091157*^9, 
  3.821759994585959*^9}, {3.821761158191145*^9, 3.8217611633738203`*^9}, {
  3.82176205966555*^9, 3.821762061649115*^9}, {3.8217629589256496`*^9, 
  3.821762969430173*^9}, {3.821763291371709*^9, 3.821763294060442*^9}, {
  3.854974959100514*^9, 3.854975009581514*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"b8c6a082-7218-4c3c-b577-0644286d4ece"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"layout", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "a", ",", "b", ",", "c", ",", "a1", ",", "b", ",", "c", ",", 
       "a", ",", "o", ",", "b", ",", "c", ",", "a", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "c", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "FAN", ",", "c", ",", "a", ",", "o", ",", "b", ",", "o", ",", "a",
        ",", "b", ",", "NOR", ",", "  ", "c", ",", "a", ",", "b", ",", "c", 
       ",", "a", ",", "NOR", ",", " ", "c", ",", "a", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "b", ",", "a", ",", "c", ",", "b", ",", "  ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "o", ",", "o", ",", "c", ",", "    ", "o", 
       ",", "c", ",", "o", ",", "a", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "b", ",", "o", ",", "b", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "a", ",", "    ", "o", 
       ",", "b", ",", "o", ",", "c", ",", "  ", "b", ",", "    ", "a", ",", 
       "c", ",", "o", ",", "o", ",", "a", ",", "o", ",", "c", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "a", ",", "b", ",", "c", ",", "a1", ",", "b", ",", "c", ",", 
       "a", ",", "o", ",", "o", ",", "o", ",", "NOR", ",", "c", ",", "a", ",",
        "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", "b", ",", "o", 
       ",", "o", ",", "c", ",", "b", ",", "a1", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "c", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "FAN", ",", "c", ",", "a", ",", "o", ",", "b", ",", "o", ",", "o",
        ",", "o", ",", "b", ",", "  ", "c", ",", "    ", "a", ",", "FAN", ",",
        "c", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "b", ",", "a", ",", "c", ",", "b", ",", "  ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "b", ",", "c", ",", "a", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "a", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "a", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "c", ",", "b0", ",", "    ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circuittime", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8217509267172527`*^9, 3.8217509628517447`*^9}, {
   3.8217510345331087`*^9, 3.8217512847061453`*^9}, {3.821751343337679*^9, 
   3.821751346463264*^9}, {3.821751509046467*^9, 3.8217515094451103`*^9}, {
   3.821751598418005*^9, 3.821751598645246*^9}, {3.8217518701569347`*^9, 
   3.821751870661212*^9}, {3.821759021405603*^9, 3.821759422413495*^9}, {
   3.821759457740449*^9, 3.82175965278966*^9}, {3.821759789433323*^9, 
   3.821759796384386*^9}, {3.821760042774165*^9, 3.821760062173263*^9}, {
   3.821760095549823*^9, 3.821760260078516*^9}, 3.821760381440593*^9, {
   3.821761911459876*^9, 3.8217620356601973`*^9}, {3.8217631385112047`*^9, 
   3.821763170167543*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"346c42e5-9b55-40fe-afb6-42c1108674ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"circuitcolors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"o", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".5", "]"}]}], ",", 
     RowBox[{"b", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.6", "]"}]}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.7", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"a0", "\[Rule]", "Red"}], ",", 
     RowBox[{"b0", "\[Rule]", "Red"}], ",", 
     RowBox[{"c0", "\[Rule]", "Red"}], ",", 
     RowBox[{"a1", "\[Rule]", "Green"}], ",", 
     RowBox[{"b1", "\[Rule]", "Green"}], ",", 
     RowBox[{"c1", "\[Rule]", "Green"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FAN", "|", "F11", "|", "F1", "|", "F00", "|", "F0"}], 
      "\[Rule]", "Blue"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NOR", "|", "N0", "|", "N1", "|", "NOR0", "|", "NOR1"}], 
      "\[Rule]", "Purple"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EAT", "\[Rule]", "Yellow"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8217596812133417`*^9, 3.8217598542563972`*^9}, {
  3.821759903698346*^9, 3.8217599073345013`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"1e5c064c-17b0-4132-94f9-c4c071ff9f12"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"layout", ",", 
    RowBox[{"ColorRules", "\[Rule]", "circuitcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "circuittime"}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.821751287706839*^9, 3.821751491621811*^9}, {
  3.821759665796956*^9, 3.821759688090034*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"9f978709-d40c-4a99-a549-f2c4fdb69bfd"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"layout", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"circuits", ",", "layout", ",", ".1"}], "]"}]}], ";", 
    RowBox[{"circuittime", "+=", ".1"}]}], ",", "5000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}, {3.821671637621358*^9, 3.821671656854603*^9}, {
   3.821751523559148*^9, 3.8217515565243597`*^9}, {3.821760328115385*^9, 
   3.8217603486219893`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"574d47e1-e2fc-4180-8012-deef8a501c78"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diffusion-limited aggregation in 2D and 3D", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 3.8293157428071747`*^9}, {3.855017005397118*^9, 
  3.855017009988099*^9}},ExpressionUUID->"d80cba19-684b-4342-8a46-\
0c91fadc84c2"],

Cell[TextData[{
 "This is meant to be a reasonably typical surface CRN example, which we\
\[CloseCurlyQuote]ll use for initial testing.  Later, we\[CloseCurlyQuote]ll \
try more examples.\n\nNot a great idea to try to rotate a 3D plot while \
things are running.  If you want to try, save your notebook first, because \
Mathematica might crash!  Rotating ",
 StyleBox["after",
  FontSlant->"Italic"],
 " the simulation is done should work fine, of course."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.829331821875764*^9, 3.829331853437752*^9}, 
   3.829331926731311*^9, {3.8294283187790537`*^9, 3.829428343589019*^9}, {
   3.8551017463404827`*^9, 3.85510178676959*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"cb9f8e58-400f-4f1e-a576-17593328ee40"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DLAinit2D", "=", 
   RowBox[{"ArrayPad", "[", 
    RowBox[{
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "F", "}"}], "}"}], ",", "20", ",", "W"}], "]"}], ",", 
     "1", ",", "G"}], "]"}]}], ";", 
  RowBox[{"space2D", "=", "DLAinit2D"}], ";", " ", 
  RowBox[{"time2D", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLAinit3D", "=", 
   RowBox[{"ArrayPad", "[", 
    RowBox[{
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", "F", "}"}], "}"}], "}"}], ",", "10", ",", "W"}], "]"}], 
     ",", "1", ",", "G"}], "]"}]}], ";", 
  RowBox[{"space3D", "=", "DLAinit3D"}], ";", " ", 
  RowBox[{"time3D", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DLAcoloring", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
     RowBox[{"G", "\[Rule]", 
      RowBox[{"Lighter", "[", "Gray", "]"}]}], ",", 
     RowBox[{"P", "\[Rule]", 
      RowBox[{"Opacity", "[", 
       RowBox[{"0.2", ",", "Gray"}], "]"}]}], ",", " ", 
     RowBox[{"W", "\[Rule]", "White"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DLAcrn", "=", "\[IndentingNewLine]", 
  RowBox[{"{", "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"G", "+", "W"}], ",", 
      RowBox[{"G", "+", "P"}], ",", "0.02"}], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "create", " ", "a", " ", "new", " ", "diffusing", " ", "particle", " ", 
      "near", " ", "the", " ", "generative", " ", "boundary", " ", "of", " ", 
      "\"\<G\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"G", "+", "P"}], ",", 
      RowBox[{"G", "+", "W"}], ",", "1"}], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "particles", " ", "can", " ", "also", " ", "diffuse", " ", "out", " ", 
       "through", " ", "the", " ", "G", " ", "walls"}], ",", " ", 
      RowBox[{
       RowBox[{"so", " ", "steady"}], "-", 
       RowBox[{"state", " ", "concentration", " ", "is", " ", "10", "%"}]}]}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"P", "+", "W"}], ",", 
      RowBox[{"W", "+", "P"}], ",", "1"}], "]"}], ",", 
    RowBox[{"(*", " ", 
     RowBox[{"particle", " ", "diffuses", " ", "through", " ", "water"}], " ",
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxno", "[", 
     RowBox[{
      RowBox[{"P", "+", "F"}], ",", 
      RowBox[{"F", "+", "F"}], ",", "10"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "particle", " ", "freezes", " ", "when", " ", "it", " ", "touches", " ", 
     "frozen", " ", "molecules"}], " ", "*)"}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.8264996895813427`*^9, 3.826499737796554*^9}, {
   3.8264997742397833`*^9, 3.8264997939540586`*^9}, {3.8264999167906723`*^9, 
   3.826499926469016*^9}, {3.826500029638318*^9, 3.826500029939207*^9}, {
   3.826500421423396*^9, 3.826500425089904*^9}, {3.826500531151617*^9, 
   3.826500531481823*^9}, {3.826502361878281*^9, 3.8265023842688093`*^9}, {
   3.8265033827760277`*^9, 3.826503390447267*^9}, {3.826504179273624*^9, 
   3.826504239545396*^9}, {3.826504534877653*^9, 3.8265045366355667`*^9}, {
   3.826504632039052*^9, 3.8265046396276217`*^9}, {3.8265053735977507`*^9, 
   3.826505487206479*^9}, {3.8265055477485857`*^9, 3.826505629440769*^9}, {
   3.826505659712998*^9, 3.826505911832775*^9}, {3.826505950412156*^9, 
   3.82650595117912*^9}, {3.826505981279467*^9, 3.826506091659033*^9}, {
   3.826506227090391*^9, 3.826506227410582*^9}, {3.826506263703318*^9, 
   3.826506271795012*^9}, {3.827432476601519*^9, 3.827432500902001*^9}, {
   3.8274325434657507`*^9, 3.8274325534119596`*^9}, {3.827432624356997*^9, 
   3.827432781757617*^9}, 3.827454495960462*^9, {3.827456800281636*^9, 
   3.827456800693369*^9}, {3.8276986531028423`*^9, 3.827698742454764*^9}, {
   3.827698895577091*^9, 3.827698898361462*^9}, {3.829315652217708*^9, 
   3.829315664241089*^9}, {3.829315988034835*^9, 3.829315988433991*^9}, {
   3.829316227362216*^9, 3.829316232283485*^9}, {3.829331907701565*^9, 
   3.829331932766954*^9}, {3.829331965331389*^9, 3.829331991292667*^9}, {
   3.829332147217218*^9, 3.829332147503584*^9}, {3.829335925805994*^9, 
   3.829335953215469*^9}, {3.855017039421708*^9, 3.855017047232388*^9}, {
   3.855017481193866*^9, 3.855017543727788*^9}, {3.855017818057169*^9, 
   3.85501781922721*^9}, 3.855019339214273*^9, {3.855019419974904*^9, 
   3.855019420547172*^9}, {3.855101527352971*^9, 3.855101538820469*^9}, 
   3.855101587453023*^9},
 CellLabel->
  "In[322]:=",ExpressionUUID->"dc76892a-5133-449a-8142-daa3f117e220"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"\[ThinSpace]", "\" \"", 
      TemplateBox[{"+", "\"+\"", "G", "W"}, "RowWithSeparators"], 
      OverscriptBox["\[DoubleLongRightArrow]", "0.02`"], 
      TemplateBox[{"+", "\"+\"", "G", "P"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`G, $CellContext`W}, {$CellContext`G, \
$CellContext`P}, 0.02]], ",", 
   InterpretationBox[
    TemplateBox[{"\[ThinSpace]", "\" \"", 
      TemplateBox[{"+", "\"+\"", "G", "P"}, "RowWithSeparators"], 
      OverscriptBox["\[DoubleLongRightArrow]", "1"], 
      TemplateBox[{"+", "\"+\"", "G", "W"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`G, $CellContext`P}, {$CellContext`G, \
$CellContext`W}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{"\[ThinSpace]", "\" \"", 
      TemplateBox[{"+", "\"+\"", "P", "W"}, "RowWithSeparators"], 
      OverscriptBox["\[DoubleLongRightArrow]", "1"], 
      TemplateBox[{"+", "\"+\"", "W", "P"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`P, $CellContext`W}, {$CellContext`W, \
$CellContext`P}, 1]], ",", 
   InterpretationBox[
    TemplateBox[{"\[ThinSpace]", "\" \"", 
      TemplateBox[{"+", "\"+\"", "P", "F"}, "RowWithSeparators"], 
      OverscriptBox["\[DoubleLongRightArrow]", "10"], 
      TemplateBox[{"+", "\"+\"", "F", "F"}, "RowWithSeparators"]},
     "RowWithSeparators"],
    CRNSimulator`rxnl[{$CellContext`P, $CellContext`F}, {$CellContext`F, \
$CellContext`F}, 10]]}], "}"}]], "Output",
 CellChangeTimes->{3.8551013781393414`*^9, 3.8551015399803953`*^9, 
  3.855101589163274*^9},
 CellLabel->
  "Out[325]=",ExpressionUUID->"2847b4b4-3203-4d7f-92da-414d8537e93e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"space2D", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", "DLAcoloring"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time2D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
   3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821666402739387*^9, 
   3.8216664361548443`*^9}, {3.821847159700281*^9, 3.821847173989032*^9}, {
   3.8218557100028763`*^9, 3.821855751741219*^9}, 3.821855792356524*^9, {
   3.8218559241964493`*^9, 3.8218559276879263`*^9}, {3.8218559866120996`*^9, 
   3.8218560397531757`*^9}, {3.821883127575139*^9, 3.8218831340419083`*^9}, {
   3.821883203231083*^9, 3.821883210963731*^9}, {3.821894833691724*^9, 
   3.8218948453692636`*^9}, {3.829315798777371*^9, 3.829315837005123*^9}, {
   3.829315956700979*^9, 3.829315957501523*^9}, {3.829316237820953*^9, 
   3.829316241247119*^9}, {3.8293319951102047`*^9, 3.829331995401763*^9}, {
   3.82933215104847*^9, 3.8293321513064423`*^9}, {3.855017525363668*^9, 
   3.855017529071225*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"1925dcad-e959-463e-b3d8-0146d68c294a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"time2D", "=", "0"}], ";", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.5"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"space2D", "=", 
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"DLAcrn", ",", "space2D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"time2D", "+=", "dt"}]}], ",", "1000"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.82166644256629*^9, 
   3.821666452132885*^9}, 3.821666515815844*^9, {3.82166839068404*^9, 
   3.82166842602209*^9}, {3.821847178235992*^9, 3.821847189020856*^9}, {
   3.821847650881916*^9, 3.821847678627214*^9}, 3.821847903273849*^9, {
   3.821848012199296*^9, 3.821848012650454*^9}, {3.821848608605753*^9, 
   3.821848608876388*^9}, {3.821855776849679*^9, 3.821855787763978*^9}, {
   3.821855820331203*^9, 3.821855917955414*^9}, 3.821855975565772*^9, {
   3.821883253710037*^9, 3.8218832537610807`*^9}, 3.82188666698765*^9, 
   3.821886921149913*^9, 3.821894905177718*^9, {3.829315848004698*^9, 
   3.82931588607215*^9}, {3.829316247700232*^9, 3.8293162504112177`*^9}, {
   3.829331998045542*^9, 3.829332030461441*^9}, {3.855019426048581*^9, 
   3.855019427196273*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"6c6c07a5-a8d1-4b70-a06b-a98282fac32e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", "space2D", ",", "100"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8214941208359423`*^9, 3.821494148838941*^9}, {
   3.821495511260285*^9, 3.821495512708765*^9}, {3.8216687602638893`*^9, 
   3.821668771193119*^9}, {3.821847192780324*^9, 3.821847195763915*^9}, {
   3.821847659364608*^9, 3.8218476756481733`*^9}, {3.829315893763999*^9, 
   3.829315899605915*^9}, 3.829316150535265*^9, {3.829316252214962*^9, 
   3.8293162525134*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"5a0b3850-8b1f-47e4-b108-93fc0311fa8e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"106.892463`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.821494127056902*^9, 3.821494150318115*^9}, 
   3.821495513904023*^9, {3.821668792410816*^9, 3.82166879517176*^9}, 
   3.821668841670136*^9, 3.821847199510709*^9, {3.821847664377255*^9, 
   3.821847676473131*^9}, {3.829316148288684*^9, 3.82931615315164*^9}, 
   3.8293164757185802`*^9, 3.85501767414254*^9},
 CellLabel->
  "Out[488]=",ExpressionUUID->"810c7eb2-0aac-4dad-a868-671a68c82d60"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"Show", "[", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "corner", " ", "points", " ", "keep", " ", "image", " ", "size", " ", 
     "stable"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Point", "/@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Dimensions", "[", "space3D", "]"}], "]"}]}], "}"}], 
          "]"}], "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ArrayPlot3D", "[", 
     RowBox[{
      RowBox[{"space3D", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"W", "->", "0"}], ",", 
         RowBox[{"G", "->", "0"}], ",", 
         RowBox[{"F", "->", "1"}], ",", 
         RowBox[{"P", "->", "2"}]}], "}"}]}], ",", 
      RowBox[{"ColorRules", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "->", "Cyan"}], ",", 
         RowBox[{"2", "->", 
          RowBox[{"Opacity", "[", 
           RowBox[{"0.2", ",", "Gray"}], "]"}]}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"PlotLabel", "->", "time3D"}]}], "\[IndentingNewLine]", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8550176127665777`*^9, 3.855017617719059*^9}, {
  3.8550176482509727`*^9, 3.855017702380815*^9}, {3.855017733840042*^9, 
  3.8550177405618143`*^9}, {3.855017845531068*^9, 3.855017850524968*^9}, {
  3.855018116332951*^9, 3.855018157108411*^9}, {3.85501859445485*^9, 
  3.855018596166419*^9}, {3.855019917203079*^9, 3.855019926202985*^9}, {
  3.855101354164956*^9, 3.855101359580614*^9}, {3.855101401160821*^9, 
  3.855101404534894*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"c48adda4-8294-4559-be4b-b0d9f074252b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"time3D", "=", "0"}], ";", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"space3D", "=", 
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"DLAcrn", ",", "space3D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"time3D", "+=", "dt"}]}], ",", "1000"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.855017869875173*^9, 3.855017880872383*^9}, {
  3.855018624535368*^9, 3.855018624874815*^9}, {3.8550193038576*^9, 
  3.85501930396105*^9}, {3.8550196009071503`*^9, 3.8550196251600237`*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"7494f05f-55b0-4b3d-8990-b0b0019b5b7d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"(*", " ", 
   RowBox[{"just", " ", "the", " ", "frozen", " ", "stuff"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Black", ",", 
      RowBox[{"Point", "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"Reverse", "[", 
            RowBox[{"Dimensions", "[", "space3D", "]"}], "]"}]}], "}"}], 
         "]"}], "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ArrayPlot3D", "[", 
    RowBox[{
     RowBox[{"space3D", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"W", "->", "0"}], ",", 
        RowBox[{"G", "->", "0"}], ",", 
        RowBox[{"F", "->", "1"}], ",", 
        RowBox[{"P", "->", "0"}]}], "}"}]}], ",", 
     RowBox[{"ColorRules", "->", 
      RowBox[{"{", 
       RowBox[{"1", "->", "Cyan"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"PlotLabel", "->", "time3D"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.855018470504342*^9, 3.8550184855325947`*^9}, {
  3.8550185922677517`*^9, 3.855018592317911*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"8bbb160a-2860-4102-9306-fbe8b2d9fb1b"],

Cell["\<\
Admittedly, diffusion-limited aggregation is not so exciting at this small \
scale and with this terribly slow simulation speed.\
\>", "Text",
 CellChangeTimes->{{3.693190355140053*^9, 3.6931903783285*^9}, 
   3.8255513077349243`*^9, {3.825551363633912*^9, 3.8255513658998117`*^9}, {
   3.8255516845526037`*^9, 3.825551690344644*^9}, 3.8255517485644217`*^9, {
   3.825551824699856*^9, 3.825551826274029*^9}, {3.825552250746643*^9, 
   3.8255522525413303`*^9}, 3.825552334020445*^9, {3.825552461262951*^9, 
   3.82555247697919*^9}, {3.825552812528034*^9, 3.82555281373421*^9}, 
   3.825552845110716*^9, {3.825553011902177*^9, 3.825553012306486*^9}, 
   3.825553472942132*^9, 3.8255536353131104`*^9, {3.825553672066284*^9, 
   3.825553673105431*^9}, {3.855020749425642*^9, 3.8550207843686457`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"73a4b586-1deb-46e3-9e3e-f9b8008acff8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Faster simulation of surface CRNs", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 3.8293157428071747`*^9}, {3.855017005397118*^9, 
  3.855017009988099*^9}, {3.855021942800912*^9, 
  3.855021950496773*^9}},ExpressionUUID->"0006252e-fb3f-4378-85ff-\
715e187d5d45"],

Cell[TextData[{
 "The ",
 StyleBox["RunSurfaceCRN",
  FontWeight->"Bold"],
 " simulator is slower than it needs to be.  Although it is a nice \
convenience to represent things symbolically, and the code is relatively \
short and straightforward, it could be faster to utilize numeric arrays and \
efficient data structures that are processed by compiled algorithms.  The \
symbolic nature of the original simulator therefore requires conversion to \
and from an integer representation.  Basically, each species that appears in \
a reaction or in a given initial state (such as inert species) is given a \
number, starting at 1.   \n\nAs for data types, the original symbolic CRN and \
surface state will be distinguished by being Lists, while we will introduce \
new data types for CRNs whose reactions have been pre-processed and for state \
arrays that are being represented numerically.   A key concept will be a \
\[OpenCurlyDoubleQuote]species to index\[CloseCurlyDoubleQuote] map and its \
inverse, the \[OpenCurlyDoubleQuote]index to species\[CloseCurlyDoubleQuote] \
map, that allow us to convert symbolic species names back and forth to \
numbers 1, 2, ... N.  We\[CloseCurlyQuote]ll carry these around with the \
numeric representations of the CRN reactions and the surface state using \
expressions with the head ",
 StyleBox["CompiledSurfaceCRN",
  FontWeight->"Bold"],
 " and ",
 StyleBox["CompiledSurfaceCRNState",
  FontWeight->"Bold"],
 ", respectively; these are returned by ",
 StyleBox["CompileSurfaceCRN[crn,state]",
  FontWeight->"Bold"],
 ".  Note that the species list is extracted from the reactions and the \
initial state, so you can\[CloseCurlyQuote]t use these objects for simulating \
a new initial state that utilizes new species that don\[CloseCurlyQuote]t \
occur in the reactions (e.g. such as inert \[OpenCurlyDoubleQuote]walls\
\[CloseCurlyDoubleQuote]).\n\nConverting a large state back to symbolic \
species names can be slow, and it\[CloseCurlyQuote]s faster to produce \
graphics directly from the numeric representations, so we\[CloseCurlyQuote]ll \
provide code for doing that.  It will work either for original or compiled \
formats.  The original space can be 1D, 2D, or 3D."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.829331821875764*^9, 3.829331853437752*^9}, 
   3.829331926731311*^9, {3.8294283187790537`*^9, 3.829428343589019*^9}, 
   3.855021977116811*^9, {3.855022013164156*^9, 3.855022017334149*^9}, {
   3.855022050253533*^9, 3.855022071436644*^9}, {3.855022117826664*^9, 
   3.855022177559486*^9}, {3.855022229180146*^9, 3.855022298876865*^9}, {
   3.855022335505739*^9, 3.855022396579802*^9}, {3.855022455098399*^9, 
   3.855022484344989*^9}, {3.855023359379945*^9, 3.855023398780442*^9}, {
   3.855023509326144*^9, 3.855023552534791*^9}, 3.8550255356763573`*^9, {
   3.85507878670148*^9, 3.855078786831534*^9}, {3.855080202380967*^9, 
   3.855080261617507*^9}, {3.855080327025504*^9, 3.855080372288897*^9}, {
   3.855080403469281*^9, 3.855080405895404*^9}, {3.855080742443542*^9, 
   3.855080957157855*^9}, {3.85508111509875*^9, 3.855081152948978*^9}, {
   3.855081183290264*^9, 3.855081239378614*^9}, {3.855081272594228*^9, 
   3.855081340541183*^9}, {3.855081407709258*^9, 3.855081458129451*^9}, {
   3.855081627527083*^9, 3.8550816418045673`*^9}, {3.85508923460259*^9, 
   3.855089242576085*^9}, {3.855094654615384*^9, 3.85509470872682*^9}, 
   3.8550948126080923`*^9, {3.8551010517674522`*^9, 3.8551010521954937`*^9}, {
   3.855101092562398*^9, 3.855101124075914*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"3e65a77b-e813-4e50-9241-066683a7fe68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "invisible", " ", "species", " ", "are", " ", "only", " ", "for", " ", "3",
     "D"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ShowSurfaceCRNState", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Invisible\>\"", "->", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"Options", "[", "Show", "]"}], ",", 
       RowBox[{"Options", "[", "ArrayPlot", "]"}], ",", 
       RowBox[{"Options", "[", "ArrayPlot3D", "]"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowSurfaceCRNState", "[", 
     RowBox[{"space_List", ",", "colorrules_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"state", "=", "space"}], ",", "species", ",", "map", ",", 
        "colormap"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Dimensions", "[", "state", "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"state", "=", 
          RowBox[{"{", "state", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Dimensions", "[", "state", "]"}], "]"}], "==", "2"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"ArrayPlot", "[", 
          RowBox[{"state", ",", 
           RowBox[{"ColorRules", "\[Rule]", "colorrules"}], ",", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{"Options", "[", "ArrayPlot", "]"}]}], "]"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ArrayPlot3D", " ", "seems", " ", "to", " ", "require", " ", "a", 
            " ", "numeric", " ", "array"}], ",", " ", 
           RowBox[{"with", " ", "0", " ", "being", " ", "invisible"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"species", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "state", "]"}], "]"}]}], ";", 
          RowBox[{"map", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{"species", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "species", "]"}], "]"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colormap", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "species", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "colorrules"}], ")"}], "&"}], "/@", 
                "species"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"map", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "->", "0"}], ")"}], "&"}], "/@", 
              RowBox[{"OptionValue", "[", "\"\<Invisible\>\"", "]"}]}], ",", 
             "map"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Dimensions", "[", "state", "]"}], "]"}]}], "}"}],
                   "]"}], "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ArrayPlot3D", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "map"}], ")"}], "&"}], ",", "state", ",", 
                RowBox[{"{", "3", "}"}]}], "]"}], ",", 
              RowBox[{"ColorRules", "->", "colormap"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", 
              RowBox[{"Options", "[", "ArrayPlot3D", "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowSurfaceCRNState", "[", 
     RowBox[{
      RowBox[{"CompiledSurfaceCRNState", "[", 
       RowBox[{"space_", ",", "index2species_", ",", "species2index_"}], 
       "]"}], ",", "colorrules_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"colormap", ",", "emptymap", ",", "state"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"colormap", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Last", "[", "#", "]"}], "/.", "colorrules"}], ")"}]}],
             ")"}], "&"}], ",", "index2species"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Dimensions", "[", "space", "]"}], "]"}], "==", "1"}], 
          ",", 
          RowBox[{"{", "space", "}"}], ",", "space"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Dimensions", "[", "space", "]"}], "]"}], "<", "3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ArrayPlot", "[", 
          RowBox[{"space", ",", 
           RowBox[{"ColorRules", "\[Rule]", "colormap"}], ",", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{"Options", "[", "ArrayPlot", "]"}]}], "]"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"emptymap", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/.", "species2index"}], ")"}], "->", "0"}], 
              ")"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "\"\<Invisible\>\"", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics3D", "[", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Dimensions", "[", "space", "]"}], "]"}]}], "}"}],
                   "]"}], "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ArrayPlot3D", "[", 
             RowBox[{
              RowBox[{"space", "/.", "emptymap"}], ",", 
              RowBox[{"ColorRules", "->", "colormap"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", 
              RowBox[{"Options", "[", "ArrayPlot3D", "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.823128391518244*^9, 3.823128482674891*^9}, {
   3.823128765658414*^9, 3.8231288942711477`*^9}, {3.8231290605678062`*^9, 
   3.8231290637210903`*^9}, {3.823129569793457*^9, 3.823129636643098*^9}, {
   3.8231302991136103`*^9, 3.8231303040517282`*^9}, {3.823130377135309*^9, 
   3.823130382499188*^9}, {3.823130484398272*^9, 3.8231306016633368`*^9}, {
   3.823130647525917*^9, 3.823130655129342*^9}, {3.823130984833259*^9, 
   3.823131064131222*^9}, {3.823131169342651*^9, 3.823131171389268*^9}, {
   3.823131768104731*^9, 3.823131771972237*^9}, {3.823132292875865*^9, 
   3.8231323011341476`*^9}, {3.8231323331071863`*^9, 3.823132364958527*^9}, 
   3.8232260664274282`*^9, {3.826499190466887*^9, 3.826499215106249*^9}, {
   3.8264994886717987`*^9, 3.8264995901728487`*^9}, {3.826500071525817*^9, 
   3.826500095834996*^9}, {3.8265001434699163`*^9, 3.826500160704048*^9}, {
   3.826500210600709*^9, 3.8265003324227467`*^9}, {3.826500388101871*^9, 
   3.826500416506468*^9}, {3.826500501690151*^9, 3.826500507461443*^9}, 
   3.826500543047386*^9, {3.829332560601653*^9, 3.829332561416628*^9}, {
   3.829334663561602*^9, 3.829334714493935*^9}, {3.8293349329734707`*^9, 
   3.829334939581395*^9}, 3.829336799572583*^9, {3.8550816059983597`*^9, 
   3.8550816155325623`*^9}, {3.855082062254426*^9, 3.855082074021235*^9}, {
   3.855082118124893*^9, 3.8550821477598543`*^9}, 3.855082180448023*^9, {
   3.855082298946473*^9, 3.855082462565475*^9}, {3.855082500596685*^9, 
   3.855082534339592*^9}, {3.8550826667816877`*^9, 3.855082672355708*^9}, {
   3.855082775866794*^9, 3.8550828517726097`*^9}, {3.8550828826020527`*^9, 
   3.855082919603634*^9}, {3.855083017830739*^9, 3.8550830520851727`*^9}, {
   3.8550833506665*^9, 3.855083399380561*^9}, {3.855083831492312*^9, 
   3.855083845401026*^9}, {3.8550841636681757`*^9, 3.855084172184272*^9}, {
   3.855084252518908*^9, 3.855084279766883*^9}, 3.8550843450472107`*^9, {
   3.855084671543045*^9, 3.855084673885828*^9}, {3.855084740846704*^9, 
   3.855084779371697*^9}, {3.855084833962304*^9, 3.855084850959063*^9}, {
   3.855084922495811*^9, 3.8550850002289677`*^9}, {3.855085035078352*^9, 
   3.8550850753668833`*^9}, 3.8550851232679987`*^9, {3.855085434597275*^9, 
   3.855085556145403*^9}, {3.855085996979113*^9, 3.855086006318038*^9}, {
   3.85508605265775*^9, 3.855086060606968*^9}, {3.855086119799066*^9, 
   3.855086172739914*^9}, {3.855086208092811*^9, 3.8550862268182497`*^9}, {
   3.855086302737238*^9, 3.8550863369517603`*^9}, 3.85508639054685*^9, {
   3.8550864322178593`*^9, 3.855086449309546*^9}, 3.855087515890512*^9, {
   3.855087561351513*^9, 3.855087869256331*^9}, {3.8550882027859917`*^9, 
   3.855088202948209*^9}, {3.855088253548461*^9, 3.855088301900888*^9}, {
   3.8550883414242163`*^9, 3.855088345481*^9}, {3.855088895679303*^9, 
   3.8550889118436203`*^9}, {3.8550909443057327`*^9, 
   3.8550909472731667`*^9}, {3.8550951493377733`*^9, 3.855095162583362*^9}, {
   3.855095475574258*^9, 3.855095478817039*^9}, {3.8550956389331713`*^9, 
   3.855095644008107*^9}, {3.8550957635313168`*^9, 3.855095766638825*^9}, {
   3.855096083689002*^9, 3.855096172502376*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"394366a2-78be-4bf8-afcf-2b08f32e4483"],

Cell[TextData[{
 "The compiled data structures are, loosely:\n\t",
 StyleBox["CompiledSurfaceCRN[unistoch,unirate,uniindex,bistoch,birate,\
biindex,ind2spec,spec2ind]",
  FontWeight->"Bold"],
 "\n\t",
 StyleBox["CompiledSurfaceCRNState[numericstate,ind2spec,spec2ind]",
  FontWeight->"Bold"],
 "\nwhere the biindex is a matrix of size ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "611e7218-dfc1-4172-9d18-223d87526fee"],
 " if the CRN has ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f34d124b-903d-4e08-9616-ca04840468d5"],
 " species, so be warned about trying this out for a CRN with gobs of species."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.829331821875764*^9, 3.829331853437752*^9}, 
   3.829331926731311*^9, {3.8294283187790537`*^9, 3.829428343589019*^9}, 
   3.855021977116811*^9, {3.855022013164156*^9, 3.855022017334149*^9}, {
   3.855022050253533*^9, 3.855022071436644*^9}, {3.855022117826664*^9, 
   3.855022177559486*^9}, {3.855022229180146*^9, 3.855022298876865*^9}, {
   3.855022335505739*^9, 3.855022396579802*^9}, {3.855022455098399*^9, 
   3.855022484344989*^9}, {3.855023359379945*^9, 3.855023398780442*^9}, {
   3.855023509326144*^9, 3.855023552534791*^9}, 3.8550255356763573`*^9, {
   3.85507878670148*^9, 3.855078786831534*^9}, {3.855080202380967*^9, 
   3.855080261617507*^9}, {3.855080327025504*^9, 3.855080372288897*^9}, {
   3.855080403469281*^9, 3.855080405895404*^9}, {3.855080742443542*^9, 
   3.855080957157855*^9}, {3.85508111509875*^9, 3.855081152948978*^9}, {
   3.855081183290264*^9, 3.855081239378614*^9}, {3.855081272594228*^9, 
   3.855081340541183*^9}, {3.855081407709258*^9, 3.855081417571541*^9}, {
   3.8550815723301287`*^9, 3.855081575151244*^9}, {3.8550898242704067`*^9, 
   3.855089910772635*^9}, {3.855089963373115*^9, 3.855089981043099*^9}, {
   3.855095101779228*^9, 3.855095103189987*^9}, 3.855100955552153*^9, {
   3.8551009883681726`*^9, 3.855100989117387*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"7377637c-05c4-4d46-85d3-0a78b33b15a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeState3D", "[", "state_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", "state", "]"}], "]"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", "state", "}"}], "}"}], ",", "2", ",", 
     RowBox[{"{", "state", "}"}], ",", "3", ",", "state"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"crn_List", ",", "space_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scrn", "=", 
        RowBox[{"Sort", "[", "crn", "]"}]}], ",", 
       RowBox[{"dims", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Dimensions", "[", "space", "]"}], "]"}]}], ",", "species", 
       ",", "species2index", ",", "index2species", ",", "\[IndentingNewLine]",
        "unirules", ",", "birules", ",", "bireactions", ",", "birates", ",", 
       "biindex", ",", "unireactions", ",", "unirates", ",", "uniindex"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"species", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SpeciesInRxnsys", "[", "scrn", "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "space", "]"}], "]"}], ",", 
           RowBox[{"SpeciesInRxnsys", "[", "scrn", "]"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"species2index", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"species", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"index2species", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}], ",", "species"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"birules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"crn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rxnl", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a_", ",", "b_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c_", ",", "d_"}], "}"}], ",", "k_"}], "]"}], ":>", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "->", 
              RowBox[{"{", 
               RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], 
         ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "birules"}]}], ";", 
      RowBox[{"birates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "birules"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"biindex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "species", "]"}], ",", 
         RowBox[{"Length", "[", "species", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"biindex", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"bireactions", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"bireactions", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
         "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "bireactions", "]"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"unirules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"crn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rxnl", "[", 
             RowBox[{
              RowBox[{"{", "a_", "}"}], ",", 
              RowBox[{"{", "b_", "}"}], ",", "k_"}], "]"}], ":>", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "a", "}"}], "->", 
              RowBox[{"{", 
               RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}], "}"}]}], ",", 
         "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"unireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "/.", "species2index"}],
            ",", 
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "unirules"}]}], ";", 
      RowBox[{"unirates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "unirules"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"uniindex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "species", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"uniindex", "[", 
          RowBox[{"[", 
           RowBox[{"unireactions", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", "i"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "unireactions", "]"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CompiledSurfaceCRN", "[", 
         RowBox[{
          RowBox[{"unireactions", "~", "Join", "~", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ",", "unirates", ",", 
          "uniindex", ",", 
          RowBox[{"bireactions", "~", "Join", "~", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], ",",
           "birates", ",", "biindex", ",", "index2species", ",", 
          "species2index"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CompiledSurfaceCRNState", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "/.", "species2index"}], ")"}], "&"}], ",", 
            "space", ",", 
            RowBox[{"{", "dims", "}"}]}], "]"}], ",", "index2species", ",", 
          "species2index"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RevertSurfaceCRNState", "[", 
   RowBox[{"CompiledSurfaceCRNState", "[", 
    RowBox[{"space_", ",", "index2species_", ",", "species2index_"}], "]"}], 
   "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dims", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "space", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/.", "index2species"}], ")"}], "&"}], ",", "space", ",", 
      RowBox[{"{", "dims", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8274513485122147`*^9, 3.827451395952838*^9}, {
   3.827451700344174*^9, 3.827452054169599*^9}, {3.827452097987815*^9, 
   3.8274522896352386`*^9}, {3.8274523424724283`*^9, 3.827452483439533*^9}, {
   3.827452999912855*^9, 3.827453061682334*^9}, 3.827453336321184*^9, {
   3.82745408866516*^9, 3.827454106812829*^9}, {3.8274541467466993`*^9, 
   3.827454244423703*^9}, {3.827454574720418*^9, 3.827454581446801*^9}, {
   3.829313650554076*^9, 3.829313671529771*^9}, {3.8293137103569403`*^9, 
   3.829313757496499*^9}, {3.8293137922592773`*^9, 3.829313806960951*^9}, {
   3.829350847844095*^9, 3.829350848238134*^9}, {3.8293509286415586`*^9, 
   3.829350929088077*^9}, {3.829350974376589*^9, 3.829351057321336*^9}, {
   3.829351288878388*^9, 3.82935130093359*^9}, {3.829351340446766*^9, 
   3.829351357156369*^9}, {3.8293513933611917`*^9, 3.829351409407571*^9}, {
   3.829351450309284*^9, 3.8293515474887466`*^9}, {3.829351592938422*^9, 
   3.829351651693935*^9}, {3.829351957945962*^9, 3.8293519652950897`*^9}, {
   3.829352057256365*^9, 3.829352165363657*^9}, {3.829352469396199*^9, 
   3.829352471766683*^9}, {3.829353569459014*^9, 3.82935359151077*^9}, {
   3.829398022649732*^9, 3.829398035821377*^9}, {3.8294322236616087`*^9, 
   3.829432230219495*^9}, {3.829520043199326*^9, 3.829520044790064*^9}, {
   3.82952009520619*^9, 3.829520095935566*^9}, {3.829765276002825*^9, 
   3.82976538209475*^9}, {3.8297657454898252`*^9, 3.8297658361590347`*^9}, {
   3.829765868968651*^9, 3.829765915988202*^9}, {3.82976597496924*^9, 
   3.829766125249482*^9}, {3.829769893688188*^9, 3.8297699664140863`*^9}, {
   3.8297700430055304`*^9, 3.8297700471936693`*^9}, {3.83332863825578*^9, 
   3.833328658666793*^9}, {3.8550889974552383`*^9, 3.855089010515964*^9}, {
   3.855089053845819*^9, 3.855089197724503*^9}, {3.855089286587079*^9, 
   3.855089314270506*^9}, {3.8550893789927464`*^9, 3.855089425992132*^9}, {
   3.855089589367988*^9, 3.85508964953677*^9}, {3.855089693888788*^9, 
   3.855089790448813*^9}, {3.855090269470778*^9, 3.855090307162334*^9}, 
   3.8550903971604548`*^9, {3.855094825135903*^9, 3.855094897350637*^9}, {
   3.855094938407913*^9, 3.85509497458391*^9}, {3.855095018354047*^9, 
   3.855095049795725*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"44dcd3fc-9498-4125-8c06-127731aa044a"],

Cell[TextData[{
 "Once the surface CRN reactions and initial state have been \
\[OpenCurlyDoubleQuote]compiled\[CloseCurlyDoubleQuote], we will still use ",
 StyleBox["RunSurfaceCRN",
  FontWeight->"Bold"],
 " and ",
 StyleBox["InfoRunSurfaceCRN",
  FontWeight->"Bold"],
 " as before (but with the modified semantics that the later reports the time \
of the last reaction, if the system halts).  We keep the original symbolic \
simulator code in place, and just define new cases for these operators that \
will apply if their arguments are compiled."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.8294283894021463`*^9, 3.829428501749867*^9}, {
   3.829428539375613*^9, 3.8294286642718363`*^9}, {3.829429041331896*^9, 
   3.829429049469315*^9}, {3.829429085556971*^9, 3.829429125587332*^9}, {
   3.829429325852194*^9, 3.8294293387162657`*^9}, {3.829429385914792*^9, 
   3.829429446359996*^9}, {3.829429536404969*^9, 3.829429582468526*^9}, {
   3.855101006978961*^9, 3.85510100729453*^9}, 3.855101046108471*^9, {
   3.8551011469642344`*^9, 3.855101285467767*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"bf90d076-cb29-4115-8e82-c616857a90a7"],

Cell[TextData[{
 "The original simulator takes the basic strategy of choosing a site or pair \
of sites, and executing a reaction with probability appropriate to its rate \
constant -- that means if there are some fast reactions and some slow \
reactions, then sites where slow reactions could occur will be tried bunches \
of times before being executed (because the trial rate is related to the \
fastest reaction rate).  Also, if some sites in the space can be active, but \
other sites are inactive, the simulator will nonetheless spend its time \
equally testing and re-testing the inactive area.  The compiled simulator \
takes an entirely different strategy: keep a data structure up-to-date that \
gives the total propensity of possible reactions at each site and each pair \
of neighbors, all organized into a binary tree such that the next reaction \
can be chosen probabilistically by quickly traversing the tree.  From the \
user\[CloseCurlyQuote]s perspective, though, it looks pretty darn similar to \
the previous simulator, just faster.   The main thing to watch out for is \
that this new simulator uses a species vs species lookup table, which takes \
memory quadratic in the number of species (whereas only linear costs appear \
in the previous two simulators) and thus will be problematic for systems with \
many thousands of species.\n\nPrinciples, in more detail:\n1.  No rejection.  \
We won\[CloseCurlyQuote]t look at sites unless there is something to do \
there.\n2.  Log-time site/pair selection.  By tracking the total propensity \
for localized reactions and storing in a binary tree with hierarchical sums, \
we select a site in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"log", 
    RowBox[{"(", 
     RowBox[{"d", " ", "n", " ", "m"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0797211c-2abe-461a-82e3-352e95ea8be5"],
 " time.\n\tlet ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "K"], " ", ">", " ", 
    RowBox[{"7", " ", "d", " ", "n", " ", "m"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d0ff4ca4-f140-4dc7-882f-9abb546a2ae5"],
 ".  we allocate an array of length ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", 
    RowBox[{"K", "+", "1"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "467e03af-6ea6-470f-a460-fdfce83cdb75"],
 ".\n\tunimolecular reactions at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "j", ",", "k"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ffab6e81-25a8-4419-869b-9e5c38fb4540"],
 " have ID ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "K"], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], " ", "+", " ", 
    RowBox[{"(", 
     RowBox[{"k", "-", "1"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c99feb75-e287-4cc2-9557-a43320c692e8"],
 ".\n\tbimolecular reactions involving ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "j", ",", "k"}], ")"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b338196f-3090-4c4e-a1e9-72d3ac5b7649"],
 " and neighbor #b have ID ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "K"], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], " ", "+", " ", 
    RowBox[{"(", 
     RowBox[{"k", "-", "1"}], ")"}], " ", "+", " ", 
    RowBox[{"b", "*", "d", "*", "n", "*", "m"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "af654672-3101-4b70-a0a0-417a7e1c0fdc"],
 ".\n\trate[1] is the grant total propensity, and rate[id] := \
rate[2*id]+rate[2*id+1] for id < ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "K"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5a075035-84dd-46c2-8206-7df70898cef8"],
 ".\n3.  Fast reaction selection.  Comes at the cost of burning memory (1000 \
species costs 8 MB, grows as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["S", "S"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0933497c-59c6-4758-b756-dc4ea8da40cb"],
 ", for ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1529228a-864a-4180-91f4-65fc406173fb"],
 " species and ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "289af486-9041-413d-a68e-be32393e05ee"],
 " reactions).\n\tunimolecular and bimolecular reactions are kept in arrays \
as before, but now they are sorted by reactants, \n\t\tand additionally we \
have uniindex[s] and biindex[s1,s2] that point into the reaction arrays or \
are 0.\n\t\tsince the reaction arrays are sorted, if there are multiple \
reactions possible for given reactants, they are all together and can quickly \
be scanned.\n4.  Fast data structure maintenance. After each changed site, \
the site and its 6 neighbors need to have their rates recomputed and \
propagated up the tree. \n\tto compute the local rate when an ID gets \
updated, we use uniindex[s] and biindex[s1,s2] to quickly tallly all possible \
reactions.\n\tto maintain consistency of the hierarchical rates, whenever an \
ID gets updated, we iterate:  id=(id>>1), update rate[id], until id==1.\n\t"
}], "Text",
 CellChangeTimes->CompressedData["
1:eJwdzk9Ik3EAh/ExyCx1ycxcYiPDbLP3UDPRIsS3pEiWh2F4SMpMJ7XhRAxU
Bo3Y0qyM/tFmwx1aOobYNhFNdL0lKDQ3m2MNbIU6cZIv2ax2sNz6fXd4+Fyf
3DqVrIHL4XDEJGixJv8Mt7E0Q0cjUEpVRuFsXktCntEa47ezdNnCODeDuE8/
cRgau+Vi2DE/qICvc7eVsFYbyi8hZj50i2HB6KS/lNjYEwrA067IcxXR7Dvy
AjLcGq2vk6UNmxe7oKZAfcJP7C3cXQT3Ns1LId9mq4Tf7j6eChCPBi3TMEfQ
MbFEbH6QNwlPZZS/h5Qx7oNnDN4gbKPU6zC+fuA35DtEUWjqo7ag7NbHpGXi
v/P9KXAzu3M/rGn5+hRqWuVW2LdmG4LNccUbeM65OgLLdcnv4NjtXYIQ0XNl
5iAc/8STwPpjJcVQLfqjWSVmTd98BkMGQS9MrdAOQ3WFawPKGX/CDd7nS2Gi
c27tGvwhn2qEwg+pShi+zt6B/F+ubmh23H8E7VfdT2CPcEQPq/q9CccUSyb4
yvTFDNO8ZfdiRF3WQELlwKJ+Txf5l9x4CdMZmR2unLw8DEUp1Cg8FJTMwONF
Kjesqiv1wLPVQh90BmoX4NY2swL1O5cjcFGXY0kntjou2OGQNPZ3x1uW/u6p
FyQR/wPUFm3w
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"7a836ce4-bbec-4ae2-8bce-30ab2d9778bf"],

Cell["\<\
We need a little bit of wrapper code that packs and unpacks numeric arrays \
for the compiled numeric simulator engine that is defined further below.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.8294283894021463`*^9, 3.829428501749867*^9}, {
   3.829428539375613*^9, 3.8294286642718363`*^9}, {3.829429041331896*^9, 
   3.829429049469315*^9}, {3.829429085556971*^9, 3.829429125587332*^9}, {
   3.829429325852194*^9, 3.8294293387162657`*^9}, {3.829429385914792*^9, 
   3.829429446359996*^9}, {3.829429536404969*^9, 3.829429582468526*^9}, {
   3.855101006978961*^9, 3.85510100729453*^9}, 3.855101046108471*^9, {
   3.8551011469642344`*^9, 3.855101285467767*^9}, {3.855102174973713*^9, 
   3.855102213012179*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"695b1818-b847-48c7-9762-4262b506952d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"ignore", " ", "the", " ", "time", " ", "stamp"}], ",", " ", 
    RowBox[{"event", " ", "count"}], ",", " ", 
    RowBox[{"and", " ", "halted", " ", "indicator", " ", 
     RowBox[{"(", 
      RowBox[{"ArrayReshape", " ", "truncates", " ", "extra", " ", "info"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RunSurfaceCRN", "[", 
     RowBox[{"crn_CompiledSurfaceCRN", ",", 
      RowBox[{"CompiledSurfaceCRNState", "[", 
       RowBox[{"space_", ",", "index2species_", ",", "species2index_"}], 
       "]"}], ",", "dt_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"CompiledSurfaceCRNState", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"EngineSurfaceCRN", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"MakeState3D", "[", "space", "]"}], "}"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"List", "@@", "crn"}], ",", 
             RowBox[{"-", "2"}]}], "]"}], ",", 
           RowBox[{"{", "dt", "}"}]}], "]"}]}], ",", 
        RowBox[{"Dimensions", "[", "space", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "index2species", ",", "species2index"}], "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"report", " ", "the", " ", "time", " ", "stamp"}], ",", " ", 
     RowBox[{"event", " ", "count"}], ",", " ", 
     RowBox[{"and", " ", "halted", " ", "indicator"}], ",", " ", 
     RowBox[{
     "along", " ", "with", " ", "the", " ", "final", " ", "space", " ", 
      "configuration"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InfoRunSurfaceCRN", "[", 
     RowBox[{"crn_CompiledSurfaceCRN", ",", 
      RowBox[{"CompiledSurfaceCRNState", "[", 
       RowBox[{"space_", ",", "index2species_", ",", "species2index_"}], 
       "]"}], ",", "dt_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "info", ",", "tfinal", ",", " ", "eventcount", ",", "haltedq", ",", 
        "digs", ",", "newstate"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"info", "=", 
        RowBox[{"EngineSurfaceCRN", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"MakeState3D", "[", "space", "]"}], "}"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"List", "@@", "crn"}], ",", 
             RowBox[{"-", "2"}]}], "]"}], ",", 
           RowBox[{"{", "dt", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"haltedq", "=", 
        RowBox[{"info", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eventcount", "=", 
        RowBox[{"info", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"digs", "=", 
        RowBox[{"info", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "22"}], ",", 
            RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tfinal", "=", 
        RowBox[{"N", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{"digs", " ", "*", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "i"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "digs", "]"}], "-", "1"}]}], "}"}]}], 
             "]"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newstate", "=", 
        RowBox[{"CompiledSurfaceCRNState", "[", 
         RowBox[{
          RowBox[{"ArrayReshape", "[", 
           RowBox[{"info", ",", 
            RowBox[{"Dimensions", "[", "space", "]"}]}], "]"}], ",", 
          "index2species", ",", "species2index"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tfinal", ",", "eventcount", ",", 
           RowBox[{"haltedq", "===", "1"}]}], "}"}], ",", "newstate"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8274513485122147`*^9, 3.827451395952838*^9}, {
   3.827451700344174*^9, 3.827452054169599*^9}, {3.827452097987815*^9, 
   3.8274522896352386`*^9}, {3.8274523424724283`*^9, 3.827452483439533*^9}, {
   3.827452999912855*^9, 3.827453061682334*^9}, 3.827453336321184*^9, {
   3.82745408866516*^9, 3.827454106812829*^9}, {3.8274541467466993`*^9, 
   3.827454244423703*^9}, {3.827454574720418*^9, 3.827454581446801*^9}, {
   3.829313650554076*^9, 3.829313671529771*^9}, {3.8293137103569403`*^9, 
   3.829313757496499*^9}, {3.8293137922592773`*^9, 3.829313806960951*^9}, {
   3.829350847844095*^9, 3.829350848238134*^9}, {3.8293509286415586`*^9, 
   3.829350929088077*^9}, {3.829350974376589*^9, 3.829351057321336*^9}, {
   3.829351288878388*^9, 3.82935130093359*^9}, {3.829351340446766*^9, 
   3.829351357156369*^9}, {3.8293513933611917`*^9, 3.829351409407571*^9}, {
   3.829351450309284*^9, 3.8293515474887466`*^9}, {3.829351592938422*^9, 
   3.829351651693935*^9}, {3.829351957945962*^9, 3.8293519652950897`*^9}, {
   3.829352057256365*^9, 3.829352165363657*^9}, {3.829352469396199*^9, 
   3.829352471766683*^9}, {3.829353569459014*^9, 3.82935359151077*^9}, {
   3.829398022649732*^9, 3.829398035821377*^9}, {3.8294322236616087`*^9, 
   3.829432230219495*^9}, {3.829520043199326*^9, 3.829520044790064*^9}, {
   3.82952009520619*^9, 3.829520095935566*^9}, {3.829765276002825*^9, 
   3.82976538209475*^9}, {3.8297657454898252`*^9, 3.8297658361590347`*^9}, {
   3.829765868968651*^9, 3.829765915988202*^9}, {3.82976597496924*^9, 
   3.829766125249482*^9}, {3.829769893688188*^9, 3.8297699664140863`*^9}, {
   3.8297700430055304`*^9, 3.8297700471936693`*^9}, {3.83332863825578*^9, 
   3.833328658666793*^9}, {3.855090113574617*^9, 3.855090211547024*^9}, {
   3.855090242014489*^9, 3.8550902441815453`*^9}, {3.8550903890472403`*^9, 
   3.8550903907480164`*^9}, {3.855090470129525*^9, 3.8550904975786324`*^9}, {
   3.855090552085187*^9, 3.8550905534467583`*^9}, {3.855090798995233*^9, 
   3.8550909073586073`*^9}, {3.855093687946127*^9, 3.855093689248519*^9}, {
   3.855093750237122*^9, 3.8550937519092607`*^9}, {3.855095069885008*^9, 
   3.8550951098191233`*^9}, {3.855095240734614*^9, 3.855095274993524*^9}, {
   3.855100680210964*^9, 3.855100684305793*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"a7776f5a-2c6a-417f-befc-d16728d9f5c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EngineNeighbors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"+", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EngineNeighborNeighbor", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5"}], "}"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "if", " ", "the", " ", "code", " ", "below", " ", "looks", " ", 
       "unnecessarily", " ", "repetitive"}], "..."}], " ", "yes"}], ",", " ", 
    
    RowBox[{
     RowBox[{
      RowBox[{"it", " ", "is"}], "..."}], " ", "I", " ", 
     RowBox[{"don", "'"}], "t", " ", "know", " ", "how", " ", "to", " ", 
     "get", " ", "subfunctions", " ", "to", " ", "play", " ", "nicely", " ", 
     "with", " ", 
     RowBox[{"Mathematica", "'"}], "s", " ", "compiler"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"remove", " ", "the", " ", "debugging", " ", "test"}], "-", 
    RowBox[{"print", " ", "statements", " ", "after", " ", 
     RowBox[{"it", "'"}], "s", " ", "been", " ", "tried", " ", "out", " ", 
     "on", " ", "enough", " ", "examples"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EngineSurfaceCRN", "=", " ", 
  RowBox[{"Compile", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"space", ",", "_Integer", ",", "3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"unireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"unirates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"uniindex", ",", "_Integer", ",", "1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"bireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"birates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"biindex", ",", "_Integer", ",", "2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tmax", ",", "_Real"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "space", "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",", "d1", 
        ",", "d2", ",", "n1", ",", "n2", ",", "m1", ",", "m2", ",", 
        RowBox[{"S", "=", "space"}], ",", "R", ",", "id", ",", "idd", ",", 
        "K", ",", "\[IndentingNewLine]", "nb", ",", "nbnb", ",", "i", ",", 
        "j", ",", "k", ",", "i2", ",", "j2", ",", "k2", ",", "di", ",", "dj", 
        ",", "dk", ",", "r", ",", 
        RowBox[{"s1", "=", "1"}], ",", 
        RowBox[{"s2", "=", "1"}], ",", "snb", ",", "new1", ",", "new2", ",", 
        "ksum", ",", "newp", ",", 
        RowBox[{"t", "=", "0.0"}], ",", "dt", ",", 
        RowBox[{"events", "=", "0"}], ",", "haltedq", ",", "digit", ",", 
        "digits", ",", "residue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"1", "+", 
            RowBox[{"7", " ", "d", " ", "n", " ", "m"}]}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"K", "+", "1"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "1"}], ":", " ", 
         RowBox[{
         "build", " ", "the", " ", "rate", " ", "tree", " ", "R", " ", "as", 
          " ", "quickly", " ", "as", " ", 
          RowBox[{"possible", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "because", " ", "Compile", " ", "only", " ", "lets", " ", "us", " ", 
          "output", " ", "one", " ", "array"}], ",", " ", 
         RowBox[{
         "Mathematica", " ", "makes", " ", "it", " ", "awkward", " ", "for", 
          " ", "us", " ", "to", " ", "return", " ", "the", " ", "updated", 
          " ", "rate", " ", 
          RowBox[{"tree", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "if", " ", "this", " ", "requires", " ", "just", " ", "2", " ", 
          "times", " ", "the", " ", "number", " ", "of", " ", "sites", " ", 
          "updates"}], ",", " ", 
         RowBox[{
         "it", " ", "will", " ", "still", " ", "be", " ", "faster", " ", 
          "than", " ", "a", " ", "simulation", " ", "that", " ", "touches", 
          " ", "every", " ", 
          RowBox[{"site", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"uniindex", "[", 
            RowBox[{"[", 
             RowBox[{"S", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}], 
            "]"}]}], ";", 
          RowBox[{"id", "=", 
           RowBox[{
            RowBox[{"2", "^", "K"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
            RowBox[{"(", 
             RowBox[{"k", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"r", ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"unireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "id", "]"}], "]"}], "+=", 
              RowBox[{"unirates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"r", "++"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "d"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "m"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
           RowBox[{"EngineNeighbors", "[", 
            RowBox[{"[", "nb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"d1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "di"}]}], "]"}]}], ";", 
          RowBox[{"d2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"d", ",", 
             RowBox[{"d", "-", "di"}]}], "]"}]}], ";", 
          RowBox[{"n1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "dj"}]}], "]"}]}], ";", 
          RowBox[{"n2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"n", ",", 
             RowBox[{"n", "-", "dj"}]}], "]"}]}], ";", 
          RowBox[{"m1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "dk"}]}], "]"}]}], ";", 
          RowBox[{"m2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"m", ",", 
             RowBox[{"m", "-", "dk"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "=", 
              RowBox[{"biindex", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "]"}], 
               "]"}]}], ";", 
             RowBox[{"id", "=", 
              RowBox[{
               RowBox[{"2", "^", "K"}], "+", 
               RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"r", ">", "0"}], "&&", 
                RowBox[{
                 RowBox[{"bireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "}"}]}]}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "+=", 
                 RowBox[{"birates", "[", 
                  RowBox[{"[", "r", "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "d1", ",", "d2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "n1", ",", "n2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "m1", ",", "m2"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "id", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"2", "id"}], "]"}], "]"}], "+", 
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"id", ",", 
           RowBox[{
            RowBox[{"2", "^", "K"}], "-", "1"}], ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "2"}], ":", " ", 
         RowBox[{"run", " ", "the", " ", 
          RowBox[{"simulation", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "<", "tmax"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"(*", " ", "when", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dt", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"RandomReal", "[", "]"}], "]"}]}], "/", 
            RowBox[{"R", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "+", "dt"}], "<", "tmax"}], ",", 
            RowBox[{
             RowBox[{"t", "+=", "dt"}], ";", 
             RowBox[{"events", "++"}]}], ",", 
            RowBox[{
             RowBox[{"t", "=", "tmax"}], ";", " ", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"don", "'"}], "t", " ", "execute", " ", "any", " ", 
            "event", " ", "past", " ", "tmax"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "what", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"id", "=", "1"}], ";", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"id", "<", 
             RowBox[{"2", "^", "K"}]}], ",", 
            RowBox[{"id", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "*", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}]}], "<", 
                RowBox[{"R", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "id"}], "]"}], "]"}]}], ",", 
               RowBox[{"2", "id"}], ",", 
               RowBox[{
                RowBox[{"2", "id"}], "+", "1"}]}], "]"}]}]}], "]"}], ";", " ", 
          RowBox[{"idd", "=", "id"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idd", "-=", 
           RowBox[{"2", "^", "K"}]}], ";", 
          RowBox[{"nb", "=", 
           RowBox[{"Quotient", "[", 
            RowBox[{"idd", ",", 
             RowBox[{"d", " ", "n", " ", "m"}]}], "]"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{"nb", " ", "d", " ", "n", " ", "m"}]}], ";", " ", 
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{"idd", ",", 
              RowBox[{"n", " ", "m"}]}], "]"}], "+", "1"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}]}], ";", " ", 
          RowBox[{"j", "=", 
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{"idd", ",", "m"}], "]"}], "+", "1"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "m"}]}], ";", 
          RowBox[{"k", "=", 
           RowBox[{"idd", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{
                RowBox[{"1", "\[LessEqual]", "i", "\[LessEqual]", "d"}], "&&", 
                RowBox[{"1", "\[LessEqual]", "j", "\[LessEqual]", "n"}], "&&", 
                RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "m"}]}], 
               "]"}], ",", 
              RowBox[{"Print", "[", "\"\<bad loc!\>\"", "]"}]}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"0", "\[LessEqual]", "nb", "\[LessEqual]", "6"}], 
               "]"}], ",", 
              RowBox[{"Print", "[", "\"\<bad neighbor!\>\"", "]"}]}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"location", " ", 
            RowBox[{"found", ".", "  ", "now"}], " ", "choose", " ", "the", 
            " ", "reaction", " ", "and", " ", "execute", " ", "the", " ", 
            "change", " ", "and", " ", "update", " ", "the", " ", "rate", " ", 
            RowBox[{"tree", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nb", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", " ", "unimolecular"}]}]}]}]}], " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"move", " ", "--"}], "--"}], "--"}], "--"}]}], 
              "-"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"s1", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ";", " ", 
             RowBox[{"r", "=", 
              RowBox[{"uniindex", "[", 
               RowBox[{"[", "s1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r", "\[Equal]", "0"}], ",", 
                 RowBox[{"Print", "[", "\"\<unibad!\>\"", "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"newp", "=", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"[", "id", "]"}], "]"}]}]}], ";", 
             RowBox[{"ksum", "=", 
              RowBox[{"unirates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newp", ">", "ksum"}], "&&", 
                RowBox[{
                 RowBox[{"unireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                 "\[Equal]", "s1"}]}], ",", 
               RowBox[{
                RowBox[{"ksum", "+=", 
                 RowBox[{"unirates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"new1", "=", 
              RowBox[{"unireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "2"}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
              "new1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"update", " ", "rates", " ", "for", " ", "self"}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"r", "=", 
              RowBox[{"uniindex", "[", 
               RowBox[{"[", "new1", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "id", "]"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                RowBox[{"unirates", "[", 
                 RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"unireactions", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                "\[Equal]", "new1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "+=", 
                 RowBox[{"unirates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"id", ">", "1"}], ",", 
               RowBox[{
                RowBox[{"id", "=", 
                 RowBox[{"Quotient", "[", 
                  RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "update", " ", "rates", " ", "for", " ", "bimolecular", " ", 
                 "neighbors"}], ",", " ", 
                RowBox[{"in", " ", "both", " ", "orientations"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                 RowBox[{"EngineNeighbors", "[", 
                  RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new1", ",", "snb"}], "]"}], "]"}]}], ";", 
                   RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], "*", "n", "*", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                 RowBox[{"(*", " ", 
                  RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"else", " ", "--"}], "--"}], "--"}], "--"}], " ", 
                "bimolecular", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"move", " ", "--"}], "--"}], "--"}], "--"}]}], "-",
                " ", 
               RowBox[{"so", " ", "nb"}]}], ">", 
              RowBox[{"0", " ", "and", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"i", "+", "di"}], ",", 
                 RowBox[{"j", "+", "dj"}], ",", 
                 RowBox[{"k", "+", "dk"}]}], ")"}], " ", "guaranteed", " ", 
               "to", " ", "be", " ", "within", " ", "range"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
              RowBox[{"EngineNeighbors", "[", 
               RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i2", ",", "j2", ",", "k2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "di"}], ",", 
                RowBox[{"j", "+", "dj"}], ",", 
                RowBox[{"k", "+", "dk"}]}], "}"}]}], ";", " ", 
             RowBox[{"s1", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ";", 
             RowBox[{"s2", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "j2", ",", "k2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r", "=", 
              RowBox[{"biindex", "[", 
               RowBox[{"[", 
                RowBox[{"s1", ",", "s2"}], "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r", "\[Equal]", "0"}], ",", 
                 RowBox[{"Print", "[", "\"\<bibad!\>\"", "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"newp", "=", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"[", "id", "]"}], "]"}]}]}], ";", 
             RowBox[{"ksum", "=", 
              RowBox[{"birates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newp", ">", "ksum"}], "&&", 
                RowBox[{
                 RowBox[{"bireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s2"}], "}"}]}]}], ",", 
               RowBox[{
                RowBox[{"ksum", "+=", 
                 RowBox[{"birates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"new1", ",", "new2"}], "}"}], "=", 
              RowBox[{"bireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
              "new1"}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "di"}], ",", 
                 RowBox[{"j", "+", "dj"}], ",", 
                 RowBox[{"k", "+", "dk"}]}], "]"}], "]"}], "=", "new2"}], ";",
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "update", " ", "self", " ", "rates", " ", "for", " ", "each", 
               " ", 
               RowBox[{"(", "possibly", ")"}], " ", "changed", " ", "site"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", 
                 RowBox[{"uniindex", "[", 
                  RowBox[{"[", "new1", "]"}], "]"}]}], ";", 
                RowBox[{"id", "=", 
                 RowBox[{
                  RowBox[{"2", "^", "K"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"unireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                   "\[Equal]", "new1"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{"id", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                 "]"}]}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", 
                 RowBox[{"uniindex", "[", 
                  RowBox[{"[", "new2", "]"}], "]"}]}], ";", 
                RowBox[{"id", "=", 
                 RowBox[{
                  RowBox[{"2", "^", "K"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], "*", "n", "*", "m"}], 
                  "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], "*", "m"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"unireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                   "\[Equal]", "new2"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{"id", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                 "]"}]}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "update", " ", "rates", " ", "for", " ", "bimolecular", " ", 
               "neighbors", " ", "of", " ", "each", " ", 
               RowBox[{"(", "possibly", ")"}], " ", "changed", " ", "site"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
               RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                   RowBox[{"EngineNeighbors", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new1", ",", "snb"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], "*", "n", "*", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
               RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                   RowBox[{"EngineNeighbors", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i2", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j2", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k2", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i2", "+", "di"}], ",", 
                    RowBox[{"j2", "+", "dj"}], ",", 
                    RowBox[{"k2", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new2", ",", "snb"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], "*", "n", "*", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new2", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new2"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "+", "di", "-", "1"}], ")"}], "*", "n", "*",
                     "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new2"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"haltedq", "=", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "0.0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"residue", "=", "t"}], ";", 
       RowBox[{"digits", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"digit", "=", 
            RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
           RowBox[{"residue", "=", 
            RowBox[{
             RowBox[{"10", "residue"}], "-", 
             RowBox[{"10", " ", "digit"}]}]}], ";", " ", "digit"}], ",", 
          RowBox[{"{", "20", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "[", "S", "]"}], "~", "Join", "~", "digits", "~", 
        "Join", "~", 
        RowBox[{"{", 
         RowBox[{"events", ",", "haltedq"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationOptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       ",", 
       RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
    RowBox[{"Parallelization", "->", "True"}], ",", 
    RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, {3.826490117841283*^9, 
   3.826490127965609*^9}, {3.826490296804644*^9, 3.8264903190663023`*^9}, {
   3.8264904472396*^9, 3.8264904499324207`*^9}, {3.8264904889045143`*^9, 
   3.826490694257897*^9}, {3.8264907906283083`*^9, 3.826490790988693*^9}, {
   3.826491034152959*^9, 3.8264910867757473`*^9}, {3.826494658889443*^9, 
   3.826494701454627*^9}, {3.8264952080065117`*^9, 3.8264952441429377`*^9}, {
   3.826495391718115*^9, 3.826495426008934*^9}, {3.82649545916541*^9, 
   3.826495461823557*^9}, {3.826495514842798*^9, 3.826495629911133*^9}, {
   3.826495707526843*^9, 3.826495729409141*^9}, {3.82649578602295*^9, 
   3.826495987146162*^9}, {3.826496945583682*^9, 3.8264969915024157`*^9}, {
   3.826497036091778*^9, 3.826497104159731*^9}, {3.82649715387149*^9, 
   3.8264971828931093`*^9}, {3.826497240700202*^9, 3.826497409414976*^9}, {
   3.82649758367306*^9, 3.8264976459917927`*^9}, {3.8264976934790897`*^9, 
   3.826497730453253*^9}, {3.826497939923622*^9, 3.826497994593171*^9}, {
   3.826498046440185*^9, 3.8264980986670713`*^9}, {3.826499604645473*^9, 
   3.826499610112589*^9}, {3.82650076491949*^9, 3.826500786463396*^9}, {
   3.826500847488289*^9, 3.826500882816243*^9}, {3.8265009208231287`*^9, 
   3.8265009211713657`*^9}, {3.826500988858039*^9, 3.826501027155529*^9}, {
   3.8265014710833473`*^9, 3.826501522045053*^9}, 3.826501997846107*^9, {
   3.826502032680872*^9, 3.826502072085429*^9}, {3.826502140526155*^9, 
   3.8265021581655893`*^9}, {3.8274351123592978`*^9, 
   3.8274351245598297`*^9}, {3.8274351921608047`*^9, 
   3.8274352095176077`*^9}, {3.827435268635062*^9, 3.8274353071722193`*^9}, {
   3.8274353768251534`*^9, 3.82743552009692*^9}, {3.827435562863843*^9, 
   3.827435576653614*^9}, {3.827435657406066*^9, 3.8274356874027367`*^9}, {
   3.827435763080701*^9, 3.827435778299739*^9}, {3.8274358385137777`*^9, 
   3.827435849242551*^9}, {3.827435879546389*^9, 3.827435889122077*^9}, {
   3.827439059515089*^9, 3.827439125085788*^9}, {3.827439171200235*^9, 
   3.827439473804582*^9}, {3.827440544484023*^9, 3.8274405908105707`*^9}, {
   3.8274438300291443`*^9, 3.8274439854668007`*^9}, {3.827444105281102*^9, 
   3.827444187118676*^9}, {3.827444241544485*^9, 3.827444251013945*^9}, {
   3.827444939623866*^9, 3.8274449654403687`*^9}, {3.827445409476548*^9, 
   3.827445599832376*^9}, {3.827445634723226*^9, 3.827445677554667*^9}, {
   3.827445839398787*^9, 3.827445861840085*^9}, 3.827445916855886*^9, {
   3.827446199026907*^9, 3.827446361000649*^9}, {3.8274466270153913`*^9, 
   3.8274466387037907`*^9}, {3.82744671007747*^9, 3.827446726783412*^9}, {
   3.8274478312160273`*^9, 3.827447839514165*^9}, {3.827447880858128*^9, 
   3.827447932332026*^9}, {3.827448587556196*^9, 3.827448658356574*^9}, {
   3.827448776923015*^9, 3.8274487878106127`*^9}, {3.8274494332828903`*^9, 
   3.827449496988875*^9}, {3.827449530123499*^9, 3.8274497262404213`*^9}, {
   3.827449771997669*^9, 3.827449777029212*^9}, {3.827449810417149*^9, 
   3.827449926368108*^9}, {3.827449959856124*^9, 3.827450025047139*^9}, {
   3.827450081003139*^9, 3.827450165529408*^9}, {3.8274502352702436`*^9, 
   3.827450288304428*^9}, {3.8274503346044893`*^9, 3.827450372710339*^9}, {
   3.8274552179018517`*^9, 3.827455279500752*^9}, {3.8274553240930977`*^9, 
   3.8274553412921267`*^9}, {3.827455461362588*^9, 3.82745554006597*^9}, {
   3.8274556490265837`*^9, 3.827455673473378*^9}, {3.827455861689157*^9, 
   3.827455872362143*^9}, {3.827456171424363*^9, 3.827456194301757*^9}, {
   3.827456403945945*^9, 3.827456439089635*^9}, {3.827456518198135*^9, 
   3.827456525475007*^9}, {3.8274565790153217`*^9, 3.8274566115069447`*^9}, {
   3.827456657463909*^9, 3.827456667558611*^9}, {3.82745670109046*^9, 
   3.827456715283847*^9}, {3.8276860801451797`*^9, 3.827686083297187*^9}, {
   3.827686440700819*^9, 3.8276866821423197`*^9}, {3.827687138276053*^9, 
   3.827687138636119*^9}, {3.827687182269754*^9, 3.827687187815103*^9}, {
   3.827687234472637*^9, 3.827687237224285*^9}, {3.827687322163837*^9, 
   3.827687378460202*^9}, {3.827687419741844*^9, 3.827687419841092*^9}, {
   3.827687477485483*^9, 3.827687515184065*^9}, {3.827688910570066*^9, 
   3.82768892258862*^9}, {3.827689455641632*^9, 3.827689468926861*^9}, 
   3.8276895076673317`*^9, {3.82769145706855*^9, 3.827691478569367*^9}, {
   3.827691679856038*^9, 3.8276917064620333`*^9}, {3.827691834857884*^9, 
   3.82769183948332*^9}, {3.8276919973695517`*^9, 3.827692059800847*^9}, 
   3.8276922126574802`*^9, {3.8276922727183523`*^9, 3.827692301838957*^9}, {
   3.827692345238646*^9, 3.8276923491117153`*^9}, {3.8276929383258057`*^9, 
   3.827693043530583*^9}, {3.8276931511196632`*^9, 3.827693173171525*^9}, {
   3.827693213660039*^9, 3.82769326159099*^9}, {3.827693583747015*^9, 
   3.8276936878414097`*^9}, {3.8276937568317213`*^9, 
   3.8276937679334507`*^9}, {3.8276945232525473`*^9, 3.827694579565968*^9}, {
   3.827694649406556*^9, 3.827694649837871*^9}, {3.8276947219253674`*^9, 
   3.827694768944418*^9}, {3.827694864995953*^9, 3.827694865492052*^9}, {
   3.8276949255058413`*^9, 3.8276949981318808`*^9}, {3.829311071079625*^9, 
   3.8293110870472107`*^9}, {3.829311674079611*^9, 3.8293116837638187`*^9}, {
   3.829311717698142*^9, 3.829311757581853*^9}, {3.829311788546165*^9, 
   3.829311811571733*^9}, {3.82931212172125*^9, 3.8293121240325193`*^9}, 
   3.829313173107744*^9, {3.8293132378299503`*^9, 3.8293132389853477`*^9}, {
   3.829313367819182*^9, 3.829313375224931*^9}, {3.8293134412381496`*^9, 
   3.8293135261663523`*^9}, {3.829313565362571*^9, 3.8293135681235723`*^9}, {
   3.82931540052383*^9, 3.82931540428677*^9}, {3.829315441729999*^9, 
   3.829315447344001*^9}, {3.82935083575909*^9, 3.829350836117942*^9}, {
   3.829352513838688*^9, 3.829352563161935*^9}, {3.829353599867165*^9, 
   3.829353678365094*^9}, {3.829353721453038*^9, 3.829353742259715*^9}, {
   3.829353788873304*^9, 3.829353810990847*^9}, {3.82935386627274*^9, 
   3.8293538993119698`*^9}, {3.829353934607794*^9, 3.829354122396658*^9}, {
   3.8293542149052143`*^9, 3.8293544508047953`*^9}, {3.8293548624694977`*^9, 
   3.8293549283683443`*^9}, {3.8293549597936707`*^9, 3.829355306890025*^9}, {
   3.8293564239693117`*^9, 3.8293564286338997`*^9}, {3.829356590716354*^9, 
   3.8293566973751173`*^9}, {3.8293569554394007`*^9, 3.829356955592334*^9}, {
   3.829356993754346*^9, 3.829357141112039*^9}, {3.829357206206911*^9, 
   3.8293572454739447`*^9}, {3.829357284512332*^9, 3.829357449190792*^9}, {
   3.829357479774501*^9, 3.829357499486163*^9}, {3.829396385300983*^9, 
   3.829396387538836*^9}, {3.829396421527855*^9, 3.8293964456380663`*^9}, {
   3.829396511420451*^9, 3.829396545091914*^9}, {3.82939694897434*^9, 
   3.82939695487729*^9}, {3.82939702578876*^9, 3.8293971841711407`*^9}, {
   3.829397215545189*^9, 3.829397245885077*^9}, {3.829397379992309*^9, 
   3.82939738842198*^9}, {3.829397426883976*^9, 3.829397472208158*^9}, {
   3.8293975135811996`*^9, 3.829397540329706*^9}, {3.829397630469928*^9, 
   3.829397683549979*^9}, {3.829398303467143*^9, 3.8293983765914173`*^9}, {
   3.829398456138383*^9, 3.829398494356905*^9}, {3.829399548875527*^9, 
   3.829399559257853*^9}, {3.8293996015913258`*^9, 3.829399640293932*^9}, {
   3.829400475900655*^9, 3.829400566573152*^9}, {3.829400659910534*^9, 
   3.8294007078151217`*^9}, {3.8294007380666533`*^9, 3.829400774840069*^9}, {
   3.829401235887641*^9, 3.829401334205523*^9}, {3.829401578505167*^9, 
   3.829401694039124*^9}, {3.829401757471079*^9, 3.829401889893997*^9}, {
   3.829401987435071*^9, 3.829402007092865*^9}, {3.829402691027473*^9, 
   3.829402699165428*^9}, {3.829413927760243*^9, 3.829413977051437*^9}, {
   3.829414026593277*^9, 3.829414107585991*^9}, {3.8294151588835773`*^9, 
   3.829415300267589*^9}, {3.829415343766718*^9, 3.8294153906807423`*^9}, {
   3.829415652260687*^9, 3.829415664184716*^9}, {3.829415695494206*^9, 
   3.8294158716350183`*^9}, {3.8294159073410683`*^9, 3.82941590822316*^9}, {
   3.829416266683345*^9, 3.829416451704829*^9}, 3.829417159719322*^9, {
   3.829417425062392*^9, 3.829417425388935*^9}, {3.8294182313414993`*^9, 
   3.8294182720524483`*^9}, {3.829419040710771*^9, 3.8294190730194798`*^9}, {
   3.829419597617413*^9, 3.829419683040909*^9}, {3.8294197193992567`*^9, 
   3.8294197503994713`*^9}, {3.829420305315015*^9, 3.829420408931347*^9}, {
   3.829420509918208*^9, 3.8294206107441063`*^9}, {3.829420666901655*^9, 
   3.829420813370242*^9}, {3.829420957101894*^9, 3.829421004059791*^9}, 
   3.8294210354269342`*^9, {3.8294214045467653`*^9, 3.829421424039044*^9}, {
   3.829421536466301*^9, 3.829421556242803*^9}, {3.8294216245874853`*^9, 
   3.829421627705082*^9}, {3.829421668141285*^9, 3.8294216697019997`*^9}, 
   3.8294265008730803`*^9, {3.8294322580856047`*^9, 3.829432310638414*^9}, {
   3.829432348126721*^9, 3.8294323686174517`*^9}, {3.829764560803157*^9, 
   3.829764568452071*^9}, {3.82976460512537*^9, 3.829764685216671*^9}, {
   3.8297647698751297`*^9, 3.829764778985075*^9}, {3.8297649730814133`*^9, 
   3.829765023526205*^9}, {3.829765110610145*^9, 3.829765221168387*^9}, {
   3.829770156248089*^9, 3.8297702852081823`*^9}, {3.832636544093556*^9, 
   3.8326365472728157`*^9}, {3.855090614871993*^9, 3.855090615617996*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"b1dcb21b-bcb4-4514-80e3-523a947114ec"],

Cell[BoxData[
 TemplateBox[{
  "CCompilerDriver`CreateLibrary","cmperr",
   "\"Compile error: \\!\\(\\*RowBox[{\\\"\\\\\\\"C:\\\\\\\\\\\\\\\\Users\\\\\
\\\\\\\\\\\\User\\\\\\\\\\\\\\\\AppData\\\\\\\\\\\\\\\\Roaming\\\\\\\\\\\\\\\\\
Mathematica\\\\\\\\\\\\\\\\ApplicationData\\\\\\\\\\\\\\\\CCompilerDriver\\\\\
\\\\\\\\\\\\BuildFolder\\\\\\\\\\\\\\\\user-pc-24328\\\\\\\\\\\\\\\\Working-\
user-pc-24328-12764-1\\\\\\\\\\\\\\\\compiledFunction0.c(1): fatal error \
C1083: Cannot open include file: 'math.h': No such file or \
directory\\\\\\\"\\\"}]\\)\"",2,181,58,18301667445921376025,"Local",
   "CCompilerDriver`CreateLibrary"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.8554168317473583`*^9, 3.855519600789892*^9},
 CellLabel->
  "During evaluation of \
In[179]:=",ExpressionUUID->"da0819a6-940f-4efd-bc52-90c069774813"],

Cell[BoxData[
 TemplateBox[{
  "Compile","nogen",
   "\"A library could not be generated from the compiled function.\"",2,181,
   59,18301667445921376025,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8554168317473583`*^9, 3.855519600802856*^9},
 CellLabel->
  "During evaluation of \
In[179]:=",ExpressionUUID->"e7f438f5-d153-4db5-9ad7-b87062aa481e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["CompiledFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
                0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
                 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIRIGYC4r9qIkoPPog5zJd34+ifoeBwf6HGBfU8aYe0
2dKXhaMEHT77F2xc1CQH52elHtL/aqrg0KrArnpmjpRDvTCXYEG9gsOOYKuI
/6tlHZ5WFpRfO4qQn3ww8NOrXYpw/fNmfE3SCFCG8z8EiLwQ7lSF2w82/44y
nM937b/lmXNKDnK7FuxLZZFwMDfq/3NwgpKDccaL+Q9miDok9Mnt3x6k5FDt
mbylT0ECwk9QhOuXWfO/eIajPCq/WNYh5kh50jV+CYc1eV/nfGGShZsXte2a
OGevDNy8ZqG0W/9KpeD60cMLAIwUgfU=
                "]], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{12.82453, 
                5.289294374999999}, {11.960858124999998`, 8.29796625}, {
                11.080858124999999`, 8.29796625}, {12.417186249999999`, 
                4.337966249999999}, {13.193201874999998`, 
                4.337966249999999}, {14.540701874999998`, 8.29796625}, {
                13.688201874999999`, 8.29796625}, {12.82453, 
                5.289294374999999}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
                0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
                 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIpIGYC4qwFP+fsFjB0WFcz7fnBvSIOLFaTza6GGTjM
l3fj6J+h4GC9PHLBXXc9DH7abOnLwlGCDtPNZKaxndfH4Is8/uOrISAD53uI
GTRGxyP4O4KtIv6fR/BbFdhVz8TIOqj9FNyfdEbfIejt5Y8zXiL4h7TunbCJ
koPzweYvkXP4mfT+6PSlBnD7n25Z/mROiSGcr7S/rqPX1AiuHsaHmQfjw+zz
lubzZjYxgrsHxoe5F8aH+QfGn/B91VROQQQfZr/Ei1viF75j8mHh6eiSdevo
cUM4Hz0+AG0eosQ=
                "]]}}, Background -> GrayLevel[0.93], Axes -> 
             False, AspectRatio -> 1, ImageSize -> {Automatic, 
               Dynamic[
               3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification]), ImageSizeCache -> {45., {0., 9.}}]}, Frame -> 
             True, FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", "_Real"}], 
                    "}"}], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
                0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
                 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIRIGYC4r9qIkoPPog5zJd34+ifoeBwf6HGBfU8aYe0
2dKXhaMEHT77F2xc1CQH52elHtL/aqrg0KrArnpmjpRDvTCXYEG9gsOOYKuI
/6tlHZ5WFpRfO4qQn3ww8NOrXYpw/fNmfE3SCFCG8z8EiLwQ7lSF2w82/44y
nM937b/lmXNKDnK7FuxLZZFwMDfq/3NwgpKDccaL+Q9miDok9Mnt3x6k5FDt
mbylT0ECwk9QhOuXWfO/eIajPCq/WNYh5kh50jV+CYc1eV/nfGGShZsXte2a
OGevDNy8ZqG0W/9KpeD60cMLAIwUgfU=
                "]], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{12.82453, 
                5.289294374999999}, {11.960858124999998`, 8.29796625}, {
                11.080858124999999`, 8.29796625}, {12.417186249999999`, 
                4.337966249999999}, {13.193201874999998`, 
                4.337966249999999}, {14.540701874999998`, 8.29796625}, {
                13.688201874999999`, 8.29796625}, {12.82453, 
                5.289294374999999}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
                0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
                 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIpIGYC4qwFP+fsFjB0WFcz7fnBvSIOLFaTza6GGTjM
l3fj6J+h4GC9PHLBXXc9DH7abOnLwlGCDtPNZKaxndfH4Is8/uOrISAD53uI
GTRGxyP4O4KtIv6fR/BbFdhVz8TIOqj9FNyfdEbfIejt5Y8zXiL4h7TunbCJ
koPzweYvkXP4mfT+6PSlBnD7n25Z/mROiSGcr7S/rqPX1AiuHsaHmQfjw+zz
lubzZjYxgrsHxoe5F8aH+QfGn/B91VROQQQfZr/Ei1viF75j8mHh6eiSdevo
cUM4Hz0+AG0eosQ=
                "]]}}, Background -> GrayLevel[0.93], Axes -> 
             False, AspectRatio -> 1, ImageSize -> {Automatic, 
               Dynamic[
               3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification]), ImageSizeCache -> {45., {0., 9.}}]}, Frame -> 
             True, FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", "_Real"}], 
                    "}"}], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "space", ",", "unireactions", ",", "unirates", ",", 
                    "uniindex", ",", "bireactions", ",", "birates", ",", 
                    "biindex", ",", "tmax"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "=", 
                    RowBox[{"Length", "[", "space", "]"}]}], ",", 
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
                    RowBox[{"m", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",",
                     "d1", ",", "d2", ",", "n1", ",", "n2", ",", "m1", ",", 
                    "m2", ",", 
                    RowBox[{"S", "=", "space"}], ",", "R", ",", "id", ",", 
                    "idd", ",", "K", ",", "nb", ",", "nbnb", ",", "i", ",", 
                    "j", ",", "k", ",", "i2", ",", "j2", ",", "k2", ",", "di",
                     ",", "dj", ",", "dk", ",", "r", ",", 
                    RowBox[{"s1", "=", "1"}], ",", 
                    RowBox[{"s2", "=", "1"}], ",", "snb", ",", "new1", ",", 
                    "new2", ",", "ksum", ",", "newp", ",", 
                    RowBox[{"t", "=", "0.`"}], ",", "dt", ",", 
                    RowBox[{"events", "=", "0"}], ",", "haltedq", ",", 
                    "digit", ",", "digits", ",", "residue"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"K", "=", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{"7", " ", "d", " ", "n", " ", "m"}]}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"R", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0.`", ",", 
                    RowBox[{"{", 
                    SuperscriptBox["2", 
                    RowBox[{"K", "+", "1"}]], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "d"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "m"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"d1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "di"}]}], "]"}]}], ";", 
                    RowBox[{"d2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"d", ",", 
                    RowBox[{"d", "-", "di"}]}], "]"}]}], ";", 
                    RowBox[{"n1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "dj"}]}], "]"}]}], ";", 
                    RowBox[{"n2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "-", "dj"}]}], "]"}]}], ";", 
                    RowBox[{"m1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "dk"}]}], "]"}]}], ";", 
                    RowBox[{"m2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"m", "-", "dk"}]}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "d1", ",", "d2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n1", ",", "n2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "m1", ",", "m2"}], "}"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "<", "tmax"}], "&&", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ">", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"dt", "=", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"Log", "[", 
                    RowBox[{"RandomReal", "[", "]"}], "]"}], 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "+", "dt"}], "<", "tmax"}], ",", 
                    RowBox[{
                    RowBox[{"t", "+=", "dt"}], ";", 
                    RowBox[{"events", "++"}]}], ",", 
                    RowBox[{
                    RowBox[{"t", "=", "tmax"}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"id", "=", "1"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", "<", 
                    SuperscriptBox["2", "K"]}], ",", 
                    RowBox[{"id", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}], "<", 
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"2", " ", "id"}], ",", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}]}], "]"}]}]}], "]"}], 
                    ";", 
                    RowBox[{"idd", "=", "id"}], ";", 
                    RowBox[{"idd", "-=", 
                    SuperscriptBox["2", "K"]}], ";", 
                    RowBox[{"nb", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", 
                    RowBox[{"d", " ", "n", " ", "m"}]}], "]"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}]}], ";", 
                    RowBox[{"i", "=", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", 
                    RowBox[{"n", " ", "m"}]}], "]"}], "+", "1"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}]}], 
                    ";", 
                    RowBox[{"j", "=", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", "m"}], "]"}], "+", "1"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}]}], ";", 
                    RowBox[{"k", "=", 
                    RowBox[{"idd", "+", "1"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"nb", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"s1", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "s1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"ksum", "=", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newp", ">", "ksum"}], "&&", 
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "s1"}]}], ",", 
                    RowBox[{
                    RowBox[{"ksum", "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"new1", "=", 
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}], ";", 
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new1", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new1"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], " ", "n", " ", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i2", ",", "j2", ",", "k2"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "}"}]}], ";", 
                    RowBox[{"s1", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"s2", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i2", ",", "j2", ",", "k2"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"s1", ",", "s2"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"ksum", "=", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newp", ">", "ksum"}], "&&", 
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"s1", ",", "s2"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"ksum", "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}], 
                    "=", "new2"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}], ";", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new2", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], " ", "n", " ", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new2"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}], ";", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new1", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new1"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], " ", "n", " ", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                    "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i2", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j2", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k2", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i2", "+", "di"}], ",", 
                    RowBox[{"j2", "+", "dj"}], ",", 
                    RowBox[{"k2", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new2", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], " ", "n", " ", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new2", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new2"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "+", "di", "-", "1"}], ")"}], " ", "n", " ",
                     "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new2"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                    "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
                    RowBox[{"haltedq", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0.`"}], "]"}]}], 
                    ";", 
                    RowBox[{"residue", "=", "t"}], ";", 
                    RowBox[{"digits", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"digit", "=", 
                    RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
                    RowBox[{"residue", "=", 
                    RowBox[{
                    RowBox[{"10", " ", "residue"}], "-", 
                    RowBox[{"10", " ", "digit"}]}]}], ";", "digit"}], ",", 
                    RowBox[{"{", "20", "}"}]}], "]"}]}], ";", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "S", "]"}], ",", "digits"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"events", ",", "haltedq"}], "}"}]}], "]"}]}]}], 
                    "]"}], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  CompiledFunction[{11, 12., 7768}, {{
     Blank[Integer], 3}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, {
     Blank[Integer], 1}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, {
     Blank[Integer], 2}, 
    Blank[Real]}, {{2, 3, 0}, {2, 2, 1}, {3, 1, 2}, {2, 1, 3}, {2, 2, 4}, {3, 
   1, 5}, {2, 2, 6}, {3, 0, 0}, {2, 1, 
   17}}, {{False, {1, 0, 2}}, {0, {2, 0, 4}}, {1., {3, 0, 5}}, {
    10, {2, 0, 43}}, {6, {2, 0, 20}}, {5, {2, 0, 38}}, {
    2, {2, 0, 5}}, {-1, {2, 0, 16}}, {{1, 2}, {2, 1, 11}}, {
    7, {2, 0, 6}}, {{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 
     0, -1}, {0, 0, 1}}, {2, 2, 9}}, {1, {2, 0, 1}}, {
    3, {2, 0, 21}}, {{3, 4}, {2, 1, 14}}, {
    0., {3, 0, 1}}, {{2, 1, 4, 3, 6, 5}, {2, 1, 13}}, {20, {2, 0, 42}}}, {8, 
   47, 12, 0, 
   18}, {{33, 0, 37}, {38, 0, 0, 1, 2, 10}, {33, 10, 33}, {38, 0, 0, 1, 2, 
    10}, {38, 10, 0, 1, 1, 7}, {33, 7, 32}, {
    42, "CopyTensor", 2, 3, 0, 2, 3, 7}, {6, 1, 27}, {6, 1, 36}, {7, 1, 2}, {
    6, 4, 15}, {15, 6, 37, 33, 32, 17}, {12, 1, 17, 13}, {10, 5, 4}, {10, 13, 
    3}, {41, 264, 3, 0, 4, 3, 0, 3, 3, 0, 9}, {40, 51, 3, 0, 9, 2, 0, 13}, {
    12, 13, 1, 17}, {41, 263, 2, 0, 5, 2, 0, 17, 2, 0, 25}, {6, 4, 29}, {35, 
    25, 3, 10}, {6, 4, 17}, {3, 2}, {36, 29, 1, 3, 10}, {4, 17, 25, -1}, {6, 
    37, 7}, {6, 4, 31}, {3, 35}, {6, 33, 29}, {6, 4, 17}, {3, 31}, {6, 32, 
    25}, {6, 4, 28}, {3, 27}, {38, 7, 0, 31, 0, 17, 0, 28, 0, 26}, {38, 3, 0, 
    26, 0, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 26}, {12, 31, 16, 30}, {15,
     30, 33, 32, 30}, {12, 17, 16, 10}, {15, 10, 32, 10}, {12, 28, 16, 8}, {
    12, 26, 30, 10, 8, 26}, {25, 4, 12, 1}, {2, 1, 6}, {38, 1, 0, 12, 0, 1, 0,
     30}, {38, 7, 0, 31, 0, 17, 0, 28, 0, 10}, {24, 30, 10, 0}, {5, 0, 5}, {3,
     2}, {5, 2, 5}, {2, 5, 9}, {38, 10, 0, 26, 0, 9}, {38, 2, 0, 12, 0, 4}, {
    13, 9, 4, 9}, {39, 10, 0, 26, 0, 9}, {6, 12, 30}, {12, 30, 1, 10}, {6, 10,
     12}, {3, -16}, {4, 28, 25, -26}, {4, 17, 29, -30}, {4, 31, 7, -34}, {6, 
    20, 7}, {6, 4, 31}, {3, 82}, {38, 9, 0, 31, 1, 8}, {33, 8, 29}, {24, 29, 
    21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 2, 29}, {37, 8, 5,
     2, 17}, {37, 8, 21, 2, 25}, {18, 29, 28}, {12, 1, 28, 30}, {
    42, "MaxI", 2, 0, 1, 2, 0, 30, 2, 0, 28}, {18, 29, 30}, {12, 37, 30, 
    10}, {42, "MinI", 2, 0, 37, 2, 0, 10, 2, 0, 30}, {18, 17, 10}, {12, 1, 10,
     8}, {42, "MaxI", 2, 0, 1, 2, 0, 8, 2, 0, 10}, {18, 17, 8}, {12, 33, 8, 
    24}, {42, "MinI", 2, 0, 33, 2, 0, 24, 2, 0, 8}, {18, 25, 24}, {12, 1, 24, 
    14}, {42, "MaxI", 2, 0, 1, 2, 0, 14, 2, 0, 24}, {18, 25, 14}, {12, 32, 14,
     23}, {42, "MinI", 2, 0, 32, 2, 0, 23, 2, 0, 14}, {
    42, "IteratorCountI", 2, 0, 28, 2, 0, 30, 2, 0, 23}, {6, 16, 22}, {3, 
    50}, {12, 28, 22, 11}, {
    42, "IteratorCountI", 2, 0, 10, 2, 0, 8, 2, 0, 9}, {6, 16, 19}, {3, 45}, {
    12, 10, 19, 18}, {42, "IteratorCountI", 2, 0, 24, 2, 0, 14, 2, 0, 3}, {6, 
    16, 2}, {3, 40}, {12, 24, 2, 0}, {38, 7, 0, 11, 0, 18, 0, 0, 0, 35}, {12, 
    11, 29, 40}, {12, 18, 17, 39}, {12, 0, 25, 34}, {38, 7, 0, 40, 0, 39, 0, 
    34, 0, 41}, {38, 6, 0, 35, 0, 41, 0, 40}, {6, 40, 12}, {41, 263, 2, 0, 5, 
    2, 0, 13, 2, 0, 40}, {15, 31, 37, 33, 32, 35}, {12, 11, 16, 41}, {15, 41, 
    33, 32, 41}, {12, 18, 16, 39}, {15, 39, 32, 39}, {12, 0, 16, 34}, {12, 40,
     35, 41, 39, 34, 40}, {6, 40, 26}, {25, 4, 12, 5}, {2, 5, 11}, {38, 4, 0, 
    12, 1, 11, 1, 8}, {38, 7, 0, 11, 0, 18, 0, 0, 0, 40}, {12, 11, 29, 35}, {
    12, 18, 17, 41}, {12, 0, 25, 39}, {38, 7, 0, 35, 0, 41, 0, 39, 0, 34}, {
    34, 1, 2, 40, 34, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 0}, {5, 
    0, 1}, {3, 2}, {5, 2, 1}, {2, 1, 9}, {38, 10, 0, 26, 0, 9}, {38, 5, 0, 12,
     0, 4}, {13, 9, 4, 9}, {39, 10, 0, 26, 0, 9}, {6, 12, 40}, {12, 40, 1, 
    34}, {6, 34, 12}, {3, -21}, {4, 2, 3, -39}, {4, 19, 9, -44}, {4, 22, 
    23, -49}, {4, 31, 7, -81}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 31}, {12, 
    31, 16, 31}, {6, 16, 23}, {
    42, "IteratorCountI", 2, 0, 31, 2, 0, 1, 2, 0, 23, 2, 0, 22}, {6, 16, 
    11}, {3, 10}, {15, 11, 23, 9}, {12, 31, 9, 19}, {15, 5, 19, 9}, {38, 10, 
    0, 9, 0, 9}, {15, 5, 19, 9}, {12, 9, 1, 9}, {38, 10, 0, 9, 0, 4}, {13, 9, 
    4, 9}, {39, 10, 0, 19, 0, 9}, {4, 11, 22, -9}, {27, 3, 1, 2, 0, 1}, {2, 1,
     6}, {38, 10, 0, 1, 0, 9}, {10, 4, 4}, {27, 7, 1, 9, 4, 5}, {5, 5, 0}, {3,
     2}, {5, 2, 0}, {2, 0, 687}, {
    42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 9}, {40, 34, 3, 0, 9, 3, 0, 
    4}, {19, 4, 9}, {38, 10, 0, 1, 0, 4}, {40, 60, 3, 0, 4, 3, 0, 3}, {16, 9, 
    3, 9}, {13, 2, 9, 3}, {27, 3, 1, 3, 0, 1}, {2, 1, 7}, {13, 2, 9, 3}, {7, 
    3, 2}, {6, 15, 7}, {12, 7, 1, 31}, {6, 31, 15}, {3, 3}, {7, 0, 2}, {3, 
    670}, {6, 1, 26}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 7}, {25, 26, 7, 1}, {
    2, 1, 16}, {42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 3}, {38, 10, 0, 26, 
    0, 4}, {16, 3, 4, 3}, {15, 5, 26, 7}, {38, 10, 0, 7, 0, 4}, {27, 3, 1, 3, 
    4, 5}, {2, 5, 4}, {15, 5, 26, 7}, {6, 7, 23}, {3, 4}, {15, 5, 26, 31}, {
    12, 31, 1, 31}, {6, 31, 23}, {6, 23, 26}, {3, -17}, {6, 26, 23}, {41, 263,
     2, 0, 5, 2, 0, 13, 2, 0, 7}, {41, 258, 2, 0, 23, 2, 0, 7, 2, 0, 31}, {6, 
    31, 23}, {15, 37, 33, 32, 31}, {41, 262, 2, 0, 23, 2, 0, 31, 2, 0, 7}, {
    15, 7, 37, 33, 32, 31}, {41, 258, 2, 0, 23, 2, 0, 31, 2, 0, 22}, {6, 22, 
    23}, {15, 33, 32, 22}, {41, 262, 2, 0, 23, 2, 0, 22, 2, 0, 31}, {12, 31, 
    1, 31}, {12, 31, 16, 22}, {15, 22, 33, 32, 22}, {41, 258, 2, 0, 23, 2, 0, 
    22, 2, 0, 11}, {6, 11, 23}, {41, 262, 2, 0, 23, 2, 0, 32, 2, 0, 11}, {12, 
    11, 1, 11}, {12, 11, 16, 22}, {15, 22, 32, 22}, {41, 258, 2, 0, 23, 2, 0, 
    22, 2, 0, 19}, {6, 19, 23}, {12, 23, 1, 19}, {24, 7, 4, 1}, {2, 1, 192}, {
    38, 7, 0, 31, 0, 11, 0, 19, 0, 22}, {6, 22, 27}, {38, 3, 0, 27, 0, 22}, {
    6, 22, 12}, {42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 3}, {38, 10, 0, 26,
     0, 4}, {16, 3, 4, 3}, {38, 2, 0, 12, 0, 4}, {27, 7, 1, 3, 4, 5}, {2, 5, 
    6}, {12, 12, 1, 22}, {38, 1, 0, 22, 0, 1, 0, 9}, {24, 9, 27, 3}, {5, 3, 
    6}, {3, 2}, {5, 2, 6}, {2, 6, 9}, {12, 12, 1, 9}, {38, 2, 0, 9, 0, 8}, {
    13, 4, 8, 6}, {7, 6, 4}, {6, 12, 9}, {12, 9, 1, 22}, {6, 22, 12}, {
    3, -16}, {38, 1, 0, 12, 0, 5, 0, 9}, {39, 7, 0, 31, 0, 11, 0, 19, 0, 9}, {
    38, 3, 0, 9, 0, 22}, {6, 22, 12}, {24, 12, 4, 6}, {2, 6, 4}, {10, 4, 7}, {
    7, 7, 8}, {3, 3}, {38, 2, 0, 12, 0, 6}, {7, 6, 8}, {39, 10, 0, 26, 0, 
    8}, {12, 12, 1, 22}, {38, 1, 0, 22, 0, 1, 0, 18}, {24, 18, 9, 6}, {2, 6, 
    10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 18}, {38, 2, 0, 18, 0, 7}, {13, 6,
     7, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 18}, {12, 18, 1, 22}, {6, 22, 
    12}, {3, -12}, {25, 1, 26, 6}, {2, 6, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 18}, {6, 18, 26}, {15, 5, 26, 18}, {38, 10, 0, 18, 0, 6}, {15, 5, 26, 
    18}, {12, 18, 1, 18}, {38, 10, 0, 18, 0, 7}, {13, 6, 7, 6}, {39, 10, 0, 
    26, 0, 6}, {3, -11}, {6, 20, 18}, {6, 4, 22}, {3, 125}, {38, 9, 0, 22, 1, 
    8}, {33, 8, 3}, {24, 3, 21, 6}, {32, 6, 6}, {2, 6, 3}, {49}, {3, 1}, {37, 
    8, 1, 2, 3}, {6, 3, 29}, {37, 8, 5, 2, 3}, {6, 3, 17}, {37, 8, 21, 2, 
    3}, {6, 3, 25}, {12, 31, 29, 3}, {26, 1, 3, 37, 6}, {2, 6, 11}, {12, 11, 
    17, 3}, {26, 1, 3, 33, 5}, {2, 5, 5}, {12, 19, 25, 3}, {26, 1, 3, 32, 
    3}, {5, 3, 4}, {3, 2}, {5, 2, 4}, {5, 4, 5}, {3, 2}, {5, 2, 5}, {2, 5, 
    97}, {12, 31, 29, 3}, {12, 11, 17, 2}, {12, 19, 25, 0}, {38, 7, 0, 3, 0, 
    2, 0, 0, 0, 40}, {38, 6, 0, 9, 0, 40, 0, 3}, {6, 3, 12}, {41, 263, 2, 0, 
    5, 2, 0, 13, 2, 0, 3}, {15, 22, 37, 33, 32, 2}, {12, 31, 16, 0}, {15, 0, 
    33, 32, 0}, {12, 11, 16, 34}, {15, 34, 32, 34}, {12, 19, 16, 35}, {12, 3, 
    2, 0, 34, 35, 3}, {6, 3, 26}, {24, 12, 4, 6}, {2, 6, 4}, {10, 4, 10}, {7, 
    10, 7}, {3, 3}, {38, 5, 0, 12, 0, 6}, {7, 6, 7}, {39, 10, 0, 26, 0, 7}, {
    12, 12, 1, 3}, {38, 4, 0, 3, 1, 11, 1, 8}, {34, 1, 2, 9, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {2, 
    4, 10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 3}, {38, 5, 0, 3, 0, 10}, {13, 
    6, 10, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 3}, {12, 3, 1, 2}, {6, 2, 12}, {
    3, -13}, {25, 1, 26, 4}, {2, 4, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 
    3}, {6, 3, 26}, {15, 5, 26, 3}, {38, 10, 0, 3, 0, 6}, {15, 5, 26, 3}, {12,
     3, 1, 3}, {38, 10, 0, 3, 0, 10}, {13, 6, 10, 6}, {39, 10, 0, 26, 0, 6}, {
    3, -11}, {38, 13, 0, 22, 0, 3}, {38, 6, 0, 40, 0, 9, 0, 2}, {6, 2, 12}, {
    41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 2}, {15, 3, 37, 33, 32, 0}, {12, 31, 29,
     16, 34}, {15, 34, 33, 32, 34}, {12, 11, 17, 16, 35}, {15, 35, 32, 35}, {
    12, 19, 25, 16, 41}, {12, 2, 0, 34, 35, 41, 2}, {6, 2, 26}, {24, 12, 4, 
    4}, {2, 4, 4}, {10, 4, 11}, {7, 11, 10}, {3, 3}, {38, 5, 0, 12, 0, 6}, {7,
     6, 10}, {39, 10, 0, 26, 0, 10}, {12, 12, 1, 2}, {38, 4, 0, 2, 1, 11, 1, 
    8}, {34, 1, 2, 40, 9, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 6}, {2, 
    6, 10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 2}, {38, 5, 0, 2, 0, 11}, {13, 
    6, 11, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 2}, {12, 2, 1, 0}, {6, 0, 12}, {
    3, -13}, {25, 1, 26, 6}, {2, 6, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 
    2}, {6, 2, 26}, {15, 5, 26, 2}, {38, 10, 0, 2, 0, 6}, {15, 5, 26, 2}, {12,
     2, 1, 2}, {38, 10, 0, 2, 0, 11}, {13, 6, 11, 6}, {39, 10, 0, 26, 0, 6}, {
    3, -11}, {3, 1}, {4, 22, 18, -124}, {3, 434}, {38, 9, 0, 7, 1, 8}, {33, 8,
     18}, {24, 18, 21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 2, 
    18}, {6, 18, 29}, {37, 8, 5, 2, 18}, {6, 18, 17}, {37, 8, 21, 2, 18}, {6, 
    18, 25}, {12, 31, 29, 18}, {12, 11, 17, 22}, {12, 19, 25, 2}, {34, 1, 3, 
    18, 22, 2, 2, 8}, {33, 8, 18}, {24, 18, 21, 5}, {32, 5, 5}, {2, 5, 3}, {
    49}, {3, 1}, {37, 8, 1, 2, 18}, {37, 8, 5, 2, 22}, {37, 8, 21, 2, 2}, {38,
     7, 0, 31, 0, 11, 0, 19, 0, 0}, {6, 0, 27}, {38, 7, 0, 18, 0, 22, 0, 2, 0,
     0}, {6, 0, 36}, {38, 6, 0, 27, 0, 36, 0, 0}, {6, 0, 12}, {
    42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 8}, {38, 10, 0, 26, 0, 7}, {16, 
    8, 7, 8}, {7, 8, 3}, {38, 5, 0, 12, 0, 8}, {7, 8, 4}, {27, 7, 1, 3, 4, 
    5}, {2, 5, 7}, {12, 12, 1, 0}, {38, 4, 0, 0, 1, 11, 1, 8}, {34, 1, 2, 27, 
    36, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {5, 
    4, 6}, {3, 2}, {5, 2, 6}, {2, 6, 9}, {12, 12, 1, 0}, {38, 5, 0, 0, 0, 
    8}, {13, 4, 8, 7}, {7, 7, 4}, {6, 12, 0}, {12, 0, 1, 34}, {6, 34, 12}, {
    3, -17}, {38, 4, 0, 12, 1, 14, 1, 8}, {33, 8, 0}, {24, 0, 5, 6}, {32, 6, 
    6}, {2, 6, 3}, {49}, {3, 1}, {37, 8, 1, 2, 0}, {6, 0, 9}, {37, 8, 5, 2, 
    0}, {39, 7, 0, 31, 0, 11, 0, 19, 0, 9}, {12, 31, 29, 34}, {12, 11, 17, 
    35}, {12, 19, 25, 41}, {39, 7, 0, 34, 0, 35, 0, 41, 0, 0}, {24, 27, 9, 
    6}, {32, 6, 6}, {2, 6, 45}, {38, 3, 0, 9, 0, 34}, {6, 34, 12}, {41, 263, 
    2, 0, 5, 2, 0, 13, 2, 0, 34}, {12, 31, 16, 35}, {15, 35, 33, 32, 35}, {12,
     11, 16, 41}, {15, 41, 32, 41}, {12, 19, 16, 39}, {12, 34, 35, 41, 39, 
    34}, {6, 34, 26}, {24, 12, 4, 5}, {2, 5, 4}, {10, 4, 10}, {7, 10, 8}, {3, 
    3}, {38, 2, 0, 12, 0, 7}, {7, 7, 8}, {39, 10, 0, 26, 0, 8}, {12, 12, 1, 
    34}, {38, 1, 0, 34, 0, 1, 0, 35}, {24, 35, 9, 5}, {2, 5, 10}, {38, 10, 0, 
    26, 0, 7}, {12, 12, 1, 35}, {38, 2, 0, 35, 0, 10}, {13, 7, 10, 7}, {39, 
    10, 0, 26, 0, 7}, {6, 12, 35}, {12, 35, 1, 34}, {6, 34, 12}, {3, -12}, {
    25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 35}, {6, 35,
     26}, {15, 5, 26, 35}, {38, 10, 0, 35, 0, 7}, {15, 5, 26, 35}, {12, 35, 1,
     35}, {38, 10, 0, 35, 0, 10}, {13, 7, 10, 7}, {39, 10, 0, 26, 0, 7}, {
    3, -11}, {3, 1}, {24, 36, 0, 6}, {32, 6, 6}, {2, 6, 45}, {38, 3, 0, 0, 0, 
    35}, {6, 35, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 35}, {12, 18, 16, 
    34}, {15, 34, 33, 32, 34}, {12, 22, 16, 41}, {15, 41, 32, 41}, {12, 2, 16,
     39}, {12, 35, 34, 41, 39, 35}, {6, 35, 26}, {24, 12, 4, 5}, {2, 5, 4}, {
    10, 4, 10}, {7, 10, 7}, {3, 3}, {38, 2, 0, 12, 0, 8}, {7, 8, 7}, {39, 10, 
    0, 26, 0, 7}, {12, 12, 1, 35}, {38, 1, 0, 35, 0, 1, 0, 34}, {24, 34, 0, 
    5}, {2, 5, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 34}, {38, 2, 0, 34, 0, 
    10}, {13, 8, 10, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 34}, {12, 34, 1, 
    35}, {6, 35, 12}, {3, -12}, {25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 
    26, 2, 0, 5, 2, 0, 34}, {6, 34, 26}, {15, 5, 26, 34}, {38, 10, 0, 34, 0, 
    8}, {15, 5, 26, 34}, {12, 34, 1, 34}, {38, 10, 0, 34, 0, 10}, {13, 8, 10, 
    8}, {39, 10, 0, 26, 0, 8}, {3, -11}, {3, 1}, {24, 27, 9, 6}, {32, 6, 6}, {
    2, 6, 132}, {6, 20, 34}, {6, 4, 35}, {3, 127}, {38, 9, 0, 35, 1, 8}, {33, 
    8, 41}, {24, 41, 21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 
    2, 41}, {6, 41, 29}, {37, 8, 5, 2, 41}, {6, 41, 17}, {37, 8, 21, 2, 41}, {
    6, 41, 25}, {12, 31, 29, 41}, {26, 1, 41, 37, 5}, {2, 5, 11}, {12, 11, 17,
     41}, {26, 1, 41, 33, 4}, {2, 4, 5}, {12, 19, 25, 41}, {26, 1, 41, 32, 
    3}, {5, 3, 7}, {3, 2}, {5, 2, 7}, {5, 7, 4}, {3, 2}, {5, 2, 4}, {2, 4, 
    99}, {12, 31, 29, 41}, {12, 11, 17, 39}, {12, 19, 25, 44}, {38, 7, 0, 41, 
    0, 39, 0, 44, 0, 45}, {6, 45, 40}, {38, 6, 0, 9, 0, 40, 0, 45}, {6, 45, 
    12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 45}, {15, 35, 37, 33, 32, 41}, {
    12, 31, 16, 39}, {15, 39, 33, 32, 39}, {12, 11, 16, 44}, {15, 44, 32, 
    44}, {12, 19, 16, 46}, {12, 45, 41, 39, 44, 46, 45}, {6, 45, 26}, {24, 12,
     4, 5}, {2, 5, 4}, {10, 4, 10}, {7, 10, 8}, {3, 3}, {38, 5, 0, 12, 0, 
    7}, {7, 7, 8}, {39, 10, 0, 26, 0, 8}, {12, 12, 1, 45}, {38, 4, 0, 45, 1, 
    11, 1, 8}, {34, 1, 2, 9, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 7}, {2, 
    7, 10}, {38, 10, 0, 26, 0, 7}, {12, 12, 1, 45}, {38, 5, 0, 45, 0, 10}, {
    13, 7, 10, 7}, {39, 10, 0, 26, 0, 7}, {6, 12, 45}, {12, 45, 1, 41}, {6, 
    41, 12}, {3, -13}, {25, 1, 26, 7}, {2, 7, 11}, {41, 262, 2, 0, 26, 2, 0, 
    5, 2, 0, 45}, {6, 45, 26}, {15, 5, 26, 45}, {38, 10, 0, 45, 0, 7}, {15, 5,
     26, 45}, {12, 45, 1, 45}, {38, 10, 0, 45, 0, 10}, {13, 7, 10, 7}, {39, 
    10, 0, 26, 0, 7}, {3, -11}, {38, 13, 0, 35, 0, 45}, {6, 45, 3}, {38, 6, 0,
     40, 0, 9, 0, 45}, {6, 45, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 45}, {
    15, 3, 37, 33, 32, 41}, {12, 31, 29, 16, 39}, {15, 39, 33, 32, 39}, {12, 
    11, 17, 16, 44}, {15, 44, 32, 44}, {12, 19, 25, 16, 46}, {12, 45, 41, 39, 
    44, 46, 45}, {6, 45, 26}, {24, 12, 4, 7}, {2, 7, 4}, {10, 4, 6}, {7, 6, 
    10}, {3, 3}, {38, 5, 0, 12, 0, 7}, {7, 7, 10}, {39, 10, 0, 26, 0, 10}, {
    12, 12, 1, 45}, {38, 4, 0, 45, 1, 11, 1, 8}, {34, 1, 2, 40, 9, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 5}, {2, 
    5, 10}, {38, 10, 0, 26, 0, 7}, {12, 12, 1, 45}, {38, 5, 0, 45, 0, 6}, {13,
     7, 6, 7}, {39, 10, 0, 26, 0, 7}, {6, 12, 45}, {12, 45, 1, 41}, {6, 41, 
    12}, {3, -13}, {25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 45}, {6, 45, 26}, {15, 5, 26, 45}, {38, 10, 0, 45, 0, 7}, {15, 5, 26, 
    45}, {12, 45, 1, 45}, {38, 10, 0, 45, 0, 6}, {13, 7, 6, 7}, {39, 10, 0, 
    26, 0, 7}, {3, -11}, {3, 1}, {4, 35, 34, -126}, {3, 1}, {24, 36, 0, 6}, {
    32, 6, 6}, {2, 6, 132}, {6, 20, 34}, {6, 4, 35}, {3, 127}, {38, 9, 0, 35, 
    1, 8}, {33, 8, 45}, {24, 45, 21, 4}, {32, 4, 4}, {2, 4, 3}, {49}, {3, 
    1}, {37, 8, 1, 2, 45}, {6, 45, 29}, {37, 8, 5, 2, 45}, {6, 45, 17}, {37, 
    8, 21, 2, 45}, {6, 45, 25}, {12, 18, 29, 45}, {26, 1, 45, 37, 4}, {2, 4, 
    11}, {12, 22, 17, 45}, {26, 1, 45, 33, 5}, {2, 5, 5}, {12, 2, 25, 45}, {
    26, 1, 45, 32, 7}, {5, 7, 3}, {3, 2}, {5, 2, 3}, {5, 3, 5}, {3, 2}, {5, 2,
     5}, {2, 5, 99}, {12, 18, 29, 45}, {12, 22, 17, 41}, {12, 2, 25, 39}, {38,
     7, 0, 45, 0, 41, 0, 39, 0, 44}, {6, 44, 40}, {38, 6, 0, 0, 0, 40, 0, 
    44}, {6, 44, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 44}, {15, 35, 37, 33,
     32, 45}, {12, 18, 16, 41}, {15, 41, 33, 32, 41}, {12, 22, 16, 39}, {15, 
    39, 32, 39}, {12, 2, 16, 46}, {12, 44, 45, 41, 39, 46, 44}, {6, 44, 26}, {
    24, 12, 4, 4}, {2, 4, 4}, {10, 4, 7}, {7, 7, 10}, {3, 3}, {38, 5, 0, 12, 
    0, 8}, {7, 8, 10}, {39, 10, 0, 26, 0, 10}, {12, 12, 1, 44}, {38, 4, 0, 44,
     1, 11, 1, 8}, {34, 1, 2, 0, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 3}, {2, 
    3, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 44}, {38, 5, 0, 44, 0, 7}, {13,
     8, 7, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 44}, {12, 44, 1, 45}, {6, 45, 
    12}, {3, -13}, {25, 1, 26, 3}, {2, 3, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 44}, {6, 44, 26}, {15, 5, 26, 44}, {38, 10, 0, 44, 0, 8}, {15, 5, 26, 
    44}, {12, 44, 1, 44}, {38, 10, 0, 44, 0, 7}, {13, 8, 7, 8}, {39, 10, 0, 
    26, 0, 8}, {3, -11}, {38, 13, 0, 35, 0, 44}, {6, 44, 3}, {38, 6, 0, 40, 0,
     0, 0, 44}, {6, 44, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 44}, {15, 3, 
    37, 33, 32, 45}, {12, 18, 29, 16, 41}, {15, 41, 33, 32, 41}, {12, 22, 17, 
    16, 39}, {15, 39, 32, 39}, {12, 2, 25, 16, 46}, {12, 44, 45, 41, 39, 46, 
    44}, {6, 44, 26}, {24, 12, 4, 3}, {2, 3, 4}, {10, 4, 6}, {7, 6, 7}, {3, 
    3}, {38, 5, 0, 12, 0, 8}, {7, 8, 7}, {39, 10, 0, 26, 0, 7}, {12, 12, 1, 
    44}, {38, 4, 0, 44, 1, 11, 1, 8}, {34, 1, 2, 40, 0, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {2, 
    4, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 44}, {38, 5, 0, 44, 0, 6}, {13,
     8, 6, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 44}, {12, 44, 1, 45}, {6, 45, 
    12}, {3, -13}, {25, 1, 26, 4}, {2, 4, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 44}, {6, 44, 26}, {15, 5, 26, 44}, {38, 10, 0, 44, 0, 8}, {15, 5, 26, 
    44}, {12, 44, 1, 44}, {38, 10, 0, 44, 0, 6}, {13, 8, 6, 8}, {39, 10, 0, 
    26, 0, 8}, {3, -11}, {3, 1}, {4, 35, 34, -126}, {3, 1}, {3, -694}, {38, 
    10, 0, 1, 0, 10}, {27, 5, 1, 10, 1, 0}, {9, 0, 34}, {7, 2, 10}, {6, 42, 
    35}, {6, 4, 45}, {35, 35, 2, 8}, {6, 4, 44}, {3, 10}, {40, 50, 3, 0, 10, 
    2, 0, 39}, {10, 43, 7}, {16, 7, 10, 7}, {15, 43, 39, 41}, {18, 41, 46}, {
    10, 46, 8}, {13, 7, 8, 7}, {7, 7, 10}, {36, 45, 39, 2, 8}, {4, 44, 
    35, -9}, {42, "Flatten", 2, 3, 7, 2, 0, 5, 2, 1, 15}, {
    42, "Join", 2, 1, 15, 2, 1, 8, 2, 1, 12}, {34, 1, 2, 15, 34, 2, 15}, {
    42, "Join", 2, 1, 12, 2, 1, 15, 2, 1, 17}, {1}}, 
   Function[{$CellContext`space, $CellContext`unireactions, \
$CellContext`unirates, $CellContext`uniindex, $CellContext`bireactions, \
$CellContext`birates, $CellContext`biindex, $CellContext`tmax}, 
    Module[{$CellContext`d = Length[$CellContext`space], $CellContext`n = 
      Length[
        First[$CellContext`space]], $CellContext`m = Length[
        First[
         First[$CellContext`space]]], $CellContext`d1, $CellContext`d2, \
$CellContext`n1, $CellContext`n2, $CellContext`m1, $CellContext`m2, \
$CellContext`S = $CellContext`space, $CellContext`R, $CellContext`id, \
$CellContext`idd, 
      K, $CellContext`nb, $CellContext`nbnb, $CellContext`i, $CellContext`j, \
$CellContext`k, $CellContext`i2, $CellContext`j2, $CellContext`k2, \
$CellContext`di, $CellContext`dj, $CellContext`dk, $CellContext`r, \
$CellContext`s1 = 1, $CellContext`s2 = 
      1, $CellContext`snb, $CellContext`new1, $CellContext`new2, \
$CellContext`ksum, $CellContext`newp, $CellContext`t = 
      0., $CellContext`dt, $CellContext`events = 
      0, $CellContext`haltedq, $CellContext`digit, $CellContext`digits, \
$CellContext`residue}, K = Ceiling[
        Log[
        2, 1 + 7 $CellContext`d $CellContext`n $CellContext`m]]; \
$CellContext`R = Table[0., {2^(K + 1)}]; 
     Do[$CellContext`r = Part[$CellContext`uniindex, 
          
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]]; $CellContext`id = 
        2^K + ($CellContext`i - 
           1) $CellContext`n $CellContext`m + ($CellContext`j - 
           1) $CellContext`m + ($CellContext`k - 1); While[
         And[$CellContext`r > 0, 
          Part[$CellContext`unireactions, $CellContext`r, 1] == 
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]], AddTo[
           Part[$CellContext`R, $CellContext`id], 
           Part[$CellContext`unirates, $CellContext`r]]; 
         Increment[$CellContext`r]], {$CellContext`i, $CellContext`d}, \
{$CellContext`j, $CellContext`n}, {$CellContext`k, $CellContext`m}]; 
     Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
        Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {0, 0,
           1}}, $CellContext`nb]; $CellContext`d1 = 
        Max[1, 1 - $CellContext`di]; $CellContext`d2 = 
        Min[$CellContext`d, $CellContext`d - $CellContext`di]; \
$CellContext`n1 = Max[1, 1 - $CellContext`dj]; $CellContext`n2 = 
        Min[$CellContext`n, $CellContext`n - $CellContext`dj]; \
$CellContext`m1 = Max[1, 1 - $CellContext`dk]; $CellContext`m2 = 
        Min[$CellContext`m, $CellContext`m - $CellContext`dk]; 
       Do[$CellContext`r = Part[$CellContext`biindex, 
            
            Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k], 
            
            Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]]; \
$CellContext`id = 
          2^K + $CellContext`nb $CellContext`d $CellContext`n $CellContext`m + \
($CellContext`i - 1) $CellContext`n $CellContext`m + ($CellContext`j - 
             1) $CellContext`m + ($CellContext`k - 1); While[
           
           And[$CellContext`r > 0, 
            Part[$CellContext`bireactions, $CellContext`r, {1, 2}] == {
              
              Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k], 
              
              Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]}], AddTo[
             Part[$CellContext`R, $CellContext`id], 
             Part[$CellContext`birates, $CellContext`r]]; 
           
           Increment[$CellContext`r]], {$CellContext`i, $CellContext`d1, \
$CellContext`d2}, {$CellContext`j, $CellContext`n1, $CellContext`n2}, \
{$CellContext`k, $CellContext`m1, $CellContext`m2}], {$CellContext`nb, 1, 6}]; 
     Do[Part[$CellContext`R, $CellContext`id] = 
       Part[$CellContext`R, 2 $CellContext`id] + 
        Part[$CellContext`R, 2 $CellContext`id + 1], {$CellContext`id, 2^K - 
        1, 1, -1}]; While[
       And[$CellContext`t < $CellContext`tmax, Part[$CellContext`R, 1] > 
        0], $CellContext`dt = (-Log[
            RandomReal[]])/Part[$CellContext`R, 1]; 
       If[$CellContext`t + $CellContext`dt < $CellContext`tmax, 
         AddTo[$CellContext`t, $CellContext`dt]; 
         Increment[$CellContext`events], $CellContext`t = $CellContext`tmax; 
         Break[]]; $CellContext`id = 1; 
       While[$CellContext`id < 2^K, $CellContext`id = 
         If[RandomReal[] Part[$CellContext`R, $CellContext`id] < 
           Part[$CellContext`R, 2 $CellContext`id], 2 $CellContext`id, 
           2 $CellContext`id + 1]]; $CellContext`idd = $CellContext`id; 
       SubtractFrom[$CellContext`idd, 2^K]; $CellContext`nb = 
        Quotient[$CellContext`idd, $CellContext`d $CellContext`n \
$CellContext`m]; 
       SubtractFrom[$CellContext`idd, $CellContext`nb $CellContext`d \
$CellContext`n $CellContext`m]; $CellContext`i = 
        Quotient[$CellContext`idd, $CellContext`n $CellContext`m] + 1; 
       SubtractFrom[$CellContext`idd, ($CellContext`i - 
          1) $CellContext`n $CellContext`m]; $CellContext`j = 
        Quotient[$CellContext`idd, $CellContext`m] + 1; 
       SubtractFrom[$CellContext`idd, ($CellContext`j - 
          1) $CellContext`m]; $CellContext`k = $CellContext`idd + 1; 
       If[$CellContext`nb == 
         0, $CellContext`s1 = 
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]; $CellContext`r = 
          Part[$CellContext`uniindex, $CellContext`s1]; $CellContext`newp = 
          RandomReal[] 
           Part[$CellContext`R, $CellContext`id]; $CellContext`ksum = 
          Part[$CellContext`unirates, $CellContext`r]; While[
           And[$CellContext`newp > $CellContext`ksum, 
            Part[$CellContext`unireactions, $CellContext`r + 1, 
              1] == $CellContext`s1], AddTo[$CellContext`ksum, 
             Part[$CellContext`unirates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; $CellContext`new1 = 
          Part[$CellContext`unireactions, $CellContext`r, 2]; 
         Part[$CellContext`S, $CellContext`i, $CellContext`j, $CellContext`k] = \
$CellContext`new1; $CellContext`r = 
          Part[$CellContext`uniindex, $CellContext`new1]; 
         Part[$CellContext`R, $CellContext`id] = If[$CellContext`r == 0, 0, 
            Part[$CellContext`unirates, $CellContext`r]]; 
         While[Part[$CellContext`unireactions, $CellContext`r + 1, 
             1] == $CellContext`new1, AddTo[
             Part[$CellContext`R, $CellContext`id], 
             Part[$CellContext`unirates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; 
         While[$CellContext`id > 
           1, $CellContext`id = Quotient[$CellContext`id, 2]; 
           Part[$CellContext`R, $CellContext`id] = 
            Part[$CellContext`R, 2 $CellContext`id] + 
             Part[$CellContext`R, 2 $CellContext`id + 1]]; 
         Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
            Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
              0, 0, 1}}, $CellContext`nb]; If[
             And[
             1 <= $CellContext`i + $CellContext`di <= $CellContext`d, 
              1 <= $CellContext`j + $CellContext`dj <= $CellContext`n, 
              1 <= $CellContext`k + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
              Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]; \
$CellContext`r = 
              Part[$CellContext`biindex, $CellContext`new1, $CellContext`snb]; \
$CellContext`id = 
              2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i - 
                 1) $CellContext`n $CellContext`m + ($CellContext`j - 
                 1) $CellContext`m + ($CellContext`k - 1); 
             Part[$CellContext`R, $CellContext`id] = 
              If[$CellContext`r == 0, 0, 
                Part[$CellContext`birates, $CellContext`r]]; 
             While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                 2}] == {$CellContext`new1, $CellContext`snb}, AddTo[
                 Part[$CellContext`R, $CellContext`id], 
                 Part[$CellContext`birates, $CellContext`r + 1]]; 
               Increment[$CellContext`r]]; 
             While[$CellContext`id > 
               1, $CellContext`id = Quotient[$CellContext`id, 2]; 
               Part[$CellContext`R, $CellContext`id] = 
                Part[$CellContext`R, 2 $CellContext`id] + 
                 Part[$CellContext`R, 2 $CellContext`id + 
                   1]]; $CellContext`nbnb = 
              Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
              Part[$CellContext`biindex, $CellContext`snb, $CellContext`new1]; \
$CellContext`id = 
              2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i + $CellContext`di - 
                 1) $CellContext`n $CellContext`m + ($CellContext`j + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k + $CellContext`dk - 1); 
             Part[$CellContext`R, $CellContext`id] = 
              If[$CellContext`r == 0, 0, 
                Part[$CellContext`birates, $CellContext`r]]; 
             While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                 2}] == {$CellContext`snb, $CellContext`new1}, AddTo[
                 Part[$CellContext`R, $CellContext`id], 
                 Part[$CellContext`birates, $CellContext`r + 1]]; 
               Increment[$CellContext`r]]; 
             While[$CellContext`id > 
               1, $CellContext`id = Quotient[$CellContext`id, 2]; 
               Part[$CellContext`R, $CellContext`id] = 
                Part[$CellContext`R, 2 $CellContext`id] + 
                 Part[$CellContext`R, 2 $CellContext`id + 
                   1]]], {$CellContext`nb, 1, 
            6}], {$CellContext`di, $CellContext`dj, $CellContext`dk} = 
          Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {0, 
            0, 1}}, $CellContext`nb]; {$CellContext`i2, $CellContext`j2, \
$CellContext`k2} = {$CellContext`i + $CellContext`di, $CellContext`j + \
$CellContext`dj, $CellContext`k + $CellContext`dk}; $CellContext`s1 = 
          
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]; $CellContext`s2 = 
          Part[$CellContext`S, $CellContext`i2, $CellContext`j2, \
$CellContext`k2]; $CellContext`r = 
          Part[$CellContext`biindex, $CellContext`s1, $CellContext`s2]; \
$CellContext`newp = 
          RandomReal[] 
           Part[$CellContext`R, $CellContext`id]; $CellContext`ksum = 
          Part[$CellContext`birates, $CellContext`r]; While[
           
           And[$CellContext`newp > $CellContext`ksum, 
            Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
              2}] == {$CellContext`s1, $CellContext`s2}], 
           AddTo[$CellContext`ksum, 
             Part[$CellContext`birates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; {$CellContext`new1, $CellContext`new2} = 
          Part[$CellContext`bireactions, $CellContext`r, {3, 4}]; 
         Part[$CellContext`S, $CellContext`i, $CellContext`j, $CellContext`k] = \
$CellContext`new1; 
         Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk] = \
$CellContext`new2; 
         If[$CellContext`s1 != $CellContext`new1, $CellContext`r = 
            Part[$CellContext`uniindex, $CellContext`new1]; $CellContext`id = 
            2^K + ($CellContext`i - 
               1) $CellContext`n $CellContext`m + ($CellContext`j - 
               1) $CellContext`m + ($CellContext`k - 1); 
           Part[$CellContext`R, $CellContext`id] = 
            If[$CellContext`r == 0, 0, 
              Part[$CellContext`unirates, $CellContext`r]]; 
           While[Part[$CellContext`unireactions, $CellContext`r + 1, 
               1] == $CellContext`new1, AddTo[
               Part[$CellContext`R, $CellContext`id], 
               Part[$CellContext`unirates, $CellContext`r + 1]]; 
             Increment[$CellContext`r]]; 
           While[$CellContext`id > 
             1, $CellContext`id = Quotient[$CellContext`id, 2]; 
             Part[$CellContext`R, $CellContext`id] = 
              Part[$CellContext`R, 2 $CellContext`id] + 
               Part[$CellContext`R, 2 $CellContext`id + 1]]]; 
         If[$CellContext`s2 != $CellContext`new2, $CellContext`r = 
            Part[$CellContext`uniindex, $CellContext`new2]; $CellContext`id = 
            2^K + ($CellContext`i2 - 
               1) $CellContext`n $CellContext`m + ($CellContext`j2 - 
               1) $CellContext`m + ($CellContext`k2 - 1); 
           Part[$CellContext`R, $CellContext`id] = 
            If[$CellContext`r == 0, 0, 
              Part[$CellContext`unirates, $CellContext`r]]; 
           While[Part[$CellContext`unireactions, $CellContext`r + 1, 
               1] == $CellContext`new2, AddTo[
               Part[$CellContext`R, $CellContext`id], 
               Part[$CellContext`unirates, $CellContext`r + 1]]; 
             Increment[$CellContext`r]]; 
           While[$CellContext`id > 
             1, $CellContext`id = Quotient[$CellContext`id, 2]; 
             Part[$CellContext`R, $CellContext`id] = 
              Part[$CellContext`R, 2 $CellContext`id] + 
               Part[$CellContext`R, 2 $CellContext`id + 1]]]; 
         If[$CellContext`s1 != $CellContext`new1, 
           
           Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
             Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
               0, 0, 1}}, $CellContext`nb]; If[
              And[
              1 <= $CellContext`i + $CellContext`di <= $CellContext`d, 
               1 <= $CellContext`j + $CellContext`dj <= $CellContext`n, 
               1 <= $CellContext`k + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
               Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]; \
$CellContext`r = 
               Part[$CellContext`biindex, $CellContext`new1, \
$CellContext`snb]; $CellContext`id = 
               2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j - 
                  1) $CellContext`m + ($CellContext`k - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`new1, $CellContext`snb}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]; $CellContext`nbnb = 
               Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
               Part[$CellContext`biindex, $CellContext`snb, \
$CellContext`new1]; $CellContext`id = 
               2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i + $CellContext`di - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k + $CellContext`dk - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`snb, $CellContext`new1}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]], {$CellContext`nb, 1, 6}]]; 
         If[$CellContext`s2 != $CellContext`new2, 
           
           Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
             Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
               0, 0, 1}}, $CellContext`nb]; If[
              And[
              1 <= $CellContext`i2 + $CellContext`di <= $CellContext`d, 
               1 <= $CellContext`j2 + $CellContext`dj <= $CellContext`n, 
               1 <= $CellContext`k2 + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
               Part[$CellContext`S, $CellContext`i2 + $CellContext`di, \
$CellContext`j2 + $CellContext`dj, $CellContext`k2 + $CellContext`dk]; \
$CellContext`r = 
               Part[$CellContext`biindex, $CellContext`new2, \
$CellContext`snb]; $CellContext`id = 
               2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i2 - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j2 - 
                  1) $CellContext`m + ($CellContext`k2 - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`new2, $CellContext`snb}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]; $CellContext`nbnb = 
               Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
               Part[$CellContext`biindex, $CellContext`snb, \
$CellContext`new2]; $CellContext`id = 
               2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i2 + $CellContext`di - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j2 + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k2 + $CellContext`dk - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`snb, $CellContext`new2}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]], {$CellContext`nb, 1, 6}]]; Null]; 
       Null]; $CellContext`haltedq = 
      Boole[Part[$CellContext`R, 1] == 
        0.]; $CellContext`residue = $CellContext`t; $CellContext`digits = 
      Table[$CellContext`digit = 
         Floor[$CellContext`residue]; $CellContext`residue = 
         10 $CellContext`residue - 
          10 $CellContext`digit; $CellContext`digit, {20}]; Join[
       Join[
        Flatten[$CellContext`S], $CellContext`digits], {$CellContext`events, \
$CellContext`haltedq}]]], Evaluate],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.855090645763854*^9, 3.855093612941012*^9, 
  3.855416831992091*^9, 3.8555196008888907`*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"c023362b-18e8-4c36-b820-5a3763c32262"]
}, Open  ]],

Cell["\<\
Test on diffusion-limited aggregation.   About 100x to 200x faster in this \
instance.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0t0vW3EAh/GmS4SNXhTTyQgJ9bJeyGzRLMviLDKJ4UK4E2Zok1VGhAQ5
ybqlVjpjGNOm0Qv1kqboKo1O6DrMEmXTVifBJNaklTgYtl4Iut/3XDz5/ANP
4tPaomouh8MRkuCYIfSPv4mh7FTgGOaLCgNwJamelac1XPKbGSp7c4YbSbw+
MJsMtSpJGmxxGWVwOPGiBj5ReIViYvTb1TSYPj3neUCUdno34H3HcV8tUe9O
+QDt3FKFW8lQ6pOCNihPp+94iJrMq3dh1HNXPuSbTIVw53X3wgbx1vbYErwp
aJndJdZ1JM3Be5E5X6BIG3TDh2rnNmwS0fswuB/3F/LNqQGoGxSdwaLG5ZDf
xPPckWvwJFZ5A5bW/+qF8gaJAQ7umSZgXVA2CR/ZfBaY0xr6GVpfhAm8xO9l
3xLgzBrvNqzKEGdBOvWf3EeMWXr2HnrVAg0Mz1NMQTrPcQQldg/rEe9niZ9o
+7FXAQ8lC1IYPx9eA/2VzCvIP3WooN78pgt+LF/tgZ3xlgFYPOJktcp2dXBI
t6WHEc7s9ktia8woa8hXZ0ZEG/mAGs+CVuPjfiiM42lgxcHQeDeRXp9kjVWe
dpmJL6mdd1BVaWy/8omhFs+lHfA/xQtXmg==
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"f8587eb8-a439-4373-bb55-3c3058d3b55f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cDLAcrn", ",", "cDLAstate2D"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", "DLAinit2D"}], "]"}]}], ";", 
  RowBox[{"time2D", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.855090019952285*^9, 3.8550900701215982`*^9}, {
  3.855090692002289*^9, 3.855090694443894*^9}, {3.855096252608983*^9, 
  3.855096254566833*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"b935061e-725c-4554-8236-64d48baf8902"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cDLAstate2D", ",", "DLAcoloring", ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time2D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.826500688326241*^9, 3.826500694055293*^9}, {
   3.82650283672849*^9, 3.826502882241357*^9}, {3.826503300477007*^9, 
   3.826503303739875*^9}, {3.827453103233713*^9, 3.827453122908515*^9}, {
   3.827453175063757*^9, 3.8274531817062473`*^9}, {3.827453302755995*^9, 
   3.8274533133398447`*^9}, {3.827454251511726*^9, 3.827454259992944*^9}, {
   3.827454333925359*^9, 3.827454382546093*^9}, {3.827454412590201*^9, 
   3.8274544328428164`*^9}, {3.8274545518620358`*^9, 
   3.8274545523731403`*^9}, {3.827454951211404*^9, 3.82745495155136*^9}, {
   3.827455000599724*^9, 3.827455033119273*^9}, {3.8276984359836597`*^9, 
   3.8276984401508093`*^9}, {3.8293168551257057`*^9, 3.829316893634926*^9}, {
   3.829317001432323*^9, 3.829317033298839*^9}, {3.829332052400035*^9, 
   3.8293320674226637`*^9}, {3.8293324526107264`*^9, 
   3.8293324529278393`*^9}, {3.829350859251491*^9, 3.829350859721148*^9}, {
   3.82942631340781*^9, 3.829426352340253*^9}, {3.829432440703411*^9, 
   3.829432447242998*^9}, {3.829432481164239*^9, 3.8294324843907967`*^9}, {
   3.855090702978097*^9, 3.855090747527546*^9}, 3.855095696561808*^9},
 CellLabel->
  "In[327]:=",ExpressionUUID->"94273af3-179f-4006-8454-8531df46c096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cDLAstate2D", "=", 
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"cDLAcrn", ",", "cDLAstate2D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"time2D", "+=", "dt"}]}], ",", "10000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.855090760888543*^9, 3.8550907820378933`*^9}, 
   3.8550962109857607`*^9},
 CellLabel->
  "In[328]:=",ExpressionUUID->"74bfe14b-491b-40cc-a088-c93d74d4c945"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cDLAcrn", ",", "cDLAstate3D"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", "DLAinit3D"}], "]"}]}], ";", 
  RowBox[{"time3D", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.855090019952285*^9, 3.8550900701215982`*^9}, {
  3.855090692002289*^9, 3.855090694443894*^9}, {3.8550953243970547`*^9, 
  3.855095328576483*^9}, {3.855096272530758*^9, 3.855096275359364*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"2d4b6239-8281-460c-9f0e-cba50c37efa0"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cDLAstate3D", ",", "DLAcoloring", ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"G", ",", "W"}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time3D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.826500688326241*^9, 3.826500694055293*^9}, {
   3.82650283672849*^9, 3.826502882241357*^9}, {3.826503300477007*^9, 
   3.826503303739875*^9}, {3.827453103233713*^9, 3.827453122908515*^9}, {
   3.827453175063757*^9, 3.8274531817062473`*^9}, {3.827453302755995*^9, 
   3.8274533133398447`*^9}, {3.827454251511726*^9, 3.827454259992944*^9}, {
   3.827454333925359*^9, 3.827454382546093*^9}, {3.827454412590201*^9, 
   3.8274544328428164`*^9}, {3.8274545518620358`*^9, 
   3.8274545523731403`*^9}, {3.827454951211404*^9, 3.82745495155136*^9}, {
   3.827455000599724*^9, 3.827455033119273*^9}, {3.8276984359836597`*^9, 
   3.8276984401508093`*^9}, {3.8293168551257057`*^9, 3.829316893634926*^9}, {
   3.829317001432323*^9, 3.829317033298839*^9}, {3.829332052400035*^9, 
   3.8293320674226637`*^9}, {3.8293324526107264`*^9, 
   3.8293324529278393`*^9}, {3.829350859251491*^9, 3.829350859721148*^9}, {
   3.82942631340781*^9, 3.829426352340253*^9}, {3.829432440703411*^9, 
   3.829432447242998*^9}, {3.829432481164239*^9, 3.8294324843907967`*^9}, {
   3.855090702978097*^9, 3.855090747527546*^9}, 3.855095696561808*^9, {
   3.855096279704452*^9, 3.855096298665676*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"8219f83c-2417-45a3-9aee-ba3199fddfa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cDLAstate3D", "=", 
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"cDLAcrn", ",", "cDLAstate3D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"time3D", "+=", "dt"}]}], ",", "2000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.855090760888543*^9, 3.8550907820378933`*^9}, 
   3.8550962109857607`*^9, {3.855096308912467*^9, 3.85509631326712*^9}, {
   3.855096394479141*^9, 3.855096413023674*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"78b6857e-fbc8-4518-855b-1c7b7d57c2d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "turn", " ", "off", " ", "dynamic", " ", "statements", " ", "and", " ", 
     "re"}], "-", 
    RowBox[{
    "initialize", " ", "the", " ", "compiled", " ", "states", " ", "before", 
     " ", "running", " ", "this", " ", "timing", " ", "comparison"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Timing", "[", 
       RowBox[{
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"DLAcrn", ",", "DLAinit2D", ",", "20"}], "]"}], ";"}], "]"}],
       ",", 
      RowBox[{"Timing", "[", 
       RowBox[{
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"cDLAcrn", ",", "cDLAstate2D", ",", "20"}], "]"}], ";"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Timing", "[", 
       RowBox[{
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"DLAcrn", ",", "DLAinit3D", ",", "20"}], "]"}], ";"}], "]"}],
       ",", 
      RowBox[{"Timing", "[", 
       RowBox[{
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"cDLAcrn", ",", "cDLAstate3D", ",", "20"}], "]"}], ";"}], 
       "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.855096483681923*^9, 3.8550966599763937`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"c8f7055a-74e0-47da-90a2-b96c71e4e9f0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"21.814292`", ",", "Null"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.013465`", ",", "Null"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"197.163351`", ",", "Null"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.841176`", ",", "Null"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.855096651258312*^9, 3.855096895399547*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"e3bccfe5-5a46-4751-97e5-4961aa72e8cf"]
}, Open  ]],

Cell["\<\
Test on wire-world-inspired circuitry.   About 300x faster in this instance.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0t9LU3EAhvGxQKx0F9N0SoqC6dRdiBlKRHhkFJh6IeaVaKZt4ERFDJYc
aMVsOk3zV7ox3IXTZEydC2mJrtXUoKU25xTMBBs4wVOms12UOr/vuXj4/ANP
4sP64kdcDocjJMExY+gfn5yh7FTgEBaIigLwa1IjK09nPOM/YajczRluBDFq
cPYa1KklqbB51SSDI4mntfCB0pucQ7zycikVpr2b89wmSju9G/CW87C/nmhw
pwxAO7dM6VYxlOaosBUq0ugsD1F7/dINGFm3WgD5ZnMR3H7R7dggpm+NLcKr
gubZHWJDR9IcvBkh/ghFuqAb5mlcW1AuovdhcD/uGPItwgDUD4n+weLHX0J+
Ek/ujl6GR7GqGFjW+KMXKpokRji0Z56ADUHZJLxj252G4pbQD9D69KLAS1wu
/5wAZ77xMmF1Rk42pIV/FbvE6MWaPujVCLQwLF/5FtL5zgMosXtYD3jr931E
28peJfwtcUhh/KewWuirYp5Dvt+phgZLexecqljqgZ3x04OwZNTFapXt6OGw
/rsBhrty286ILdFvWEMWXBnhreQDajwbWk33XsPkOJ4WVv4aHu8m0muTrLEq
f5eF+IzafgXVVaa2C+8Zav5E2gEXSv/3Qm66vw8KVjInoNgpN8NzyE1nmw==

  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"77ffc978-847c-4ea7-bdcb-f508780085a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cCircuits", ",", "cLayout"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"circuits", ",", "layout"}], "]"}]}], ";", 
  RowBox[{"circuittime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.855097019733766*^9, 3.855097042087631*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"982d5fc1-1efd-4050-b6c7-a5a4b742766f"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cLayout", ",", "circuitcolors", ",", 
    RowBox[{"PlotLabel", "\[Rule]", "circuittime"}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8550970487760477`*^9, 3.855097070637308*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"d119e9ec-f6f7-47da-baf8-d10ffb3678e3"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cLayout", "=", 
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"cCircuits", ",", "cLayout", ",", "dt"}], "]"}]}], ";", 
      RowBox[{"circuittime", "+=", "dt"}]}], ",", "10000"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}, {3.821671637621358*^9, 3.821671656854603*^9}, {
   3.821751523559148*^9, 3.8217515565243597`*^9}, {3.821760328115385*^9, 
   3.8217603486219893`*^9}, {3.855097089334388*^9, 3.855097117417708*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"8ea800b9-9712-4820-8d39-feb2943566a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "turn", " ", "off", " ", "dynamic", " ", "statements", " ", "and", " ", 
     "re"}], "-", 
    RowBox[{
    "initialize", " ", "the", " ", "compiled", " ", "states", " ", "before", 
     " ", "running", " ", "this", " ", "timing", " ", "comparison"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"circuits", ",", "layout", ",", "1000"}], "]"}], ";"}], "]"}],
      ",", 
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"cCircuits", ",", "cLayout", ",", "1000"}], "]"}], ";"}], 
      "]"}]}], "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.855096483681923*^9, 3.8550966599763937`*^9}, {
  3.855097143236876*^9, 3.8550971879103622`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"36564e57-e158-450c-b8a6-c6ceffb2744a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"14.93633`", ",", "Null"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.056813`", ",", "Null"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.855097171790588*^9, 3.8550972033694897`*^9}},
 CellLabel->
  "Out[233]=",ExpressionUUID->"bfe0c308-e831-4691-bb1c-c38668021455"]
}, Open  ]],

Cell["\<\
Test on asynchronous Greenberg-Hastings rules... on a larger field.  About \
25x faster in this instance, for 1-second simulations.  Initializing data \
structures within each simulation call (the rate trees \
aren\[CloseCurlyQuote]t stored in the CompiledSurfaceCRNState data structure) \
is a substantial fraction of that time, as evidenced by 10-second simulations \
being 150x faster.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.855097308017599*^9, 3.855097309356842*^9}, {3.85509734803833*^9, 
  3.85509735202533*^9}, {3.855097758012417*^9, 3.855097763191411*^9}, {
  3.855098245419495*^9, 3.855098331640648*^9}, {3.855099702270423*^9, 
  3.855099745082176*^9}, {3.8550997978246393`*^9, 3.855099869185637*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"9db2c07f-2d85-4417-a576-b92cb4b6c026"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AGHstate", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"750", "/", "2"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "m"}], "&&", 
          RowBox[{"j", ">", "m"}]}], ",", "A", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ">", "m"}], "&&", 
            RowBox[{"j", ">", "m"}]}], ",", "R", ",", "Q"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.829698067237195*^9, 3.82969806970761*^9}, {
  3.829698820129071*^9, 3.829698820315239*^9}, {3.846114077131372*^9, 
  3.846114082333248*^9}, {3.8550973953804207`*^9, 3.855097395732511*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"6763e432-5d5f-4cd4-9311-874858575e3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cAGH", ",", "cAGHstate"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"AGH", ",", "AGHstate"}], "]"}]}], ";", 
  RowBox[{"AGHtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8550973591804*^9, 3.855097392243544*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"b6c3fc40-6add-4c46-9a1c-81cc5c600cf8"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cAGHstate", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", "Red"}], ",", 
      RowBox[{"Q", "\[Rule]", 
       RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
      RowBox[{"R", "\[Rule]", "Blue"}]}], "}"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "AGHtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8550970487760477`*^9, 3.855097070637308*^9}, {
  3.855097416782008*^9, 3.8550974271559343`*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"12c71621-a26f-43b5-bc1a-fe974169703a"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dt", "=", "5"}], "}"}], ",", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cAGHstate", "=", 
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"cAGH", ",", "cAGHstate", ",", "dt"}], "]"}]}], ";", 
      RowBox[{"AGHtime", "+=", "dt"}]}], ",", "1000"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8216679462299957`*^9, 
   3.821668003359963*^9}, 3.8276827845531607`*^9, 3.827685343053816*^9, {
   3.846527758274629*^9, 3.846527760101314*^9}, {3.846527797319971*^9, 
   3.846527799685843*^9}, {3.855097444797789*^9, 3.855097501552655*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"8c9f02e2-e3a9-4cca-86cc-847e1876e4c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "turn", " ", "off", " ", "dynamic", " ", "statements", " ", "and", " ", 
     "re"}], "-", 
    RowBox[{
    "initialize", " ", "the", " ", "compiled", " ", "states", " ", "before", 
     " ", "running", " ", "this", " ", "timing", " ", "comparison"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"AGH", ",", "AGHstate", ",", "1"}], "]"}], ";"}], "]"}], ",", 
     
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"cAGH", ",", "cAGHstate", ",", "1"}], "]"}], ";"}], "]"}]}], 
    "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.855096483681923*^9, 3.8550966599763937`*^9}, {
  3.855097143236876*^9, 3.8550971879103622`*^9}, {3.855097621821085*^9, 
  3.855097667452527*^9}, {3.855098944815366*^9, 3.855098948746962*^9}, {
  3.855099776976041*^9, 3.85509977840451*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"bf78b276-5814-46c5-a16f-e59ee9480772"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"37.565108`", ",", "Null"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.430233`", ",", "Null"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.855099823160552*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"0f8a1477-004e-4b71-9fdb-7e2cc15c542a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"RunSurfaceCRN", "[", 
       RowBox[{"AGH", ",", "AGHstate", ",", "10"}], "]"}], ";"}], "]"}], ",", 
    
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"RunSurfaceCRN", "[", 
       RowBox[{"cAGH", ",", "cAGHstate", ",", "10"}], "]"}], ";"}], "]"}]}], 
   "}"}], "}"}]], "Input",
 CellChangeTimes->{{3.855096483681923*^9, 3.8550966599763937`*^9}, {
   3.855097143236876*^9, 3.8550971879103622`*^9}, {3.855097621821085*^9, 
   3.855097667452527*^9}, {3.855098944815366*^9, 3.855098948746962*^9}, 
   3.85509978205169*^9},ExpressionUUID->"53a799ee-1139-4fe0-aca7-\
ed4b6ab7efa9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"500.132646`", ",", "Null"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3.005839`", ",", "Null"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.855097712405191*^9, 3.855099457275015*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"6efec142-aed7-40a8-b86f-5564d1b52e25"]
}, Open  ]],

Cell["\<\
Additional notes on asynchronous Greenberg-Hastings: 
\tChanging the A+Q \[RightArrow] A+A rate to 1.5 or 2.0 makes the wavefront \
more stable, if you want to try that.
\tIncreasing the array size to 300x300 is now feasible... in fact, 750x750 \
(as in Sam Clamon\[CloseCurlyQuote]s on-line simulator) can be handled, just \
barely.
\tWith dt=0.1, the faster simulator spends a lot of time building the rate \
tree, and the speed-up is not obvious.  but with dt=10, we get a speed-up of \
100x, which is more satisfying.
\tWatching simulations with dt=10,  the first few steps (from initial square \
fields) are slow, while subsequent steps are faster -- presumably because of \
how many sites have moves available.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.829433882758545*^9, 3.8294338876459627`*^9}, {3.829434196798414*^9, 
  3.82943420233631*^9}, {3.829434237052841*^9, 3.829434259966317*^9}, {
  3.829434350100005*^9, 3.829434368456011*^9}, {3.829697952901225*^9, 
  3.829698192910276*^9}, {3.829698344446211*^9, 3.829698401960916*^9}, {
  3.829698452786035*^9, 3.82969855512539*^9}, {3.8296986553740873`*^9, 
  3.8296987336853952`*^9}, {3.8465282906957912`*^9, 3.8465283152023153`*^9}, {
  3.846528604670764*^9, 3.846528617617909*^9}, {3.85509841470457*^9, 
  3.855098417628366*^9}, {3.8550984855268393`*^9, 3.855098532418016*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"e3e2b6f9-fe30-4325-8327-60dfb872ee98"],

Cell["\<\
Test on the critter.  Of note here is that the color rules are general \
pattern matching, which (thankfully) are handled just fine.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0t9LUwEchvGxSCx1F7NySZMGpk53IWYoEeGJUWDmhZRXUpm2QRMVKVhy
oBWz6VqaaeXGcBcukzF1LaQl/lgtDVpmcy2hTLCBMzxlutqFmev7nouHzz/w
yC41VFwWCgQCOQUHHIm/IlqO8TKxdVimKI/Bd5lNvCKrY1t8nWNKPo8KU8l9
PWOHoNWoksPmOacGPpb9q4MX9eGsYnLv3Rk5zH0+HjpOqtvD8/CYf/1BA2kP
Zj+CXmGVPmjgGPPGmVaoy2ULQ6Tl8O4jcE/9XBkUu1zlcPF2p2+ezFsYmIYH
JM1jS2SjKXMcHk1VvoQKazwIT5gDC1CrYFdhfFX6G4rdOTFo61VswoprbxO+
kVun+pPgRrphP6xq+toFdVdVDti74hqCjXHNMDw5sTwClS2Jk9BzY5ckTL4/
/+YgHP0gKoC1+cVFkM35o1sm06avdMOwWWKByaX6Z5At9a9BlTfEuyb6dC5C
TsyuVMOfKp8aZrxKroORGu4WFEf9Rmh33+mATy/M3IftGSM98Gx/gNejWbLB
PtsXO0wJlLRtky1pT3gTpgL5Ka30ATNYBD3O0w9hllRkgdU/+gY7SfbjMG+6
IdrhJm8yi/egscbZtuMFx7zeUpvgVOXfLijMi3ZDyWzBEFT6tS5o+h6R7iTr
fZsy+B+QznA3
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"1022c539-749c-435f-9d22-f25bd629f5fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cCritter", ",", "cCritterstate"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"critter", ",", "critterstate"}], "]"}]}], ";", 
  RowBox[{"crittertime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8550973591804*^9, 3.855097392243544*^9}, {
   3.855098606157872*^9, 3.855098647408101*^9}, 3.855098759922367*^9},
 CellLabel->
  "In[272]:=",ExpressionUUID->"4243e3ef-aa42-475f-82c9-87a6583e2582"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cCritterstate", ",", "critterrules", ",", 
    RowBox[{"PlotLabel", "\[Rule]", "crittertime"}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8550970487760477`*^9, 3.855097070637308*^9}, {
  3.855097416782008*^9, 3.8550974271559343`*^9}, {3.855098772640065*^9, 
  3.855098787464149*^9}, {3.855099997515523*^9, 3.855099997995017*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"28b0ebc1-6378-4ddb-8edd-2b1d8e1bec63"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dt", "=", "0.5"}], "}"}], ",", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"cCritterstate", "=", 
       RowBox[{"RunSurfaceCRN", "[", 
        RowBox[{"cCritter", ",", "cCritterstate", ",", "dt"}], "]"}]}], ";", 
      RowBox[{"crittertime", "+=", "dt"}]}], ",", "10000"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}, {3.8550987221640797`*^9, 3.855098750057246*^9}, {
   3.85510003586666*^9, 3.855100039971669*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"d54cb5ec-c931-44da-adff-14daf239ee2a"],

Cell[TextData[{
 "Finally, we\[CloseCurlyQuote]ll test the space-bounded Turing machine -- \
with a long tape to copy -- just to show off the ",
 StyleBox["InfoRunSurfaceCRN",
  FontWeight->"Bold"],
 " command.  This way of testing for halting is much faster.  Also, we get \
completion time and reaction event counts, if we want them."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJwd0t9LU3EAhvGxaFjpoFm5rEkDs+kWLCuUCPHIKFi2CymvrDRrgyYqUrDk
QCtm07k0f1RuDHfhMhlT10KaorZaGrTM5lpCmWADZ3jKdLULM9f3PRcPn3/g
EV+uKbnK5XA4UhLscyb9iuoYykfFV2GxTBWH7zLrWPk256bgJkMVfh7hphL3
dI0ehDaTOhvWz7i08LH4XxUsN0Sy8om7701lw5znY+ECoqYlMgtPBlYf1BAd
oUOPoI9bZggZGcqydrYR6nPoY2Gi9ej243BX9UwxFLjdKjh/t80/S5TO9U3C
/cL60QVirTlzDJ5IVbyEMlsiBIsswTmok9HLMLEs+g0FHkkc2rtl67Dkxlve
N+LG6d4dcC3duBeW1X3tgPrraifsXnIPwNqEdhCeGl8cgoqGpBfQe2ubMEJ8
f/HNATjygZ8Lr8jz8yAt+aNfJKZNXuuEEYvQCpOVhmeQVgZWoNoXZl3hfzof
JY5PL1XAn2q/Bma8Sq6C0UrmDhTEAibo8DS3wqeXptphS8ZQFzzXG2T1ahfs
sMf+xQFTgoVNm8SGtCesvImgPKWRfED150Gv68xDmCXiW2HFj57+NiL9cZA1
3Rhr9RBvU/P3oanS1bRlmKFeb2jMcKL0bwfkSmOdUDidOwAVAZ0bmr9HRVuJ
1f51MVQ18yTwyIWdh+E+ZXsBtMmFRfA/Vox8Ew==
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"3eb08922-6198-4f60-b179-d40e2a01f107"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"surfaceSBTM", ",", "SBTMstate"}], "}"}], "=", 
    RowBox[{"SpaceBoundedTM2SurfaceCRN", "[", 
     RowBox[{"copyTM", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "0"}], "}"}], ",", "1", ",", "1", ",", "0", ",", 
        "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
        "1", ",", "B", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", "2"}], "]"}]}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SBTMcolors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"h_", ",", "s_"}], "]"}], "\[Rule]", "Red"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"0", ",", "d_"}], "]"}], "\[Rule]", "White"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"1", ",", "d_"}], "]"}], "\[Rule]", "Black"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"B", ",", "d_"}], "]"}], "\[Rule]", "Green"}], ",", 
     RowBox[{"BLANK", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.8215761585401077`*^9, 3.821576195989876*^9}, {
  3.8215771300445843`*^9, 3.821577131148424*^9}, {3.821578239352008*^9, 
  3.821578242082284*^9}, {3.8216635382018213`*^9, 3.821663585580578*^9}, {
  3.821663788665143*^9, 3.8216638037952957`*^9}, {3.85510028206581*^9, 
  3.855100313393358*^9}, {3.85510035305597*^9, 3.855100366023848*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"0b9bee0b-8502-4884-b6b0-3c879bd4faf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cSBTM", ",", "cSBTMstate"}], "}"}], "=", 
   RowBox[{"CompileSurfaceCRN", "[", 
    RowBox[{"surfaceSBTM", ",", "SBTMstate"}], "]"}]}], ";", 
  RowBox[{"SBTMtime", "=", "0"}], ";", 
  RowBox[{"SBTMevents", "=", "0"}], ";", 
  RowBox[{"halted", "=", "False"}], ";"}]], "Input",
 CellChangeTimes->{{3.8550973591804*^9, 3.855097392243544*^9}, {
   3.855098606157872*^9, 3.855098647408101*^9}, 3.855098759922367*^9, {
   3.855100306422267*^9, 3.8551003330403147`*^9}, {3.8551004661353283`*^9, 
   3.855100468834942*^9}, {3.855100825347793*^9, 3.855100827702662*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"6eaeaa0a-ea21-4102-919e-92d608f63903"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurfaceCRNState", "[", 
   RowBox[{"cSBTMstate", ",", "SBTMcolors", ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"SBTMtime", ",", "SBTMevents"}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8550970487760477`*^9, 3.855097070637308*^9}, {
  3.855097416782008*^9, 3.8550974271559343`*^9}, {3.855098772640065*^9, 
  3.855098787464149*^9}, {3.855099997515523*^9, 3.855099997995017*^9}, {
  3.855100378362425*^9, 3.855100387699732*^9}, {3.855100445673031*^9, 
  3.855100475307232*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"d4884984-59c0-440f-af86-42a48939594a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cSBTMstate"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cSBTM", ",", "cSBTMstate", ",", "0.1"}], "]"}]}], ";", 
     RowBox[{"SBTMtime", "+=", "dt"}], ";", 
     RowBox[{"SBTMevents", "+=", "devents"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821663615268921*^9, 3.821663662653942*^9}, {
   3.821663782379869*^9, 3.821663784547905*^9}, {3.8216704854745493`*^9, 
   3.821670529899147*^9}, {3.8218536758343267`*^9, 3.821853676205825*^9}, {
   3.822160699280971*^9, 3.822160724409618*^9}, {3.822160973495553*^9, 
   3.822160974472838*^9}, {3.822161005734478*^9, 3.8221610058619432`*^9}, {
   3.855100400532125*^9, 3.855100400907034*^9}, {3.855100491160706*^9, 
   3.8551005807506313`*^9}, {3.855100700603694*^9, 3.855100701272106*^9}, 
   3.855100748886188*^9, 3.8551008336518993`*^9},
 CellLabel->
  "In[306]:=",ExpressionUUID->"c47901a0-a114-4397-b548-1cdcedb332b8"],

Cell[CellGroupData[{

Cell["Some relevant references", "Subsection",
 CellChangeTimes->{{3.506990906717347*^9, 3.5069909078193007`*^9}, {
  3.521032741023697*^9, 3.521032783431868*^9}, {3.5210328332469597`*^9, 
  3.521032834067655*^9}, {3.573842620940196*^9, 3.5738426327121897`*^9}, {
  3.5738429513535624`*^9, 3.573842956086698*^9}, {3.573843811422264*^9, 
  3.573843815516943*^9}, {3.8255513035721407`*^9, 3.825551305508225*^9}, {
  3.8255517583679*^9, 
  3.825551759531536*^9}},ExpressionUUID->"95c3a62d-017e-431e-9771-\
c3c219fda7df"],

Cell["\<\
Qian, Lulu, and Erik Winfree. \[OpenCurlyDoubleQuote]Parallel and scalable \
computation and spatial dynamics with DNA-based chemical reaction networks on \
a surface.\[CloseCurlyDoubleQuote] In International Workshop on DNA-Based \
Computers, pp. 114-131. Springer, Cham, 2014.
Clamons, Samuel, Lulu Qian, and Erik Winfree. \
\[OpenCurlyDoubleQuote]Programming and simulating chemical reaction networks \
on a surface.\[CloseCurlyDoubleQuote] Journal of the Royal Society Interface \
17, no. 166 (2020): 20190790.\
\>", "Text",
 CellChangeTimes->{{3.693190355140053*^9, 3.6931903783285*^9}, 
   3.8255513077349243`*^9, {3.825551363633912*^9, 3.8255513658998117`*^9}, {
   3.8255516845526037`*^9, 3.825551690344644*^9}, 3.8255517485644217`*^9, {
   3.825551824699856*^9, 3.825551826274029*^9}, {3.825552250746643*^9, 
   3.8255522525413303`*^9}, 3.825552334020445*^9, {3.825552461262951*^9, 
   3.82555247697919*^9}, {3.825552812528034*^9, 3.82555281373421*^9}, 
   3.825552845110716*^9, {3.825553011902177*^9, 3.825553012306486*^9}, 
   3.825553472942132*^9, 3.8255536353131104`*^9, {3.825553672066284*^9, 
   3.825553673105431*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"91d3d2c5-a792-4afa-9de7-a970148072f1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> 
  RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> 
  RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "pints" -> 
  TemplateBox[{}, "PositiveIntegers"], "npints" -> 
  TemplateBox[{}, "NonPositiveIntegers"], "nnints" -> 
  TemplateBox[{}, "NonNegativeIntegers"], "nints" -> 
  TemplateBox[{}, "NegativeIntegers"], "prats" -> 
  TemplateBox[{}, "PositiveRationals"], "nprats" -> 
  TemplateBox[{}, "NonPositiveRationals"], "nnrats" -> 
  TemplateBox[{}, "NonNegativeRationals"], "nrats" -> 
  TemplateBox[{}, "NegativeRationals"], "preals" -> 
  TemplateBox[{}, "PositiveReals"], "npreals" -> 
  TemplateBox[{}, "NonPositiveReals"], "nnreals" -> 
  TemplateBox[{}, "NonNegativeReals"], "nreals" -> 
  TemplateBox[{}, "NegativeReals"], "dlim" -> RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  RowBox[{"\[Placeholder]", " ", 
     OverscriptBox["\[RightArrow]", 
      RowBox[{" ", "\[Placeholder]", " "}]], " ", "\[Placeholder]", " "}], 
  "revrxn" -> RowBox[{"\[Placeholder]", " ", 
     UnderoverscriptBox[
     "\[RightArrowLeftArrow]", "\[Placeholder]", "\[Placeholder]"], " ", 
     "\[Placeholder]", " "}]},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 280, 5, 156, "Title",ExpressionUUID->"67ae8e44-178c-46b4-9b39-1d517b599f65"],
Cell[863, 29, 1219, 20, 72, "Text",ExpressionUUID->"7a930e8b-53f9-4681-91b8-507ef95f729a"],
Cell[CellGroupData[{
Cell[2107, 53, 255, 4, 67, "Section",ExpressionUUID->"e67888a6-5577-489e-9ca9-ad66289034ca"],
Cell[2365, 59, 1139, 27, 94, "Text",ExpressionUUID->"e4973bc1-d613-461c-a57e-cbf4f1c8151b"],
Cell[3507, 88, 639, 13, 83, "Input",ExpressionUUID->"8d2908de-1644-4d54-8411-6a159ef8a15b",
 InitializationCell->True],
Cell[4149, 103, 3974, 109, 254, "Input",ExpressionUUID->"d6794b06-a2e6-4a87-b639-202999ba9c75",
 InitializationCell->True],
Cell[8126, 214, 1774, 38, 102, "Input",ExpressionUUID->"9785284f-63ea-477e-ba13-bbb14ac9a87b",
 InitializationCell->True],
Cell[9903, 254, 3308, 87, 178, "Input",ExpressionUUID->"bde82ff7-cd3f-45f2-b396-d5a86ee1c967",
 InitializationCell->True],
Cell[13214, 343, 952, 27, 64, "Input",ExpressionUUID->"368065f7-2ac3-44a3-ab87-f8dcbf1f6c6d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14191, 374, 339, 8, 28, "Input",ExpressionUUID->"45820862-9d50-4ec1-87a9-9d3c9a17de66"],
Cell[14533, 384, 584, 12, 37, "Output",ExpressionUUID->"440ee384-a1e6-4f9d-9b75-f38b2c8f1140"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15154, 401, 284, 6, 28, "Input",ExpressionUUID->"4e4e68d4-6684-44cf-8dea-6f60e0ee91a9"],
Cell[15441, 409, 469, 9, 37, "Output",ExpressionUUID->"fb5e4655-1192-48b2-9e5a-b8c5e4ad65dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15947, 423, 357, 8, 28, "Input",ExpressionUUID->"565b1921-9e7f-448d-8ed5-2d875f28786b"],
Cell[16307, 433, 569, 11, 37, "Output",ExpressionUUID->"b7cde37a-7abf-4cbf-89d6-55d109afea61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16913, 449, 293, 7, 28, "Input",ExpressionUUID->"d93b7a5a-dde5-490a-8931-4f0515c7eee2"],
Cell[17209, 458, 505, 11, 37, "Output",ExpressionUUID->"f1065d94-8224-444f-ad7c-432f31324fae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17751, 474, 771, 21, 28, "Input",ExpressionUUID->"fe3a0514-9ab0-477f-91eb-85aa6dfc4b5a"],
Cell[18525, 497, 1675, 39, 44, "Output",ExpressionUUID->"6044f19d-ce17-4033-b57d-f28600c26c5e"]
}, Open  ]],
Cell[20215, 539, 960, 17, 72, "Text",ExpressionUUID->"92b3c157-510f-417a-ba68-cba77a1480e3"],
Cell[21178, 558, 2019, 65, 140, "Input",ExpressionUUID->"8915ac04-ca6a-477a-bc9e-49f14dfa609d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[23222, 627, 729, 17, 28, "Input",ExpressionUUID->"f0a8f1a3-47d3-4ca3-ada2-575add2b6635"],
Cell[23954, 646, 1323, 30, 44, "Output",ExpressionUUID->"ffd8c70d-298a-482b-8968-ddde60f623af"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25326, 682, 219, 4, 67, "Section",ExpressionUUID->"9a984d52-6e2a-43df-8794-b6977b8b6c64"],
Cell[25548, 688, 7288, 151, 671, "Text",ExpressionUUID->"cb585fa4-3a27-45d5-bcf5-5366a60d6599"],
Cell[32839, 841, 2138, 37, 94, "Text",ExpressionUUID->"a1a7c2c1-1b67-49e7-b576-261eb1f5fec2"],
Cell[34980, 880, 947, 15, 116, "Text",ExpressionUUID->"dda1a1d2-6a06-4ed2-9101-bc627f8c7bb9"],
Cell[35930, 897, 9493, 216, 330, "Input",ExpressionUUID->"786c3dab-28ef-4aac-80b0-bc87232e3869",
 InitializationCell->True],
Cell[45426, 1115, 2371, 36, 138, "Text",ExpressionUUID->"70f42b39-40cc-4b5e-adaf-1c4ea63cde86"],
Cell[47800, 1153, 16311, 384, 730, "Input",ExpressionUUID->"61d2e35e-2fec-44ea-91a6-9f2f1f770d88",
 InitializationCell->True],
Cell[64114, 1539, 3123, 48, 44, "Input",ExpressionUUID->"5f208919-7123-402f-a003-c8bd6bdf294e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[67274, 1592, 234, 6, 105, "Section",ExpressionUUID->"e64f10ff-3770-4a1d-8617-4295b3b88e8a"],
Cell[67511, 1600, 439, 9, 72, "Text",ExpressionUUID->"8cc5a8b9-9296-4003-ae83-a36138480b6b"],
Cell[CellGroupData[{
Cell[67975, 1613, 813, 18, 28, "Input",ExpressionUUID->"7f4b6524-dd2d-40f5-a4cb-4a6b100818af"],
Cell[68791, 1633, 1378, 33, 44, "Output",ExpressionUUID->"c107130b-8e98-42bc-a85b-0c4abea3c9f4"]
}, Open  ]],
Cell[70184, 1669, 1237, 33, 48, "Input",ExpressionUUID->"d3f1c5b4-f101-4476-abfb-8135207e8221"],
Cell[71424, 1704, 1333, 34, 48, "Input",ExpressionUUID->"9169c658-ca6c-4834-b49d-be8700651e3b"],
Cell[CellGroupData[{
Cell[72782, 1742, 641, 15, 28, "Input",ExpressionUUID->"405961e4-d4db-4a72-bdd4-da682ac2f8b8"],
Cell[73426, 1759, 408, 9, 32, "Output",ExpressionUUID->"13902cce-c183-4b20-acbb-027c978b408f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73871, 1773, 920, 17, 28, "Input",ExpressionUUID->"4c67e60d-1487-4eaf-98ba-08177eb02156"],
Cell[74794, 1792, 162, 3, 32, "Output",ExpressionUUID->"c7fa438c-7cd2-4530-8bc3-b0fe33c4f196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74993, 1800, 417, 10, 28, "Input",ExpressionUUID->"12088e67-847b-422d-a0f8-2bc23249f396"],
Cell[75413, 1812, 211, 5, 32, "Output",ExpressionUUID->"b15f07d5-677b-4a6b-95a8-c60aee3f3c03"]
}, Open  ]],
Cell[75639, 1820, 2372, 44, 292, "Text",ExpressionUUID->"6711f994-2c2b-4649-a355-c0ab8a3025d5"],
Cell[CellGroupData[{
Cell[78036, 1868, 1898, 51, 86, "Input",ExpressionUUID->"e105d386-338b-47a8-9031-ad4d3bab3a13"],
Cell[79937, 1921, 55244, 981, 250, "Output",ExpressionUUID->"99aeb87c-85ea-41de-837b-52e389feb2e1"]
}, Open  ]],
Cell[135196, 2905, 3277, 67, 105, "Input",ExpressionUUID->"a44057b4-0a23-4b39-a040-6ea3981118bd"],
Cell[138476, 2974, 1020, 18, 160, "Text",ExpressionUUID->"1b4c7519-7ead-4973-8a95-4bd6e13a40b5"],
Cell[139499, 2994, 2030, 54, 124, "Input",ExpressionUUID->"c4ee24dc-dab3-4ab4-9682-c1000d800082"],
Cell[141532, 3050, 734, 19, 28, "Input",ExpressionUUID->"f6656ab5-3619-4a7f-9991-30c06255745f"],
Cell[142269, 3071, 2709, 70, 124, "Input",ExpressionUUID->"a894b1ce-ed02-4699-9204-55d2a4e52ade"],
Cell[144981, 3143, 3934, 84, 124, "Input",ExpressionUUID->"213648da-2f3a-4038-ba1f-0720d742cd35"],
Cell[148918, 3229, 943, 15, 116, "Text",ExpressionUUID->"b22090b1-e357-44e9-ada8-28edd86b4133"],
Cell[149864, 3246, 1737, 40, 105, "Input",ExpressionUUID->"d744df14-5aae-4208-832d-516a64e7230a"],
Cell[151604, 3288, 2459, 53, 86, "Input",ExpressionUUID->"e3127d31-7d68-419d-aa84-8dae77d1f6e9"],
Cell[CellGroupData[{
Cell[154088, 3345, 418, 10, 28, "Input",ExpressionUUID->"97c657d9-0f1d-4c5d-9a9a-6cfb2232764b"],
Cell[154509, 3357, 375, 7, 32, "Output",ExpressionUUID->"3135fddf-a53d-4a3c-9472-fa63662ddd60"]
}, Open  ]],
Cell[154899, 3367, 916, 15, 94, "Text",ExpressionUUID->"6bf0af83-4d09-4c91-9de9-955c4feb99c9"],
Cell[155818, 3384, 2542, 61, 124, "Input",ExpressionUUID->"e1a46dcb-8041-4946-88b2-460d4fdac571"],
Cell[158363, 3447, 1298, 32, 48, "Input",ExpressionUUID->"91aab686-5c2e-4db5-97fc-c6c43d27f28d"],
Cell[159664, 3481, 1359, 34, 48, "Input",ExpressionUUID->"43009b56-8c16-4b9a-bfb2-cb5bdc277042"],
Cell[161026, 3517, 1276, 32, 48, "Input",ExpressionUUID->"3f9ac338-f773-4014-bb3d-9d3581a5ac05"],
Cell[162305, 3551, 1511, 39, 48, "Input",ExpressionUUID->"34605e4c-58ee-459a-9c45-b294ff040f7a"],
Cell[163819, 3592, 2913, 73, 124, "Input",ExpressionUUID->"931a2248-8dec-44cb-ad3a-25a142482ff9"],
Cell[166735, 3667, 4104, 86, 124, "Input",ExpressionUUID->"36f4fbed-1f99-43d3-9d95-7a73551c8631"],
Cell[170842, 3755, 1055, 16, 116, "Text",ExpressionUUID->"50d0ea73-53e4-4b5f-b386-a970338f7f87"],
Cell[171900, 3773, 1967, 43, 105, "Input",ExpressionUUID->"2b9a83b6-1483-4fcc-b31d-0552cd6f977a"],
Cell[173870, 3818, 2212, 50, 86, "Input",ExpressionUUID->"dd5046b9-ab90-405c-a201-d007a1346c74"],
Cell[CellGroupData[{
Cell[176107, 3872, 608, 14, 28, "Input",ExpressionUUID->"b0bced9f-0b91-49c5-a626-6f867b4c7fb6"],
Cell[176718, 3888, 476, 9, 32, "Output",ExpressionUUID->"2f1d4369-aedc-40b6-a87c-bb581a64f2a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177243, 3903, 180, 3, 67, "Section",ExpressionUUID->"f0e83a7d-9a21-4312-948c-f0753961b9bd"],
Cell[177426, 3908, 616, 10, 50, "Text",ExpressionUUID->"a18d75b4-5ad9-4cc6-9b73-9c315240e95b"],
Cell[178045, 3920, 3951, 100, 292, "Input",ExpressionUUID->"a0b92663-28be-46d8-b583-85bee65316ed",
 InitializationCell->True],
Cell[181999, 4022, 11560, 306, 466, "Input",ExpressionUUID->"bc324486-1c31-429b-b420-1bfc3e4a470d"],
Cell[193562, 4330, 500, 13, 28, "Input",ExpressionUUID->"c61867a0-cc88-4024-9f28-5b0af47405bc"],
Cell[194065, 4345, 759, 12, 72, "Text",ExpressionUUID->"86096c63-a512-4b74-9034-8aea0f4e4c07"],
Cell[194827, 4359, 5221, 137, 276, "Input",ExpressionUUID->"7ae70e83-ed03-4720-86dc-f78811f18306"],
Cell[200051, 4498, 1207, 23, 48, "Input",ExpressionUUID->"7707dd87-e0f4-44a4-bbae-b4ff3294af91"],
Cell[201261, 4523, 1342, 29, 86, "Input",ExpressionUUID->"7be082c4-fedf-423d-accc-dfd196e33a89"],
Cell[202606, 4554, 1397, 24, 48, "Input",ExpressionUUID->"dc5d1c6b-fd71-47d6-90f7-7c31149da9a4"],
Cell[204006, 4580, 3566, 103, 219, "Input",ExpressionUUID->"46bc1e54-d20e-4008-8885-312a551d8e49"],
Cell[207575, 4685, 1311, 23, 116, "Text",ExpressionUUID->"eebe59cc-7c5f-47b3-885c-2795a0002758"],
Cell[CellGroupData[{
Cell[208911, 4712, 649, 16, 28, "Input",ExpressionUUID->"a59a8c64-073b-4b43-af84-50500b8eabee"],
Cell[209563, 4730, 155, 3, 32, "Output",ExpressionUUID->"90428530-21c8-4639-8ddd-be0f83f089ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209755, 4738, 301, 6, 28, "Input",ExpressionUUID->"39dc9aab-207c-4648-91fc-fd3fb77aa970"],
Cell[210059, 4746, 216, 5, 32, "Output",ExpressionUUID->"0eebd172-4230-4bc8-a583-349ca851fe3f"]
}, Open  ]],
Cell[210290, 4754, 1000, 15, 94, "Text",ExpressionUUID->"2c480272-540f-4306-be9d-f80d6e5860fa"],
Cell[211293, 4771, 8468, 230, 409, "Input",ExpressionUUID->"bacfd145-288d-4f5f-8407-2cbb060a289a"],
Cell[219764, 5003, 975, 22, 28, "Input",ExpressionUUID->"b633a5de-cf24-44d0-ac17-f805bc219527"],
Cell[220742, 5027, 1518, 34, 86, "Input",ExpressionUUID->"6d021f92-88be-456c-be20-bc62043fec61"],
Cell[222263, 5063, 1438, 26, 48, "Input",ExpressionUUID->"3963507e-42c0-460b-b52c-5736e3cbbb3f"],
Cell[223704, 5091, 1557, 24, 160, "Text",ExpressionUUID->"643d850e-8509-4f32-a31d-47d73fbfd251"],
Cell[225264, 5117, 2014, 60, 143, "Input",ExpressionUUID->"f4fd18e4-b528-4c16-8471-70c6a45317cb"],
Cell[227281, 5179, 499, 14, 28, "Input",ExpressionUUID->"5eeb37c2-4092-465c-96b3-ef1735fd46c0"],
Cell[227783, 5195, 376, 8, 28, "Input",ExpressionUUID->"8ee29ba9-2520-4649-968a-9be36ba547d2"],
Cell[228162, 5205, 8854, 208, 276, "Input",ExpressionUUID->"a874e70a-a4b6-477b-ade7-1dc527d38f20"],
Cell[237019, 5415, 182, 3, 28, "Input",ExpressionUUID->"0aa1b8e7-b063-453f-94eb-fdbc36bde8ea"],
Cell[237204, 5420, 1561, 42, 67, "Input",ExpressionUUID->"87f37337-0e22-4d47-ad28-ebecaa768d8f"],
Cell[238768, 5464, 741, 17, 28, "Input",ExpressionUUID->"fdb48e87-aaab-4768-83f8-b09b8061129a"],
Cell[239512, 5483, 1098, 20, 28, "Input",ExpressionUUID->"d2268610-f259-4046-87b0-eb90d582cdd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240647, 5508, 329, 5, 67, "Section",ExpressionUUID->"257aad44-d0fc-4693-b439-6a8b6f815e02"],
Cell[240979, 5515, 1410, 21, 182, "Text",ExpressionUUID->"bf8043b9-b51d-4629-84ac-d78b340a6dd3"],
Cell[242392, 5538, 273, 6, 28, "Input",ExpressionUUID->"60626139-2bb2-404b-8a4c-716c8b12754b"],
Cell[242668, 5546, 766, 18, 67, "Input",ExpressionUUID->"0d6494ad-a449-44fb-a7f3-1d22f6db9708"],
Cell[243437, 5566, 333, 9, 28, "Input",ExpressionUUID->"7a5d6dba-41d2-46e7-9598-ac8f680ceb0b"],
Cell[243773, 5577, 832, 20, 67, "Input",ExpressionUUID->"a0285c8b-004f-4c76-9c4e-4de83e91d774"],
Cell[244608, 5599, 435, 10, 28, "Input",ExpressionUUID->"1cc3d81e-e161-4a73-b268-f517ee78d604"],
Cell[CellGroupData[{
Cell[245068, 5613, 8593, 194, 115, "Input",ExpressionUUID->"b0c7e076-4e2f-4e06-a294-68c4d8812403"],
Cell[253664, 5809, 7878, 185, 133, "Output",ExpressionUUID->"70059036-b85f-487c-ab56-d81d51c322e6"]
}, Open  ]],
Cell[261557, 5997, 8426, 172, 115, "Input",ExpressionUUID->"0b8947fe-4cbf-430c-a887-9f25a3248ae1"],
Cell[269986, 6171, 8482, 174, 115, "Input",ExpressionUUID->"f292eeb4-9be3-4d05-8a63-16f2f6aab2c9"],
Cell[278471, 6347, 8433, 173, 115, "Input",ExpressionUUID->"cefcd333-348e-460f-be56-2606c582e009"],
Cell[286907, 6522, 867, 25, 28, "Input",ExpressionUUID->"7758d2eb-a6a0-470f-9912-dcb98eddc4dc"],
Cell[287777, 6549, 1310, 36, 67, "Input",ExpressionUUID->"1784a18f-f415-49a1-ad08-451ff173e8a6"],
Cell[289090, 6587, 1092, 25, 48, "Input",ExpressionUUID->"06deeaaa-40c2-4eb3-8313-751dc4187d43"],
Cell[290185, 6614, 1126, 20, 28, "Input",ExpressionUUID->"0e16370e-1ce9-47a4-b592-f65d1904696b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291348, 6639, 273, 4, 67, "Section",ExpressionUUID->"c4757844-ce44-4b30-97ba-e2361aaf099c"],
Cell[291624, 6645, 1071, 16, 94, "Text",ExpressionUUID->"fc66f781-8051-4130-8375-04962a14cb4f"],
Cell[292698, 6663, 452, 11, 28, "Input",ExpressionUUID->"cfea4d2c-2d1a-493d-96b5-07fae93fa1b7"],
Cell[CellGroupData[{
Cell[293175, 6678, 978, 22, 28, "Input",ExpressionUUID->"afaa68d9-c9b2-4874-bb47-87b79eff4507"],
Cell[294156, 6702, 1047, 19, 391, 283, 6, "CachedBoxData", "BoxData", "Output",ExpressionUUID->"109d2d4d-edb3-4051-bb42-e2f7a134b994"]
}, Open  ]],
Cell[295218, 6724, 1617, 42, 105, "Input",ExpressionUUID->"e5fb7358-6149-4fb9-93ba-16839bddc8b8"],
Cell[296838, 6768, 1211, 19, 116, "Text",ExpressionUUID->"8b95ad6a-ff49-4b30-9f2a-2e53811d8eba"],
Cell[298052, 6789, 1000, 27, 28, "Input",ExpressionUUID->"6947f0cd-df5f-4423-ad2d-ae4e52a723d8"],
Cell[CellGroupData[{
Cell[299077, 6820, 1090, 25, 28, "Input",ExpressionUUID->"c902411d-7e91-4705-8a3b-a0029239478e"],
Cell[300170, 6847, 1136, 20, 391, 335, 6, "CachedBoxData", "BoxData", "Output",ExpressionUUID->"7f6dc83b-b7a9-443c-9218-5b5c926ed49b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301343, 6872, 1671, 44, 105, "Input",ExpressionUUID->"93918390-6488-4878-8739-20b1ef46ae89"],
Cell[303017, 6918, 304, 5, 32, "Output",ExpressionUUID->"d6f8abce-3d55-452c-b93d-51cb42f52129"]
}, Open  ]],
Cell[303336, 6926, 958, 15, 50, "Text",ExpressionUUID->"d3fd4bdd-b6f0-446d-814a-1d31c4a991a9"],
Cell[CellGroupData[{
Cell[304319, 6945, 1531, 36, 28, "Input",ExpressionUUID->"818a3802-63a6-401a-8a55-00fca9781b02"],
Cell[305853, 6983, 5350, 107, 204, "Output",ExpressionUUID->"d35921a0-4617-4289-b777-bcae02a08a17"]
}, Open  ]],
Cell[311218, 7093, 1406, 32, 28, "Input",ExpressionUUID->"fc5a8001-49d1-49d5-a090-e80bcf8e88a6"],
Cell[CellGroupData[{
Cell[312649, 7129, 733, 17, 28, "Input",ExpressionUUID->"f0c400c5-6351-49fb-b336-8f2dc9a40700"],
Cell[313385, 7148, 703, 13, 391, "Output",ExpressionUUID->"a1e2b9c8-2967-4a35-a47c-f8cbef233333"]
}, Open  ]],
Cell[314103, 7164, 1381, 40, 86, "Input",ExpressionUUID->"99609be7-6b85-415a-9c52-a304259c9e09"],
Cell[315487, 7206, 1372, 28, 28, "Input",ExpressionUUID->"6d93a5da-ab0e-4094-8351-7337abd44abf"],
Cell[CellGroupData[{
Cell[316884, 7238, 835, 19, 48, "Input",ExpressionUUID->"cec3cc1a-f27d-4da3-97a7-0bfb32bea5fb"],
Cell[317722, 7259, 805, 15, 391, "Output",ExpressionUUID->"53b63d86-f649-4a3d-976a-02674cd1b913"]
}, Open  ]],
Cell[318542, 7277, 1381, 40, 86, "Input",ExpressionUUID->"406e0696-6e9c-4575-a9d3-fdbe0c7ccfd3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319960, 7322, 280, 4, 67, "Section",ExpressionUUID->"5fa26c2e-afce-4858-bd9e-2242d50f8f64"],
Cell[320243, 7328, 2146, 31, 226, "Text",ExpressionUUID->"8581ce32-b34d-4159-8a87-c2c5144eba40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322426, 7364, 290, 4, 67, "Section",ExpressionUUID->"9eae8a00-caf2-4017-bdee-852062e91827"],
Cell[322719, 7370, 3583, 51, 512, "Text",ExpressionUUID->"f4933c45-b25c-4673-a9d0-72adf19b1ac2"],
Cell[326305, 7423, 4859, 129, 257, "Input",ExpressionUUID->"b8c6a082-7218-4c3c-b577-0644286d4ece"],
Cell[331167, 7554, 4764, 88, 257, "Input",ExpressionUUID->"346c42e5-9b55-40fe-afb6-42c1108674ed"],
Cell[335934, 7644, 1302, 29, 107, "Input",ExpressionUUID->"1e5c064c-17b0-4132-94f9-c4c071ff9f12"],
Cell[337239, 7675, 436, 10, 28, "Input",ExpressionUUID->"9f978709-d40c-4a99-a549-f2c4fdb69bfd"],
Cell[337678, 7687, 1245, 22, 28, "Input",ExpressionUUID->"574d47e1-e2fc-4180-8012-deef8a501c78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338960, 7714, 434, 6, 67, "Section",ExpressionUUID->"d80cba19-684b-4342-8a46-0c91fadc84c2"],
Cell[339397, 7722, 1346, 22, 116, "Text",ExpressionUUID->"cb9f8e58-400f-4f1e-a576-17593328ee40"],
Cell[CellGroupData[{
Cell[340768, 7748, 4782, 104, 219, "Input",ExpressionUUID->"dc76892a-5133-449a-8142-daa3f117e220"],
Cell[345553, 7854, 1770, 38, 44, "Output",ExpressionUUID->"2847b4b4-3203-4d7f-92da-414d8537e93e"]
}, Open  ]],
Cell[347338, 7895, 1161, 19, 28, "Input",ExpressionUUID->"1925dcad-e959-463e-b3d8-0146d68c294a"],
Cell[348502, 7916, 1777, 34, 28, "Input",ExpressionUUID->"6c6c07a5-a8d1-4b70-a06b-a98282fac32e"],
Cell[CellGroupData[{
Cell[350304, 7954, 640, 13, 28, "Input",ExpressionUUID->"5a0b3850-8b1f-47e4-b108-93fc0311fa8e"],
Cell[350947, 7969, 498, 9, 32, "Output",ExpressionUUID->"810c7eb2-0aac-4dad-a868-671a68c82d60"]
}, Open  ]],
Cell[351460, 7981, 1922, 47, 105, "Input",ExpressionUUID->"c48adda4-8294-4559-be4b-b0d9f074252b"],
Cell[353385, 8030, 738, 19, 28, "Input",ExpressionUUID->"7494f05f-55b0-4b3d-8990-b0b0019b5b7d"],
Cell[354126, 8051, 1332, 36, 86, "Input",ExpressionUUID->"8bbb160a-2860-4102-9306-fbe8b2d9fb1b"],
Cell[355461, 8089, 900, 14, 50, "Text",ExpressionUUID->"73a4b586-1deb-46e3-9e3e-f9b8008acff8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356398, 8108, 474, 7, 67, "Section",ExpressionUUID->"0006252e-fb3f-4378-85ff-715e187d5d45"],
Cell[356875, 8117, 4205, 66, 402, "Text",ExpressionUUID->"3e65a77b-e813-4e50-9241-066683a7fe68"],
Cell[361083, 8185, 11660, 256, 615, "Input",ExpressionUUID->"394366a2-78be-4bf8-afcf-2b08f32e4483",
 InitializationCell->True],
Cell[372746, 8443, 2728, 48, 116, "Text",ExpressionUUID->"7377637c-05c4-4d46-85d3-0a78b33b15a4"],
Cell[375477, 8493, 10927, 263, 672, "Input",ExpressionUUID->"44dcd3fc-9498-4125-8c06-127731aa044a",
 InitializationCell->True],
Cell[386407, 8758, 1736, 29, 116, "Text",ExpressionUUID->"bf90d076-cb29-4115-8e82-c616857a90a7"],
Cell[388146, 8789, 6379, 141, 688, "Text",ExpressionUUID->"7a836ce4-bbec-4ae2-8bce-30ab2d9778bf"],
Cell[394528, 8932, 1397, 21, 72, "Text",ExpressionUUID->"695b1818-b847-48c7-9762-4262b506952d"],
Cell[395928, 8955, 6861, 145, 349, "Input",ExpressionUUID->"a7776f5a-2c6a-417f-befc-d16728d9f5c3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[402814, 9104, 69237, 1510, 3275, "Input",ExpressionUUID->"b1dcb21b-bcb4-4514-80e3-523a947114ec",
 InitializationCell->True],
Cell[472054, 10616, 844, 15, 57, "Message",ExpressionUUID->"da0819a6-940f-4efd-bc52-90c069774813"],
Cell[472901, 10633, 376, 9, 21, "Message",ExpressionUUID->"e7f438f5-d153-4db5-9ad7-b87062aa481e"],
Cell[473280, 10644, 109975, 2104, 71, "Output",ExpressionUUID->"c023362b-18e8-4c36-b820-5a3763c32262"]
}, Open  ]],
Cell[583270, 12751, 894, 18, 50, "Text",ExpressionUUID->"f8587eb8-a439-4373-bb55-3c3058d3b55f"],
Cell[584167, 12771, 502, 12, 28, "Input",ExpressionUUID->"b935061e-725c-4554-8236-64d48baf8902"],
Cell[584672, 12785, 1422, 22, 28, "Input",ExpressionUUID->"94273af3-179f-4006-8454-8531df46c096"],
Cell[586097, 12809, 1563, 30, 28, "Input",ExpressionUUID->"74bfe14b-491b-40cc-a088-c93d74d4c945"],
Cell[587663, 12841, 550, 12, 28, "Input",ExpressionUUID->"2d4b6239-8281-460c-9f0e-cba50c37efa0"],
Cell[588216, 12855, 1577, 26, 28, "Input",ExpressionUUID->"8219f83c-2417-45a3-9aee-ba3199fddfa0"],
Cell[589796, 12883, 1657, 31, 28, "Input",ExpressionUUID->"78b6857e-fbc8-4518-855b-1c7b7d57c2d1"],
Cell[CellGroupData[{
Cell[591478, 12918, 1385, 39, 67, "Input",ExpressionUUID->"c8f7055a-74e0-47da-90a2-b96c71e4e9f0"],
Cell[592866, 12959, 577, 17, 32, "Output",ExpressionUUID->"e3bccfe5-5a46-4751-97e5-4961aa72e8cf"]
}, Open  ]],
Cell[593458, 12979, 909, 18, 50, "Text",ExpressionUUID->"77ffc978-847c-4ea7-bdcb-f508780085a9"],
Cell[594370, 12999, 404, 10, 28, "Input",ExpressionUUID->"982d5fc1-1efd-4050-b6c7-a5a4b742766f"],
Cell[594777, 13011, 360, 8, 28, "Input",ExpressionUUID->"d119e9ec-f6f7-47da-baf8-d10ffb3678e3"],
Cell[595140, 13021, 1417, 27, 28, "Input",ExpressionUUID->"8ea800b9-9712-4820-8d39-feb2943566a6"],
Cell[CellGroupData[{
Cell[596582, 13052, 989, 27, 48, "Input",ExpressionUUID->"36564e57-e158-450c-b8a6-c6ceffb2744a"],
Cell[597574, 13081, 372, 10, 32, "Output",ExpressionUUID->"bfe0c308-e831-4691-bb1c-c38668021455"]
}, Open  ]],
Cell[597961, 13094, 1006, 16, 94, "Text",ExpressionUUID->"9db2c07f-2d85-4417-a576-b92cb4b6c026"],
Cell[598970, 13112, 1417, 35, 28, "Input",ExpressionUUID->"6763e432-5d5f-4cd4-9311-874858575e3c"],
Cell[600390, 13149, 392, 10, 28, "Input",ExpressionUUID->"b6c3fc40-6add-4c46-9a1c-81cc5c600cf8"],
Cell[600785, 13161, 603, 14, 28, "Input",ExpressionUUID->"12c71621-a26f-43b5-bc1a-fe974169703a"],
Cell[601391, 13177, 1187, 24, 28, "Input",ExpressionUUID->"8c9f02e2-e3a9-4cca-86cc-847e1876e4c5"],
Cell[CellGroupData[{
Cell[602603, 13205, 1118, 29, 48, "Input",ExpressionUUID->"bf78b276-5814-46c5-a16f-e59ee9480772"],
Cell[603724, 13236, 347, 10, 32, "Output",ExpressionUUID->"0f8a1477-004e-4b71-9fdb-7e2cc15c542a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[604108, 13251, 701, 18, 30, "Input",ExpressionUUID->"53a799ee-1139-4fe0-aca7-ed4b6ab7efa9"],
Cell[604812, 13271, 370, 10, 34, "Output",ExpressionUUID->"6efec142-aed7-40a8-b86f-5564d1b52e25"]
}, Open  ]],
Cell[605197, 13284, 1631, 26, 143, "Text",ExpressionUUID->"e3e2b6f9-fe30-4325-8327-60dfb872ee98"],
Cell[606831, 13312, 977, 19, 51, "Text",ExpressionUUID->"1022c539-749c-435f-9d22-f25bd629f5fc"],
Cell[607811, 13333, 484, 11, 30, "Input",ExpressionUUID->"4243e3ef-aa42-475f-82c9-87a6583e2582"],
Cell[608298, 13346, 511, 10, 30, "Input",ExpressionUUID->"28b0ebc1-6378-4ddb-8edd-2b1d8e1bec63"],
Cell[608812, 13358, 1329, 26, 30, "Input",ExpressionUUID->"d54cb5ec-c931-44da-adff-14daf239ee2a"],
Cell[610144, 13386, 1197, 23, 74, "Text",ExpressionUUID->"3eb08922-6198-4f60-b179-d40e2a01f107"],
Cell[611344, 13411, 2027, 45, 52, "Input",ExpressionUUID->"0b9bee0b-8502-4884-b6b0-3c879bd4faf4"],
Cell[613374, 13458, 710, 15, 30, "Input",ExpressionUUID->"6eaeaa0a-ea21-4102-919e-92d608f63903"],
Cell[614087, 13475, 664, 14, 30, "Input",ExpressionUUID->"d4884984-59c0-440f-af86-42a48939594a"],
Cell[614754, 13491, 1744, 33, 30, "Input",ExpressionUUID->"c47901a0-a114-4397-b548-1cdcedb332b8"],
Cell[CellGroupData[{
Cell[616523, 13528, 517, 8, 54, "Subsection",ExpressionUUID->"95c3a62d-017e-431e-9771-c3c219fda7df"],
Cell[617043, 13538, 1238, 20, 97, "Text",ExpressionUUID->"91d3d2c5-a792-4afa-9de7-a970148072f1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

